(function(){if(typeof self=="undefined"||!self.Prism||!self.document||!document.createRange)return;Prism.hooks.add("before-highlight",function(e){var t=!1,n=0,r=[],i=function(e,s){var o={};s||(o.clone=e.cloneNode(!1),o.posOpen=n,r.push(o));for(var u=0,a=e.childNodes.length;u<a;u++){var l=e.childNodes[u];l.nodeType===1?i(l):l.nodeType===3&&(t||(l.data=l.data.replace(/^(?:\r?\n|\r)/,""),t=!0),n+=l.data.length)}s||(o.posClose=n)};i(e.element,!0),r&&r.length&&(e.keepMarkup=r)}),Prism.hooks.add("after-highlight",function(e){if(e.keepMarkup&&e.keepMarkup.length){var t=function(e,n){for(var r=0,i=e.childNodes.length;r<i;r++){var s=e.childNodes[r];if(s.nodeType===1){if(!t(s,n))return!1}else s.nodeType===3&&(!n.nodeStart&&n.pos+s.data.length>n.node.posOpen&&(n.nodeStart=s,n.nodeStartPos=n.node.posOpen-n.pos),n.nodeStart&&n.pos+s.data.length>=n.node.posClose&&(n.nodeEnd=s,n.nodeEndPos=n.node.posClose-n.pos),n.pos+=s.data.length);if(n.nodeStart&&n.nodeEnd){var o=document.createRange();return o.setStart(n.nodeStart,n.nodeStartPos),o.setEnd(n.nodeEnd,n.nodeEndPos),n.node.clone.appendChild(o.extractContents()),o.insertNode(n.node.clone),o.detach(),!1}}return!0};e.keepMarkup.forEach(function(n){t(e.element,{node:n,pos:0})})}})})();