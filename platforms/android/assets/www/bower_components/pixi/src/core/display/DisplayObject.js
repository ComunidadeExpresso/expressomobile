function DisplayObject(){EventEmitter.call(this),this.position=new math.Point,this.scale=new math.Point(1,1),this.pivot=new math.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this.worldTransform=new math.Matrix,this.filterArea=null,this._sr=0,this._cr=1,this._bounds=new math.Rectangle(0,0,1,1),this._currentBounds=null,this._mask=null}var math=require("../math"),RenderTexture=require("../textures/RenderTexture"),EventEmitter=require("eventemitter3"),CONST=require("../const"),_tempMatrix=new math.Matrix,_tempDisplayObjectParent={worldTransform:new math.Matrix,worldAlpha:1,children:[]};DisplayObject.prototype=Object.create(EventEmitter.prototype),DisplayObject.prototype.constructor=DisplayObject,module.exports=DisplayObject,Object.defineProperties(DisplayObject.prototype,{x:{get:function(){return this.position.x},set:function(e){this.position.x=e}},y:{get:function(){return this.position.y},set:function(e){this.position.y=e}},worldVisible:{get:function(){var e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}},mask:{get:function(){return this._mask},set:function(e){this._mask&&(this._mask.renderable=!0),this._mask=e,this._mask&&(this._mask.renderable=!1)}},filters:{get:function(){return this._filters&&this._filters.slice()},set:function(e){this._filters=e&&e.slice()}}}),DisplayObject.prototype.updateTransform=function(){var e=this.parent.worldTransform,t=this.worldTransform,n,r,i,s,o,u;if(this.rotation%CONST.PI_2){this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation)),n=this._cr*this.scale.x,r=this._sr*this.scale.x,i=-this._sr*this.scale.y,s=this._cr*this.scale.y,o=this.position.x,u=this.position.y;if(this.pivot.x||this.pivot.y)o-=this.pivot.x*n+this.pivot.y*i,u-=this.pivot.x*r+this.pivot.y*s;t.a=n*e.a+r*e.c,t.b=n*e.b+r*e.d,t.c=i*e.a+s*e.c,t.d=i*e.b+s*e.d,t.tx=o*e.a+u*e.c+e.tx,t.ty=o*e.b+u*e.d+e.ty}else n=this.scale.x,s=this.scale.y,o=this.position.x-this.pivot.x*n,u=this.position.y-this.pivot.y*s,t.a=n*e.a,t.b=n*e.b,t.c=s*e.c,t.d=s*e.d,t.tx=o*e.a+u*e.c+e.tx,t.ty=o*e.b+u*e.d+e.ty;this.worldAlpha=this.alpha*this.parent.worldAlpha,this._currentBounds=null},DisplayObject.prototype.displayObjectUpdateTransform=DisplayObject.prototype.updateTransform,DisplayObject.prototype.getBounds=function(e){return math.Rectangle.EMPTY},DisplayObject.prototype.getLocalBounds=function(){return this.getBounds(math.Matrix.IDENTITY)},DisplayObject.prototype.toGlobal=function(e){return this.parent?this.displayObjectUpdateTransform():(this.parent=_tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null),this.worldTransform.apply(e)},DisplayObject.prototype.toLocal=function(e,t){return t&&(e=t.toGlobal(e)),this.parent?this.displayObjectUpdateTransform():(this.parent=_tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null),this.worldTransform.applyInverse(e)},DisplayObject.prototype.renderWebGL=function(e){},DisplayObject.prototype.renderCanvas=function(e){},DisplayObject.prototype.generateTexture=function(e,t,n){var r=this.getLocalBounds(),i=new RenderTexture(e,r.width|0,r.height|0,t,n);return _tempMatrix.tx=-r.x,_tempMatrix.ty=-r.y,i.render(this,_tempMatrix),i},DisplayObject.prototype.setParent=function(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e},DisplayObject.prototype.destroy=function(){this.position=null,this.scale=null,this.pivot=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.worldTransform=null,this.filterArea=null};