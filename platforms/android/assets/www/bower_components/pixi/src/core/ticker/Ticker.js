function Ticker(){var e=this;this._tick=function(n){e._requestId=null,e.started&&(e.update(n),e.started&&e._requestId===null&&e._emitter.listeners(TICK,!0)&&(e._requestId=requestAnimationFrame(e._tick)))},this._emitter=new EventEmitter,this._requestId=null,this._maxElapsedMS=100,this.autoStart=!1,this.deltaTime=1,this.elapsedMS=1/CONST.TARGET_FPMS,this.lastTime=0,this.speed=1,this.started=!1}var CONST=require("../const"),EventEmitter=require("eventemitter3"),TICK="tick";Object.defineProperties(Ticker.prototype,{FPS:{get:function(){return 1e3/this.elapsedMS}},minFPS:{get:function(){return 1e3/this._maxElapsedMS},set:function(e){var t=Math.min(Math.max(0,e)/1e3,CONST.TARGET_FPMS);this._maxElapsedMS=1/t}}}),Ticker.prototype._requestIfNeeded=function(){this._requestId===null&&this._emitter.listeners(TICK,!0)&&(this.lastTime=performance.now(),this._requestId=requestAnimationFrame(this._tick))},Ticker.prototype._cancelIfNeeded=function(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)},Ticker.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},Ticker.prototype.add=function(t,n){return this._emitter.on(TICK,t,n),this._startIfPossible(),this},Ticker.prototype.addOnce=function(t,n){return this._emitter.once(TICK,t,n),this._startIfPossible(),this},Ticker.prototype.remove=function(t,n){return this._emitter.off(TICK,t,n),this._emitter.listeners(TICK,!0)||this._cancelIfNeeded(),this},Ticker.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},Ticker.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},Ticker.prototype.update=function(t){var n;t=t||performance.now(),n=this.elapsedMS=t-this.lastTime,n>this._maxElapsedMS&&(n=this._maxElapsedMS),this.deltaTime=n*CONST.TARGET_FPMS*this.speed,this._emitter.emit(TICK,this.deltaTime),this.lastTime=t},module.exports=Ticker;