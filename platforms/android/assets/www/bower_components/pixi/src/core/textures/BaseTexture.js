function BaseTexture(e,t,n){EventEmitter.call(this),this.uid=utils.uid(),this.resolution=n||1,this.width=100,this.height=100,this.realWidth=100,this.realHeight=100,this.scaleMode=t||CONST.SCALE_MODES.DEFAULT,this.hasLoaded=!1,this.isLoading=!1,this.source=null,this.premultipliedAlpha=!0,this.imageUrl=null,this.isPowerOfTwo=!1,this.mipmap=!1,this._glTextures=[],e&&this.loadSource(e)}var utils=require("../utils"),CONST=require("../const"),EventEmitter=require("eventemitter3");BaseTexture.prototype=Object.create(EventEmitter.prototype),BaseTexture.prototype.constructor=BaseTexture,module.exports=BaseTexture,BaseTexture.prototype.update=function(){this.realWidth=this.source.naturalWidth||this.source.width,this.realHeight=this.source.naturalHeight||this.source.height,this.width=this.realWidth/this.resolution,this.height=this.realHeight/this.resolution,this.isPowerOfTwo=utils.isPowerOfTwo(this.realWidth,this.realHeight),this.emit("update",this)},BaseTexture.prototype.loadSource=function(e){var t=this.isLoading;this.hasLoaded=!1,this.isLoading=!1,t&&this.source&&(this.source.onload=null,this.source.onerror=null),this.source=e;if((this.source.complete||this.source.getContext)&&this.source.width&&this.source.height)this._sourceLoaded();else if(!e.getContext){this.isLoading=!0;var n=this;e.onload=function(){e.onload=null,e.onerror=null;if(!n.isLoading)return;n.isLoading=!1,n._sourceLoaded(),n.emit("loaded",n)},e.onerror=function(){e.onload=null,e.onerror=null;if(!n.isLoading)return;n.isLoading=!1,n.emit("error",n)},e.complete&&e.src&&(this.isLoading=!1,e.onload=null,e.onerror=null,e.width&&e.height?(this._sourceLoaded(),t&&this.emit("loaded",this)):t&&this.emit("error",this))}},BaseTexture.prototype._sourceLoaded=function(){this.hasLoaded=!0,this.update()},BaseTexture.prototype.destroy=function(){this.imageUrl?(delete utils.BaseTextureCache[this.imageUrl],delete utils.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src="")):this.source&&this.source._pixiId&&delete utils.BaseTextureCache[this.source._pixiId],this.source=null,this.dispose()},BaseTexture.prototype.dispose=function(){this.emit("dispose",this),this._glTextures.length=0},BaseTexture.prototype.updateSourceImage=function(e){this.source.src=e,this.loadSource(this.source)},BaseTexture.fromImage=function(e,t,n){var r=utils.BaseTextureCache[e];t===undefined&&e.indexOf("data:")!==0&&(t=!0);if(!r){var i=new Image;t&&(i.crossOrigin=""),r=new BaseTexture(i,n),r.imageUrl=e,i.src=e,utils.BaseTextureCache[e]=r,r.resolution=utils.getResolutionOfUrl(e)}return r},BaseTexture.fromCanvas=function(e,t){e._pixiId||(e._pixiId="canvas_"+utils.uid());var n=utils.BaseTextureCache[e._pixiId];return n||(n=new BaseTexture(e,t),utils.BaseTextureCache[e._pixiId]=n),n};