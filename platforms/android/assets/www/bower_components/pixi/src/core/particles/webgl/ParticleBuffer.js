function ParticleBuffer(e,t,n,r){this.gl=e,this.vertSize=2,this.vertByteSize=this.vertSize*4,this.size=r,this.dynamicProperties=[],this.staticProperties=[];for(var i=0;i<t.length;i++){var s=t[i];n[i]?this.dynamicProperties.push(s):this.staticProperties.push(s)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.initBuffers()}ParticleBuffer.prototype.constructor=ParticleBuffer,module.exports=ParticleBuffer,ParticleBuffer.prototype.initBuffers=function(){var e=this.gl,t,n,r=0;this.dynamicStride=0;for(t=0;t<this.dynamicProperties.length;t++)n=this.dynamicProperties[t],n.offset=r,r+=n.size,this.dynamicStride+=n.size;this.dynamicData=new Float32Array(this.size*this.dynamicStride*4),this.dynamicBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.dynamicBuffer),e.bufferData(e.ARRAY_BUFFER,this.dynamicData,e.DYNAMIC_DRAW);var i=0;this.staticStride=0;for(t=0;t<this.staticProperties.length;t++)n=this.staticProperties[t],n.offset=i,i+=n.size,this.staticStride+=n.size;this.staticData=new Float32Array(this.size*this.staticStride*4),this.staticBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.staticBuffer),e.bufferData(e.ARRAY_BUFFER,this.staticData,e.DYNAMIC_DRAW)},ParticleBuffer.prototype.uploadDynamic=function(e,t,n){var r=this.gl;for(var i=0;i<this.dynamicProperties.length;i++){var s=this.dynamicProperties[i];s.uploadFunction(e,t,n,this.dynamicData,this.dynamicStride,s.offset)}r.bindBuffer(r.ARRAY_BUFFER,this.dynamicBuffer),r.bufferSubData(r.ARRAY_BUFFER,0,this.dynamicData)},ParticleBuffer.prototype.uploadStatic=function(e,t,n){var r=this.gl;for(var i=0;i<this.staticProperties.length;i++){var s=this.staticProperties[i];s.uploadFunction(e,t,n,this.staticData,this.staticStride,s.offset)}r.bindBuffer(r.ARRAY_BUFFER,this.staticBuffer),r.bufferSubData(r.ARRAY_BUFFER,0,this.staticData)},ParticleBuffer.prototype.bind=function(){var e=this.gl,t,n;e.bindBuffer(e.ARRAY_BUFFER,this.dynamicBuffer);for(t=0;t<this.dynamicProperties.length;t++)n=this.dynamicProperties[t],e.vertexAttribPointer(n.attribute,n.size,e.FLOAT,!1,this.dynamicStride*4,n.offset*4);e.bindBuffer(e.ARRAY_BUFFER,this.staticBuffer);for(t=0;t<this.staticProperties.length;t++)n=this.staticProperties[t],e.vertexAttribPointer(n.attribute,n.size,e.FLOAT,!1,this.staticStride*4,n.offset*4)},ParticleBuffer.prototype.destroy=function(){this.dynamicProperties=null,this.dynamicData=null,this.gl.deleteBuffer(this.dynamicBuffer),this.staticProperties=null,this.staticData=null,this.gl.deleteBuffer(this.staticBuffer)};