function Sprite(e){Container.call(this),this.anchor=new math.Point,this._texture=null,this._width=0,this._height=0,this.tint=16777215,this.blendMode=CONST.BLEND_MODES.NORMAL,this.shader=null,this.cachedTint=16777215,this.texture=e||Texture.EMPTY}var math=require("../math"),Texture=require("../textures/Texture"),Container=require("../display/Container"),CanvasTinter=require("../renderers/canvas/utils/CanvasTinter"),utils=require("../utils"),CONST=require("../const"),tempPoint=new math.Point;Sprite.prototype=Object.create(Container.prototype),Sprite.prototype.constructor=Sprite,module.exports=Sprite,Object.defineProperties(Sprite.prototype,{width:{get:function(){return Math.abs(this.scale.x)*this.texture._frame.width},set:function(e){this.scale.x=utils.sign(this.scale.x)*e/this.texture._frame.width,this._width=e}},height:{get:function(){return Math.abs(this.scale.y)*this.texture._frame.height},set:function(e){this.scale.y=utils.sign(this.scale.y)*e/this.texture._frame.height,this._height=e}},texture:{get:function(){return this._texture},set:function(e){if(this._texture===e)return;this._texture=e,this.cachedTint=16777215,e&&(e.baseTexture.hasLoaded?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this))}}}),Sprite.prototype._onTextureUpdate=function(){this._width&&(this.scale.x=utils.sign(this.scale.x)*this._width/this.texture.frame.width),this._height&&(this.scale.y=utils.sign(this.scale.y)*this._height/this.texture.frame.height)},Sprite.prototype._renderWebGL=function(e){e.setObjectRenderer(e.plugins.sprite),e.plugins.sprite.render(this)},Sprite.prototype.getBounds=function(e){if(!this._currentBounds){var t=this._texture._frame.width,n=this._texture._frame.height,r=t*(1-this.anchor.x),i=t*-this.anchor.x,s=n*(1-this.anchor.y),o=n*-this.anchor.y,u=e||this.worldTransform,a=u.a,f=u.b,l=u.c,c=u.d,h=u.tx,p=u.ty,d,v,m,g;if(f===0&&l===0)a<0&&(a*=-1),c<0&&(c*=-1),d=a*i+h,v=a*r+h,m=c*o+p,g=c*s+p;else{var y=a*i+l*o+h,b=c*o+f*i+p,w=a*r+l*o+h,E=c*o+f*r+p,S=a*r+l*s+h,x=c*s+f*r+p,T=a*i+l*s+h,N=c*s+f*i+p;d=y,d=w<d?w:d,d=S<d?S:d,d=T<d?T:d,m=b,m=E<m?E:m,m=x<m?x:m,m=N<m?N:m,v=y,v=w>v?w:v,v=S>v?S:v,v=T>v?T:v,g=b,g=E>g?E:g,g=x>g?x:g,g=N>g?N:g}if(this.children.length){var C=this.containerGetBounds();r=C.x,i=C.x+C.width,s=C.y,o=C.y+C.height,d=d<r?d:r,m=m<s?m:s,v=v>i?v:i,g=g>o?g:o}var k=this._bounds;k.x=d,k.width=v-d,k.y=m,k.height=g-m,this._currentBounds=k}return this._currentBounds},Sprite.prototype.getLocalBounds=function(){return this._bounds.x=-this._texture._frame.width*this.anchor.x,this._bounds.y=-this._texture._frame.height*this.anchor.y,this._bounds.width=this._texture._frame.width,this._bounds.height=this._texture._frame.height,this._bounds},Sprite.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,tempPoint);var t=this._texture._frame.width,n=this._texture._frame.height,r=-t*this.anchor.x,i;if(tempPoint.x>r&&tempPoint.x<r+t){i=-n*this.anchor.y;if(tempPoint.y>i&&tempPoint.y<i+n)return!0}return!1},Sprite.prototype._renderCanvas=function(e){if(this.texture.crop.width<=0||this.texture.crop.height<=0)return;var t=e.blendModes[this.blendMode];t!==e.context.globalCompositeOperation&&(e.context.globalCompositeOperation=t);if(this.texture.valid){var n=this._texture,r=this.worldTransform,i,s,o,u;e.context.globalAlpha=this.worldAlpha;var a=n.baseTexture.scaleMode===CONST.SCALE_MODES.LINEAR;e.smoothProperty&&e.context[e.smoothProperty]!==a&&(e.context[e.smoothProperty]=a);if(n.rotate){var f=r.a,l=r.b;r.a=-r.c,r.b=-r.d,r.c=f,r.d=l,o=n.crop.height,u=n.crop.width,i=n.trim?n.trim.y-this.anchor.y*n.trim.height:this.anchor.y*-n._frame.height,s=n.trim?n.trim.x-this.anchor.x*n.trim.width:this.anchor.x*-n._frame.width}else o=n.crop.width,u=n.crop.height,i=n.trim?n.trim.x-this.anchor.x*n.trim.width:this.anchor.x*-n._frame.width,s=n.trim?n.trim.y-this.anchor.y*n.trim.height:this.anchor.y*-n._frame.height;e.roundPixels?(e.context.setTransform(r.a,r.b,r.c,r.d,r.tx*e.resolution|0,r.ty*e.resolution|0),i|=0,s|=0):e.context.setTransform(r.a,r.b,r.c,r.d,r.tx*e.resolution,r.ty*e.resolution);var c=n.baseTexture.resolution;this.tint!==16777215?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=CanvasTinter.getTintedTexture(this,this.tint)),e.context.drawImage(this.tintedTexture,0,0,o*c,u*c,i*e.resolution,s*e.resolution,o*e.resolution,u*e.resolution)):e.context.drawImage(n.baseTexture.source,n.crop.x*c,n.crop.y*c,o*c,u*c,i*e.resolution,s*e.resolution,o*e.resolution,u*e.resolution)}},Sprite.prototype.destroy=function(e,t){Container.prototype.destroy.call(this),this.anchor=null,e&&this._texture.destroy(t),this._texture=null,this.shader=null},Sprite.fromFrame=function(e){var t=utils.TextureCache[e];if(!t)throw new Error('The frameId "'+e+'" does not exist in the texture cache');return new Sprite(t)},Sprite.fromImage=function(e,t,n){return new Sprite(Texture.fromImage(e,t,n))};