function TilingSprite(e,t,n){core.Sprite.call(this,e),this.tileScale=new core.Point(1,1),this.tilePosition=new core.Point(0,0),this._width=t||100,this._height=n||100,this._uvs=new core.TextureUvs,this._canvasPattern=null,this.shader=new core.AbstractFilter(["precision lowp float;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","uniform mat3 projectionMatrix;","uniform vec4 uFrame;","uniform vec4 uTransform;","varying vec2 vTextureCoord;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vec2 coord = aTextureCoord;","   coord -= uTransform.xy;","   coord /= uTransform.zw;","   vTextureCoord = coord;","   vColor = vec4(aColor.rgb * aColor.a, aColor.a);","}"].join("\n"),["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform vec4 uFrame;","uniform vec2 uPixelSize;","void main(void){","   vec2 coord = mod(vTextureCoord, uFrame.zw);","   coord = clamp(coord, uPixelSize, uFrame.zw - uPixelSize);","   coord += uFrame.xy;","   gl_FragColor =  texture2D(uSampler, coord) * vColor ;","}"].join("\n"),{uFrame:{type:"4fv",value:[0,0,1,1]},uTransform:{type:"4fv",value:[0,0,1,1]},uPixelSize:{type:"2fv",value:[1,1]}})}var core=require("../core"),tempPoint=new core.Point,CanvasTinter=require("../core/renderers/canvas/utils/CanvasTinter");TilingSprite.prototype=Object.create(core.Sprite.prototype),TilingSprite.prototype.constructor=TilingSprite,module.exports=TilingSprite,Object.defineProperties(TilingSprite.prototype,{width:{get:function(){return this._width},set:function(e){this._width=e}},height:{get:function(){return this._height},set:function(e){this._height=e}}}),TilingSprite.prototype._onTextureUpdate=function(){return},TilingSprite.prototype._renderWebGL=function(e){var t=this._texture;if(!t||!t._uvs)return;var n=t._uvs,r=t._frame.width,i=t._frame.height,s=t.baseTexture.width,o=t.baseTexture.height;t._uvs=this._uvs,t._frame.width=this.width,t._frame.height=this.height,this.shader.uniforms.uPixelSize.value[0]=1/s,this.shader.uniforms.uPixelSize.value[1]=1/o,this.shader.uniforms.uFrame.value[0]=n.x0,this.shader.uniforms.uFrame.value[1]=n.y0,this.shader.uniforms.uFrame.value[2]=n.x1-n.x0,this.shader.uniforms.uFrame.value[3]=n.y2-n.y0,this.shader.uniforms.uTransform.value[0]=this.tilePosition.x%(r*this.tileScale.x)/this._width,this.shader.uniforms.uTransform.value[1]=this.tilePosition.y%(i*this.tileScale.y)/this._height,this.shader.uniforms.uTransform.value[2]=s/this._width*this.tileScale.x,this.shader.uniforms.uTransform.value[3]=o/this._height*this.tileScale.y,e.setObjectRenderer(e.plugins.sprite),e.plugins.sprite.render(this),t._uvs=n,t._frame.width=r,t._frame.height=i},TilingSprite.prototype._renderCanvas=function(e){var t=this._texture;if(!t.baseTexture.hasLoaded)return;var n=e.context,r=this.worldTransform,i=e.resolution,s=t.baseTexture,o=this.tilePosition.x/this.tileScale.x%t._frame.width,u=this.tilePosition.y/this.tileScale.y%t._frame.height;if(!this._canvasPattern){var a=new core.CanvasBuffer(t._frame.width,t._frame.height);this.tint!==16777215?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=CanvasTinter.getTintedTexture(this,this.tint)),a.context.drawImage(this.tintedTexture,0,0)):a.context.drawImage(s.source,-t._frame.x,-t._frame.y),this._canvasPattern=a.context.createPattern(a.canvas,"repeat")}n.globalAlpha=this.worldAlpha,n.setTransform(r.a*i,r.b*i,r.c*i,r.d*i,r.tx*i,r.ty*i),n.scale(this.tileScale.x,this.tileScale.y),n.translate(o+this.anchor.x*-this._width,u+this.anchor.y*-this._height);var f=e.blendModes[this.blendMode];f!==e.context.globalCompositeOperation&&(n.globalCompositeOperation=f),n.fillStyle=this._canvasPattern,n.fillRect(-o,-u,this._width/this.tileScale.x,this._height/this.tileScale.y)},TilingSprite.prototype.getBounds=function(){var e=this._width,t=this._height,n=e*(1-this.anchor.x),r=e*-this.anchor.x,i=t*(1-this.anchor.y),s=t*-this.anchor.y,o=this.worldTransform,u=o.a,a=o.b,f=o.c,l=o.d,c=o.tx,h=o.ty,p=u*r+f*s+c,d=l*s+a*r+h,v=u*n+f*s+c,m=l*s+a*n+h,g=u*n+f*i+c,y=l*i+a*n+h,b=u*r+f*i+c,w=l*i+a*r+h,E,S,x,T;E=p,E=v<E?v:E,E=g<E?g:E,E=b<E?b:E,x=d,x=m<x?m:x,x=y<x?y:x,x=w<x?w:x,S=p,S=v>S?v:S,S=g>S?g:S,S=b>S?b:S,T=d,T=m>T?m:T,T=y>T?y:T,T=w>T?w:T;var N=this._bounds;return N.x=E,N.width=S-E,N.y=x,N.height=T-x,this._currentBounds=N,N},TilingSprite.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,tempPoint);var t=this._width,n=this._height,r=-t*this.anchor.x,i;if(tempPoint.x>r&&tempPoint.x<r+t){i=-n*this.anchor.y;if(tempPoint.y>i&&tempPoint.y<i+n)return!0}return!1},TilingSprite.prototype.destroy=function(){core.Sprite.prototype.destroy.call(this),this.tileScale=null,this._tileScaleOffset=null,this.tilePosition=null,this._uvs=null},TilingSprite.fromFrame=function(e,t,n){var r=core.utils.TextureCache[e];if(!r)throw new Error('The frameId "'+e+'" does not exist in the texture cache '+this);return new TilingSprite(r,t,n)},TilingSprite.fromImage=function(e,t,n,r,i){return new TilingSprite(core.Texture.fromImage(e,r,i),t,n)};