/*! jQuery UI - v1.11.4 - 2015-03-13
* http://jqueryui.com
* Copyright jQuery Foundation and other contributors; Licensed MIT */

(function(e){"function"==typeof define&&define.amd?define(["jquery","./core","./widget","./mouse","./draggable"],e):e(jQuery)})(function(e){return e.widget("ui.droppable",{version:"1.11.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var n,r=this.options,i=r.accept;this.isover=!1,this.isout=!0,this.accept=e.isFunction(i)?i:function(e){return e.is(i)},this.proportions=function(){return arguments.length?(n=arguments[0],void 0):n?n:n={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(r.scope),r.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(n){e.ui.ddmanager.droppables[n]=e.ui.ddmanager.droppables[n]||[],e.ui.ddmanager.droppables[n].push(this)},_splice:function(e){for(var t=0;e.length>t;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var n=e.ui.ddmanager.droppables[this.options.scope];this._splice(n),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(n,r){if("accept"===n)this.accept=e.isFunction(r)?r:function(e){return e.is(r)};else if("scope"===n){var i=e.ui.ddmanager.droppables[this.options.scope];this._splice(i),this._addToManager(r)}this._super(n,r)},_activate:function(n){var r=e.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),r&&this._trigger("activate",n,this.ui(r))},_deactivate:function(n){var r=e.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),r&&this._trigger("deactivate",n,this.ui(r))},_over:function(n){var r=e.ui.ddmanager.current;r&&(r.currentItem||r.element)[0]!==this.element[0]&&this.accept.call(this.element[0],r.currentItem||r.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",n,this.ui(r)))},_out:function(n){var r=e.ui.ddmanager.current;r&&(r.currentItem||r.element)[0]!==this.element[0]&&this.accept.call(this.element[0],r.currentItem||r.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",n,this.ui(r)))},_drop:function(n,r){var i=r||e.ui.ddmanager.current,s=!1;return i&&(i.currentItem||i.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var r=e(this).droppable("instance");return r.options.greedy&&!r.options.disabled&&r.options.scope===i.options.scope&&r.accept.call(r.element[0],i.currentItem||i.element)&&e.ui.intersect(i,e.extend(r,{offset:r.element.offset()}),r.options.tolerance,n)?(s=!0,!1):void 0}),s?!1:this.accept.call(this.element[0],i.currentItem||i.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",n,this.ui(i)),this.element):!1):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}}}),e.ui.intersect=function(){function e(e,t,n){return e>=t&&t+n>e}return function(n,r,i,s){if(!r.offset)return!1;var o=(n.positionAbs||n.position.absolute).left+n.margins.left,u=(n.positionAbs||n.position.absolute).top+n.margins.top,a=o+n.helperProportions.width,f=u+n.helperProportions.height,l=r.offset.left,c=r.offset.top,h=l+r.proportions().width,p=c+r.proportions().height;switch(i){case"fit":return o>=l&&h>=a&&u>=c&&p>=f;case"intersect":return o+n.helperProportions.width/2>l&&h>a-n.helperProportions.width/2&&u+n.helperProportions.height/2>c&&p>f-n.helperProportions.height/2;case"pointer":return e(s.pageY,c,r.proportions().height)&&e(s.pageX,l,r.proportions().width);case"touch":return(u>=c&&p>=u||f>=c&&p>=f||c>u&&f>p)&&(o>=l&&h>=o||a>=l&&h>=a||l>o&&a>h);default:return!1}}}(),e.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(n,r){var i,s,o=e.ui.ddmanager.droppables[n.options.scope]||[],u=r?r.type:null,a=(n.currentItem||n.element).find(":data(ui-droppable)").addBack();e:for(i=0;o.length>i;i++)if(!(o[i].options.disabled||n&&!o[i].accept.call(o[i].element[0],n.currentItem||n.element))){for(s=0;a.length>s;s++)if(a[s]===o[i].element[0]){o[i].proportions().height=0;continue e}o[i].visible="none"!==o[i].element.css("display"),o[i].visible&&("mousedown"===u&&o[i]._activate.call(o[i],r),o[i].offset=o[i].element.offset(),o[i].proportions({width:o[i].element[0].offsetWidth,height:o[i].element[0].offsetHeight}))}},drop:function(n,r){var i=!1;return e.each((e.ui.ddmanager.droppables[n.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&e.ui.intersect(n,this,this.options.tolerance,r)&&(i=this._drop.call(this,r)||i),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],n.currentItem||n.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,r)))}),i},dragStart:function(n,r){n.element.parentsUntil("body").bind("scroll.droppable",function(){n.options.refreshPositions||e.ui.ddmanager.prepareOffsets(n,r)})},drag:function(n,r){n.options.refreshPositions&&e.ui.ddmanager.prepareOffsets(n,r),e.each(e.ui.ddmanager.droppables[n.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var s,o,u,a=e.ui.intersect(n,this,this.options.tolerance,r),f=!a&&this.isover?"isout":a&&!this.isover?"isover":null;f&&(this.options.greedy&&(o=this.options.scope,u=this.element.parents(":data(ui-droppable)").filter(function(){return e(this).droppable("instance").options.scope===o}),u.length&&(s=e(u[0]).droppable("instance"),s.greedyChild="isover"===f)),s&&"isover"===f&&(s.isover=!1,s.isout=!0,s._out.call(s,r)),this[f]=!0,this["isout"===f?"isover":"isout"]=!1,this["isover"===f?"_over":"_out"].call(this,r),s&&"isout"===f&&(s.isout=!1,s.isover=!0,s._over.call(s,r)))}})},dragStop:function(n,r){n.element.parentsUntil("body").unbind("scroll.droppable"),n.options.refreshPositions||e.ui.ddmanager.prepareOffsets(n,r)}},e.ui.droppable});