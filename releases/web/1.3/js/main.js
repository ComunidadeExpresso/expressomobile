/*! jQuery v2.0.3 | (c) 2005, 2013 jQuery Foundation, Inc. | jquery.org/license
*/

//     Underscore.js 1.5.1
//     http://underscorejs.org
//     (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

/*
 *      jquery.xmpp.js
 *
 *      Copyright 2011 Alvaro Garcia <maxpowel@gmail.com>
 *
 *      This program is free software; you can redistribute it and/or modify
 *      it under the terms of the GNU General Public License as published by
 *      the Free Software Foundation; either version 3 of the License, or
 *      (at your option) any later version.
 *
 *      This program is distributed in the hope that it will be useful,
 *      but WITHOUT ANY WARRANTY; without even the implied warranty of
 *      MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *      GNU General Public License for more details.
 *
 *      You should have received a copy of the GNU General Public License
 *      along with this program; if not, write to the Free Software
 *      Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
 *      MA 02110-1301, USA.
 */

/**
 * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message
 * Digest Algorithm, as defined in RFC 1321.
 * Version 2.1 Copyright (C) Paul Johnston 1999 - 2002.
 * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet
 * Distributed under the BSD License
 * See http://pajhome.org.uk/crypt/md5 for more info.
 **/

/*
 RequireJS text 0.27.0 Copyright (c) 2010-2011, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/jrburke/requirejs for details
*/

// moment.js
// version : 2.1.0
// author : Tim Wood
// license : MIT
// momentjs.com

/*!
 * iScroll v4.2.5 ~ Copyright (c) 2012 Matteo Spinelli, http://cubiq.org
 * Released under MIT license, http://cubiq.org/license
 */

// THIS AUTOCOMPLETE WIDGET WAS MODIFIED TO WORK IN OUR APPLICATION,
// THINK TWICE BEFORE UPDATING THIS FILE TO A NEW VERSION.
//
//
//
//
//
// jQuery & Backbone JS Autocomplete Widget
//
// Copyright 2011 Planbox (www.planbox.com)
// Author Martin Drapeau
//
// Pass a Backbone collection and a model attribute to specify
// values for autocomplete. Apply this on an INPUT element.
// For example:
// 
//   $('input').autocomplete({
//       collection: collection,
//       attr: 'name'
//   });
//
// Constructs a UL and places it before the INPUT element.
// Will open right below, left-aligned. LI's get added the
// selected class upon hover or when the user navigates with
// the keyboard. Pressing TAB or ENTER when an item is selected
// changes the value in the INPUT. Or, if you specified a 
// callback (option onselect), will instead trigger it passing
// the selected model as argument.
//
// Options:
//   collection: The Backbone collection.
//   attr: The attribute to autocomplete on.
//   noCase: Optional. Set to true if your values are strings 
//          and you want autocomplete to be case insensitive.
//   onselect: Optional. Callback to be called when an item is
//          selected. If callback is not set, will modify the 
//          INPUT value to what has been selected.
//   scrollable_ancestor_em: Optional. If your element is inside
//          a scrollabale element, set this option to it.
//   ul_css, ul_class: Optional. Set to specify element style
//          and element class (uses jQuery's css and addClass
//          functions).
//   li_css, li_class: Optional. Set to specify element style
//          and element class (uses jQuery's css and addClass
//          functions).
//   width: Optional. Set to force a width. Otherwise will be
//          set to the width of the INPUT element.
//
// Methods:
//   show: Call to force showing the list.
//   destroy: Call to destroy and remove the widget from the
//         element.
//
// CSS: By default the UL will have class autocomplete. That
// can be overriden through option ul_class. Here is the 
// suggested styling to put in your .css file:
//    ul.autocomplete {
//    	position:absolute;
//    	background-color:white;
//    	border:1px solid #999;
//    	width:100%;
//    	font-size:12px;
//    	overflow-x:hidden;
//    	overflow-y:auto;
//    	clear:both;
//      z-index:1000;}
//    
//    ul.autocomplete li {
//    	list-style:none;
//    	cursor:pointer;
//    	padding:5px;}
//    
//    ul.autocomplete li.selected {
//    	background-color:#E1EFF9;}
//
// Note: Calling autocomplete on an element twice resets the
// widget.
//

/*! jQuery UI - v1.10.3 - 2013-08-07
* http://jqueryui.com
* Includes: jquery.ui.core.js, jquery.ui.datepicker.js
* Copyright 2013 jQuery Foundation and other contributors Licensed MIT */

(function(e,undefined){function j(e){var t=e.length,n=x.type(e);return x.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}function A(e){var t=D[e]={};return x.each(e.match(w)||[],function(e,n){t[n]=!0}),t}function F(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=x.expando+Math.random()}function P(e,t,n){var r;if(n===undefined&&1===e.nodeType)if(r="data-"+t.replace(O,"-$1").toLowerCase(),n=e.getAttribute(r),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:H.test(n)?JSON.parse(n):n}catch(i){}L.set(e,t,n)}else n=undefined;return n}function U(){return!0}function Y(){return!1}function V(){try{return o.activeElement}catch(e){}}function Z(e,t){while((e=e[t])&&1!==e.nodeType);return e}function et(e,t,n){if(x.isFunction(t))return x.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return x.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(G.test(t))return x.filter(t,e,n);t=x.filter(t,e)}return x.grep(e,function(e){return g.call(t,e)>=0!==n})}function pt(e,t){return x.nodeName(e,"table")&&x.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function ft(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function ht(e){var t=ut.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function dt(e,t){var n=e.length,r=0;for(;n>r;r++)q.set(e[r],"globalEval",!t||q.get(t[r],"globalEval"))}function gt(e,t){var n,r,i,s,o,u,a,f;if(1===t.nodeType){if(q.hasData(e)&&(s=q.access(e),o=q.set(t,s),f=s.events)){delete o.handle,o.events={};for(i in f)for(n=0,r=f[i].length;r>n;n++)x.event.add(t,i,f[i][n])}L.hasData(e)&&(u=L.access(e),a=x.extend({},u),L.set(t,a))}}function mt(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return t===undefined||t&&x.nodeName(e,t)?x.merge([e],n):n}function yt(e,t){var n=t.nodeName.toLowerCase();"input"===n&&ot.test(e.type)?t.checked=e.checked:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}function At(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=Dt.length;while(i--)if(t=Dt[i]+n,t in e)return t;return r}function Lt(e,t){return e=t||e,"none"===x.css(e,"display")||!x.contains(e.ownerDocument,e)}function qt(t){return e.getComputedStyle(t,null)}function Ht(e,t){var n,r,i,s=[],o=0,u=e.length;for(;u>o;o++)r=e[o],r.style&&(s[o]=q.get(r,"olddisplay"),n=r.style.display,t?(s[o]||"none"!==n||(r.style.display=""),""===r.style.display&&Lt(r)&&(s[o]=q.access(r,"olddisplay",Rt(r.nodeName)))):s[o]||(i=Lt(r),(n&&"none"!==n||!i)&&q.set(r,"olddisplay",i?n:x.css(r,"display"))));for(o=0;u>o;o++)r=e[o],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?s[o]||"":"none"));return e}function Ot(e,t,n){var r=Tt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function Ft(e,t,n,r,i){var s=n===(r?"border":"content")?4:"width"===t?1:0,o=0;for(;4>s;s+=2)"margin"===n&&(o+=x.css(e,n+jt[s],!0,i)),r?("content"===n&&(o-=x.css(e,"padding"+jt[s],!0,i)),"margin"!==n&&(o-=x.css(e,"border"+jt[s]+"Width",!0,i))):(o+=x.css(e,"padding"+jt[s],!0,i),"padding"!==n&&(o+=x.css(e,"border"+jt[s]+"Width",!0,i)));return o}function Pt(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,s=qt(e),o=x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,s);if(0>=i||null==i){if(i=vt(e,t,s),(0>i||null==i)&&(i=e.style[t]),Ct.test(i))return i;r=o&&(x.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+Ft(e,t,n||(o?"border":"content"),r,s)+"px"}function Rt(e){var t=o,n=Nt[e];return n||(n=Mt(e,t),"none"!==n&&n||(xt=(xt||x("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(xt[0].contentWindow||xt[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=Mt(e,t),xt.detach()),Nt[e]=n),n}function Mt(e,t){var n=x(t.createElement(e)).appendTo(t.body),r=x.css(n[0],"display");return n.remove(),r}function _t(e,t,n,r){var i;if(x.isArray(t))x.each(t,function(t,i){n||$t.test(e)?r(e,i):_t(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==x.type(t))r(e,t);else for(i in t)_t(e+"["+i+"]",t[i],n,r)}function un(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(w)||[];if(x.isFunction(n))while(r=s[i++])"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function ln(e,t,n,r){function o(u){var a;return i[u]=!0,x.each(e[u]||[],function(e,u){var f=u(t,n,r);return"string"!=typeof f||s||i[f]?s?!(a=f):undefined:(t.dataTypes.unshift(f),o(f),!1)}),a}var i={},s=e===on;return o(t.dataTypes[0])||!i["*"]&&o("*")}function cn(e,t){var n,r,i=x.ajaxSettings.flatOptions||{};for(n in t)t[n]!==undefined&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&x.extend(!0,e,r),e}function pn(e,t,n){var r,i,s,o,u=e.contents,a=e.dataTypes;while("*"===a[0])a.shift(),r===undefined&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in u)if(u[i]&&u[i].test(r)){a.unshift(i);break}if(a[0]in n)s=a[0];else{for(i in n){if(!a[0]||e.converters[i+" "+a[0]]){s=i;break}o||(o=i)}s=s||o}return s?(s!==a[0]&&a.unshift(s),n[s]):undefined}function fn(e,t,n,r){var i,s,o,u,a,f={},l=e.dataTypes.slice();if(l[1])for(o in e.converters)f[o.toLowerCase()]=e.converters[o];s=l.shift();while(s)if(e.responseFields[s]&&(n[e.responseFields[s]]=t),!a&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a=s,s=l.shift())if("*"===s)s=a;else if("*"!==a&&a!==s){if(o=f[a+" "+s]||f["* "+s],!o)for(i in f)if(u=i.split(" "),u[1]===s&&(o=f[a+" "+u[0]]||f["* "+u[0]])){o===!0?o=f[i]:f[i]!==!0&&(s=u[0],l.unshift(u[1]));break}if(o!==!0)if(o&&e["throws"])t=o(t);else try{t=o(t)}catch(c){return{state:"parsererror",error:o?c:"No conversion from "+a+" to "+s}}}return{state:"success",data:t}}function En(){return setTimeout(function(){xn=undefined}),xn=x.now()}function Sn(e,t,n){var r,i=(Nn[t]||[]).concat(Nn["*"]),s=0,o=i.length;for(;o>s;s++)if(r=i[s].call(n,t,e))return r}function jn(e,t,n){var r,i,s=0,o=kn.length,u=x.Deferred().always(function(){delete a.elem}),a=function(){if(i)return!1;var t=xn||En(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,s=1-r,o=0,a=f.tweens.length;for(;a>o;o++)f.tweens[o].run(s);return u.notifyWith(e,[f,s,n]),1>s&&a?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:x.extend({},t),opts:x.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:xn||En(),duration:n.duration,tweens:[],createTween:function(t,n){var r=x.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(r),r},stop:function(t){var n=0,r=t?f.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;for(Dn(l,f.opts.specialEasing);o>s;s++)if(r=kn[s].call(f,e,l,f.opts))return r;return x.map(l,Sn,f),x.isFunction(f.opts.start)&&f.opts.start.call(e,f),x.fx.timer(x.extend(a,{elem:e,anim:f,queue:f.opts.queue})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function Dn(e,t){var n,r,i,s,o;for(n in e)if(r=x.camelCase(n),i=t[r],s=e[n],x.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=x.cssHooks[r],o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}function An(e,t,n){var r,i,s,o,u,a,f=this,l={},c=e.style,h=e.nodeType&&Lt(e),p=q.get(e,"fxshow");n.queue||(u=x._queueHooks(e,"fx"),null==u.unqueued&&(u.unqueued=0,a=u.empty.fire,u.empty.fire=function(){u.unqueued||a()}),u.unqueued++,f.always(function(){f.always(function(){u.unqueued--,x.queue(e,"fx").length||u.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[c.overflow,c.overflowX,c.overflowY],"inline"===x.css(e,"display")&&"none"===x.css(e,"float")&&(c.display="inline-block")),n.overflow&&(c.overflow="hidden",f.always(function(){c.overflow=n.overflow[0],c.overflowX=n.overflow[1],c.overflowY=n.overflow[2]}));for(r in t)if(i=t[r],wn.exec(i)){if(delete t[r],s=s||"toggle"===i,i===(h?"hide":"show")){if("show"!==i||!p||p[r]===undefined)continue;h=!0}l[r]=p&&p[r]||x.style(e,r)}if(!x.isEmptyObject(l)){p?"hidden"in p&&(h=p.hidden):p=q.access(e,"fxshow",{}),s&&(p.hidden=!h),h?x(e).show():f.done(function(){x(e).hide()}),f.done(function(){var t;q.remove(e,"fxshow");for(t in l)x.style(e,t,l[t])});for(r in l)o=Sn(h?p[r]:0,r,f),r in p||(p[r]=o.start,h&&(o.end=o.start,o.start="width"===r||"height"===r?1:0))}}function Ln(e,t,n,r,i){return new Ln.prototype.init(e,t,n,r,i)}function qn(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=jt[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function Hn(e){return x.isWindow(e)?e:9===e.nodeType&&e.defaultView}var t,n,r=typeof undefined,i=e.location,o=e.document,s=o.documentElement,a=e.jQuery,u=e.$,l={},c=[],p="2.0.3",f=c.concat,h=c.push,d=c.slice,g=c.indexOf,m=l.toString,y=l.hasOwnProperty,v=p.trim,x=function(e,n){return new x.fn.init(e,n,t)},b=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,w=/\S+/g,T=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,C=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,k=/^-ms-/,N=/-([\da-z])/gi,E=function(e,t){return t.toUpperCase()},S=function(){o.removeEventListener("DOMContentLoaded",S,!1),e.removeEventListener("load",S,!1),x.ready()};x.fn=x.prototype={jquery:p,constructor:x,init:function(e,t,n){var r,i;if(!e)return this;if("string"==typeof e){if(r="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:T.exec(e),!r||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof x?t[0]:t,x.merge(this,x.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:o,!0)),C.test(r[1])&&x.isPlainObject(t))for(r in t)x.isFunction(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return i=o.getElementById(r[2]),i&&i.parentNode&&(this.length=1,this[0]=i),this.context=o,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):x.isFunction(e)?n.ready(e):(e.selector!==undefined&&(this.selector=e.selector,this.context=e.context),x.makeArray(e,this))},selector:"",length:0,toArray:function(){return d.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=x.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return x.each(this,e,t)},ready:function(e){return x.ready.promise().done(e),this},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(x.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:h,sort:[].sort,splice:[].splice},x.fn.init.prototype=x.fn,x.extend=x.fn.extend=function(){var e,t,n,r,i,s,o=arguments[0]||{},u=1,a=arguments.length,f=!1;for("boolean"==typeof o&&(f=o,o=arguments[1]||{},u=2),"object"==typeof o||x.isFunction(o)||(o={}),a===u&&(o=this,--u);a>u;u++)if(null!=(e=arguments[u]))for(t in e)n=o[t],r=e[t],o!==r&&(f&&r&&(x.isPlainObject(r)||(i=x.isArray(r)))?(i?(i=!1,s=n&&x.isArray(n)?n:[]):s=n&&x.isPlainObject(n)?n:{},o[t]=x.extend(f,s,r)):r!==undefined&&(o[t]=r));return o},x.extend({expando:"jQuery"+(p+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===x&&(e.$=u),t&&e.jQuery===x&&(e.jQuery=a),x},isReady:!1,readyWait:1,holdReady:function(e){e?x.readyWait++:x.ready(!0)},ready:function(e){(e===!0?--x.readyWait:x.isReady)||(x.isReady=!0,e!==!0&&--x.readyWait>0||(n.resolveWith(o,[x]),x.fn.trigger&&x(o).trigger("ready").off("ready")))},isFunction:function(e){return"function"===x.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[m.call(e)]||"object":typeof e},isPlainObject:function(e){if("object"!==x.type(e)||e.nodeType||x.isWindow(e))return!1;try{if(e.constructor&&!y.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||o;var r=C.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=x.buildFragment([e],t,i),i&&x(i).remove(),x.merge([],r.childNodes))},parseJSON:JSON.parse,parseXML:function(e){var t,n;if(!e||"string"!=typeof e)return null;try{n=new DOMParser,t=n.parseFromString(e,"text/xml")}catch(r){t=undefined}return(!t||t.getElementsByTagName("parsererror").length)&&x.error("Invalid XML: "+e),t},noop:function(){},globalEval:function(e){var t,n=eval;e=x.trim(e),e&&(1===e.indexOf("use strict")?(t=o.createElement("script"),t.text=e,o.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(k,"ms-").replace(N,E)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,s=e.length,o=j(e);if(n){if(o){for(;s>i;i++)if(r=t.apply(e[i],n),r===!1)break}else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(o){for(;s>i;i++)if(r=t.call(e[i],i,e[i]),r===!1)break}else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:function(e){return null==e?"":v.call(e)},makeArray:function(e,t){var n=t||[];return null!=e&&(j(Object(e))?x.merge(n,"string"==typeof e?[e]:e):h.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:g.call(t,e,n)},merge:function(e,t){var n=t.length,r=e.length,i=0;if("number"==typeof n)for(;n>i;i++)e[r++]=t[i];else while(t[i]!==undefined)e[r++]=t[i++];return e.length=r,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;for(n=!!n;o>s;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,t,n){var r,i=0,s=e.length,o=j(e),u=[];if(o)for(;s>i;i++)r=t(e[i],i,n),null!=r&&(u[u.length]=r);else for(i in e)r=t(e[i],i,n),null!=r&&(u[u.length]=r);return f.apply([],u)},guid:1,proxy:function(e,t){var n,r,i;return"string"==typeof t&&(n=e[t],t=e,e=n),x.isFunction(e)?(r=d.call(arguments,2),i=function(){return e.apply(t||this,r.concat(d.call(arguments)))},i.guid=e.guid=e.guid||x.guid++,i):undefined},access:function(e,t,n,r,i,s,o){var u=0,a=e.length,f=null==n;if("object"===x.type(n)){i=!0;for(u in n)x.access(e,t,u,n[u],!0,s,o)}else if(r!==undefined&&(i=!0,x.isFunction(r)||(o=!0),f&&(o?(t.call(e,r),t=null):(f=t,t=function(e,t,n){return f.call(x(e),n)})),t))for(;a>u;u++)t(e[u],n,o?r:r.call(e[u],u,t(e[u],n)));return i?e:f?t.call(e):a?t(e[0],n):s},now:Date.now,swap:function(e,t,n,r){var i,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];i=n.apply(e,r||[]);for(s in t)e.style[s]=o[s];return i}}),x.ready.promise=function(t){return n||(n=x.Deferred(),"complete"===o.readyState?setTimeout(x.ready):(o.addEventListener("DOMContentLoaded",S,!1),e.addEventListener("load",S,!1))),n.promise(t)},x.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()}),t=x(o),function(e,t){function ot(e,t,n,i){var s,o,u,a,f,l,p,m,g,E;if((t?t.ownerDocument||t:w)!==h&&c(t),t=t||h,n=n||[],!e||"string"!=typeof e)return n;if(1!==(a=t.nodeType)&&9!==a)return[];if(d&&!i){if(s=Z.exec(e))if(u=s[1]){if(9===a){if(o=t.getElementById(u),!o||!o.parentNode)return n;if(o.id===u)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(u))&&y(t,o)&&o.id===u)return n.push(o),n}else{if(s[2])return H.apply(n,t.getElementsByTagName(e)),n;if((u=s[3])&&r.getElementsByClassName&&t.getElementsByClassName)return H.apply(n,t.getElementsByClassName(u)),n}if(r.qsa&&(!v||!v.test(e))){if(m=p=b,g=t,E=9===a&&e,1===a&&"object"!==t.nodeName.toLowerCase()){l=mt(e),(p=t.getAttribute("id"))?m=p.replace(nt,"\\$&"):t.setAttribute("id",m),m="[id='"+m+"'] ",f=l.length;while(f--)l[f]=m+gt(l[f]);g=$.test(e)&&t.parentNode||t,E=l.join(",")}if(E)try{return H.apply(n,g.querySelectorAll(E)),n}catch(S){}finally{p||t.removeAttribute("id")}}}return Nt(e.replace(W,"$1"),t,n,i)}function ut(){function t(n,r){return e.push(n+=" ")>s.cacheLength&&delete t[e.shift()],t[n]=r}var e=[];return t}function at(e){return e[b]=!0,e}function ft(e){var t=h.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function lt(e,t){var n=e.split("|"),r=e.length;while(r--)s.attrHandle[n[r]]=t}function ct(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||O)-(~e.sourceIndex||O);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function ht(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function pt(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function dt(e){return at(function(t){return t=+t,at(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function vt(){}function mt(e,t){var n,r,i,o,u,a,f,l=N[e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=s.preFilter;while(u){(!n||(r=X.exec(u)))&&(r&&(u=u.slice(r[0].length)||u),a.push(i=[])),n=!1,(r=V.exec(u))&&(n=r.shift(),i.push({value:n,type:r[0].replace(W," ")}),u=u.slice(n.length));for(o in s.filter)!(r=G[o].exec(u))||f[o]&&!(r=f[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),u=u.slice(n.length));if(!n)break}return t?u.length:u?ot.error(e):N(e,a).slice(0)}function gt(e){var t=0,n=e.length,r="";for(;n>t;t++)r+=e[t].value;return r}function yt(e,t,n){var r=t.dir,s=n&&"parentNode"===r,o=S++;return t.first?function(t,n,i){while(t=t[r])if(1===t.nodeType||s)return e(t,n,i)}:function(t,n,u){var a,f,l,c=E+" "+o;if(u){while(t=t[r])if((1===t.nodeType||s)&&e(t,n,u))return!0}else while(t=t[r])if(1===t.nodeType||s)if(l=t[b]||(t[b]={}),(f=l[r])&&f[0]===c){if((a=f[1])===!0||a===i)return a===!0}else if(f=l[r]=[c],f[1]=e(t,n,u)||i,f[1]===!0)return!0}}function bt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function wt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=null!=t;for(;a>u;u++)(s=e[u])&&(!n||n(s,r,i))&&(o.push(s),f&&t.push(u));return o}function Et(e,t,n,r,i,s){return r&&!r[b]&&(r=Et(r)),i&&!i[b]&&(i=Et(i,s)),at(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||Tt(t||"*",u.nodeType?[u]:u,[]),m=!e||!s&&t?v:wt(v,h,e,u,a),g=n?i||(s?e:d||r)?[]:o:m;if(n&&n(m,g,u,a),r){f=wt(g,p),r(f,[],u,a),l=f.length;while(l--)(c=f[l])&&(g[p[l]]=!(m[p[l]]=c))}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?j.call(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=wt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):H.apply(o,g)})}function St(e){var t,n,r,i=e.length,o=s.relative[e[0].type],u=o||s.relative[" "],a=o?1:0,l=yt(function(e){return e===t},u,!0),c=yt(function(e){return j.call(t,e)>-1},u,!0),h=[function(e,n,r){return!o&&(r||n!==f)||((t=n).nodeType?l(e,n,r):c(e,n,r))}];for(;i>a;a++)if(n=s.relative[e[a].type])h=[yt(bt(h),n)];else{if(n=s.filter[e[a].type].apply(null,e[a].matches),n[b]){for(r=++a;i>r;r++)if(s.relative[e[r].type])break;return Et(a>1&&bt(h),a>1&&gt(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(W,"$1"),n,r>a&&St(e.slice(a,r)),i>r&&St(e=e.slice(r)),i>r&&gt(e))}h.push(n)}return bt(h)}function xt(e,t){var n=0,r=t.length>0,o=e.length>0,u=function(u,a,l,c,p){var d,v,m,g=[],y=0,b="0",w=u&&[],S=null!=p,x=f,T=u||o&&s.find.TAG("*",p&&a.parentNode||a),N=E+=null==x?1:Math.random()||.1;for(S&&(f=a!==h&&a,i=n);null!=(d=T[b]);b++){if(o&&d){v=0;while(m=e[v++])if(m(d,a,l)){c.push(d);break}S&&(E=N,i=++n)}r&&((d=!m&&d)&&y--,u&&w.push(d))}if(y+=b,r&&b!==y){v=0;while(m=t[v++])m(w,g,a,l);if(u){if(y>0)while(b--)w[b]||g[b]||(g[b]=D.call(c));g=wt(g)}H.apply(c,g),S&&!u&&g.length>0&&y+t.length>1&&ot.uniqueSort(c)}return S&&(E=N,f=x),w};return r?at(u):u}function Tt(e,t,n){var r=0,i=t.length;for(;i>r;r++)ot(e,t[r],n);return n}function Nt(e,t,n,i){var o,u,f,l,c,h=mt(e);if(!i&&1===h.length){if(u=h[0]=h[0].slice(0),u.length>2&&"ID"===(f=u[0]).type&&r.getById&&9===t.nodeType&&d&&s.relative[u[1].type]){if(t=(s.find.ID(f.matches[0].replace(rt,it),t)||[])[0],!t)return n;e=e.slice(u.shift().value.length)}o=G.needsContext.test(e)?0:u.length;while(o--){if(f=u[o],s.relative[l=f.type])break;if((c=s.find[l])&&(i=c(f.matches[0].replace(rt,it),$.test(u[0].type)&&t.parentNode||t))){if(u.splice(o,1),e=i.length&&gt(u),!e)return H.apply(n,i),n;break}}}return a(e,h)(i,t,!d,n,$.test(e)),n}var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b="sizzle"+ -(new Date),w=e.document,E=0,S=0,T=ut(),N=ut(),C=ut(),k=!1,L=function(e,t){return e===t?(k=!0,0):0},A=typeof t,O=1<<31,M={}.hasOwnProperty,_=[],D=_.pop,P=_.push,H=_.push,B=_.slice,j=_.indexOf||function(e){var t=0,n=this.length;for(;n>t;t++)if(this[t]===e)return t;return-1},F="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",I="[\\x20\\t\\r\\n\\f]",q="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",R=q.replace("w","w#"),U="\\["+I+"*("+q+")"+I+"*(?:([*^$|!~]?=)"+I+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+R+")|)|)"+I+"*\\]",z=":("+q+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+U.replace(3,8)+")*)|.*)\\)|)",W=RegExp("^"+I+"+|((?:^|[^\\\\])(?:\\\\.)*)"+I+"+$","g"),X=RegExp("^"+I+"*,"+I+"*"),V=RegExp("^"+I+"*([>+~]|"+I+")"+I+"*"),$=RegExp(I+"*[+~]"),J=RegExp("="+I+"*([^\\]'\"]*)"+I+"*\\]","g"),K=RegExp(z),Q=RegExp("^"+R+"$"),G={ID:RegExp("^#("+q+")"),CLASS:RegExp("^\\.("+q+")"),TAG:RegExp("^("+q.replace("w","w*")+")"),ATTR:RegExp("^"+U),PSEUDO:RegExp("^"+z),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+I+"*(even|odd|(([+-]|)(\\d*)n|)"+I+"*(?:([+-]|)"+I+"*(\\d+)|))"+I+"*\\)|)","i"),bool:RegExp("^(?:"+F+")$","i"),needsContext:RegExp("^"+I+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+I+"*((?:-\\d)?\\d*)"+I+"*\\)|)(?=[^-]|$)","i")},Y=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,et=/^(?:input|select|textarea|button)$/i,tt=/^h\d$/i,nt=/'|\\/g,rt=RegExp("\\\\([\\da-f]{1,6}"+I+"?|("+I+")|.)","ig"),it=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(55296|r>>10,56320|1023&r)};try{H.apply(_=B.call(w.childNodes),w.childNodes),_[w.childNodes.length].nodeType}catch(st){H={apply:_.length?function(e,t){P.apply(e,B.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}u=ot.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},r=ot.support={},c=ot.setDocument=function(e){var n=e?e.ownerDocument||e:w,i=n.defaultView;return n!==h&&9===n.nodeType&&n.documentElement?(h=n,p=n.documentElement,d=!u(n),i&&i.attachEvent&&i!==i.top&&i.attachEvent("onbeforeunload",function(){c()}),r.attributes=ft(function(e){return e.className="i",!e.getAttribute("className")}),r.getElementsByTagName=ft(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),r.getElementsByClassName=ft(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),r.getById=ft(function(e){return p.appendChild(e).id=b,!n.getElementsByName||!n.getElementsByName(b).length}),r.getById?(s.find.ID=function(e,t){if(typeof t.getElementById!==A&&d){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},s.filter.ID=function(e){var t=e.replace(rt,it);return function(e){return e.getAttribute("id")===t}}):(delete s.find.ID,s.filter.ID=function(e){var t=e.replace(rt,it);return function(e){var n=typeof e.getAttributeNode!==A&&e.getAttributeNode("id");return n&&n.value===t}}),s.find.TAG=r.getElementsByTagName?function(e,n){return typeof n.getElementsByTagName!==A?n.getElementsByTagName(e):t}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if("*"===e){while(n=s[i++])1===n.nodeType&&r.push(n);return r}return s},s.find.CLASS=r.getElementsByClassName&&function(e,n){return typeof n.getElementsByClassName!==A&&d?n.getElementsByClassName(e):t},m=[],v=[],(r.qsa=Y.test(n.querySelectorAll))&&(ft(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||v.push("\\["+I+"*(?:value|"+F+")"),e.querySelectorAll(":checked").length||v.push(":checked")}),ft(function(e){var t=n.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&v.push("[*^$]="+I+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||v.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),v.push(",.*:")})),(r.matchesSelector=Y.test(g=p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&ft(function(e){r.disconnectedMatch=g.call(e,"div"),g.call(e,"[s!='']:x"),m.push("!=",z)}),v=v.length&&RegExp(v.join("|")),m=m.length&&RegExp(m.join("|")),y=Y.test(p.contains)||p.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!!r&&1===r.nodeType&&!!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},L=p.compareDocumentPosition?function(e,t){if(e===t)return k=!0,0;var i=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t);return i?1&i||!r.sortDetached&&t.compareDocumentPosition(e)===i?e===n||y(w,e)?-1:t===n||y(w,t)?1:l?j.call(l,e)-j.call(l,t):0:4&i?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var r,i=0,s=e.parentNode,o=t.parentNode,u=[e],a=[t];if(e===t)return k=!0,0;if(!s||!o)return e===n?-1:t===n?1:s?-1:o?1:l?j.call(l,e)-j.call(l,t):0;if(s===o)return ct(e,t);r=e;while(r=r.parentNode)u.unshift(r);r=t;while(r=r.parentNode)a.unshift(r);while(u[i]===a[i])i++;return i?ct(u[i],a[i]):u[i]===w?-1:a[i]===w?1:0},n):h},ot.matches=function(e,t){return ot(e,null,null,t)},ot.matchesSelector=function(e,t){if((e.ownerDocument||e)!==h&&c(e),t=t.replace(J,"='$1']"),!(!r.matchesSelector||!d||m&&m.test(t)||v&&v.test(t)))try{var n=g.call(e,t);if(n||r.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(i){}return ot(t,h,null,[e]).length>0},ot.contains=function(e,t){return(e.ownerDocument||e)!==h&&c(e),y(e,t)},ot.attr=function(e,n){(e.ownerDocument||e)!==h&&c(e);var i=s.attrHandle[n.toLowerCase()],o=i&&M.call(s.attrHandle,n.toLowerCase())?i(e,n,!d):t;return o===t?r.attributes||!d?e.getAttribute(n):(o=e.getAttributeNode(n))&&o.specified?o.value:null:o},ot.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},ot.uniqueSort=function(e){var t,n=[],i=0,s=0;if(k=!r.detectDuplicates,l=!r.sortStable&&e.slice(0),e.sort(L),k){while(t=e[s++])t===e[s]&&(i=n.push(s));while(i--)e.splice(n[i],1)}return e},o=ot.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=o(t);return n},s=ot.selectors={cacheLength:50,createPseudo:at,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(rt,it),e[3]=(e[4]||e[5]||"").replace(rt,it),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ot.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ot.error(e[0]),e},PSEUDO:function(e){var n,r=!e[5]&&e[2];return G.CHILD.test(e[0])?null:(e[3]&&e[4]!==t?e[2]=e[4]:r&&K.test(r)&&(n=mt(r,!0))&&(n=r.indexOf(")",r.length-n)-r.length)&&(e[0]=e[0].slice(0,n),e[2]=r.slice(0,n)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(rt,it).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=T[e+" "];return t||(t=RegExp("(^|"+I+")"+e+"("+I+"|$)"))&&T(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==A&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=ot.attr(r,e);return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var s="nth"!==e.slice(0,3),o="last"!==e.slice(-4),u="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,a){var f,l,c,h,p,d,v=s!==o?"nextSibling":"previousSibling",m=t.parentNode,g=u&&t.nodeName.toLowerCase(),y=!a&&!u;if(m){if(s){while(v){c=t;while(c=c[v])if(u?c.nodeName.toLowerCase()===g:1===c.nodeType)return!1;d=v="only"===e&&!d&&"nextSibling"}return!0}if(d=[o?m.firstChild:m.lastChild],o&&y){l=m[b]||(m[b]={}),f=l[e]||[],p=f[0]===E&&f[1],h=f[0]===E&&f[2],c=p&&m.childNodes[p];while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if(1===c.nodeType&&++h&&c===t){l[e]=[E,p,h];break}}else if(y&&(f=(t[b]||(t[b]={}))[e])&&f[0]===E)h=f[1];else while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if((u?c.nodeName.toLowerCase()===g:1===c.nodeType)&&++h&&(y&&((c[b]||(c[b]={}))[e]=[E,h]),c===t))break;return h-=i,h===r||0===h%r&&h/r>=0}}},PSEUDO:function(e,t){var n,r=s.pseudos[e]||s.setFilters[e.toLowerCase()]||ot.error("unsupported pseudo: "+e);return r[b]?r(t):r.length>1?(n=[e,e,"",t],s.setFilters.hasOwnProperty(e.toLowerCase())?at(function(e,n){var i,s=r(e,t),o=s.length;while(o--)i=j.call(e,s[o]),e[i]=!(n[i]=s[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:at(function(e){var t=[],n=[],r=a(e.replace(W,"$1"));return r[b]?at(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)(s=o[u])&&(e[u]=!(t[u]=s))}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:at(function(e){return function(t){return ot(e,t).length>0}}),contains:at(function(e){return function(t){return(t.textContent||t.innerText||o(t)).indexOf(e)>-1}}),lang:at(function(e){return Q.test(e||"")||ot.error("unsupported lang: "+e),e=e.replace(rt,it).toLowerCase(),function(t){var n;do if(n=d?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===p},focus:function(e){return e===h.activeElement&&(!h.hasFocus||h.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!s.pseudos.empty(e)},header:function(e){return tt.test(e.nodeName)},input:function(e){return et.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:dt(function(){return[0]}),last:dt(function(e,t){return[t-1]}),eq:dt(function(e,t,n){return[0>n?n+t:n]}),even:dt(function(e,t){var n=0;for(;t>n;n+=2)e.push(n);return e}),odd:dt(function(e,t){var n=1;for(;t>n;n+=2)e.push(n);return e}),lt:dt(function(e,t,n){var r=0>n?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:dt(function(e,t,n){var r=0>n?n+t:n;for(;t>++r;)e.push(r);return e})}},s.pseudos.nth=s.pseudos.eq;for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})s.pseudos[n]=ht(n);for(n in{submit:!0,reset:!0})s.pseudos[n]=pt(n);vt.prototype=s.filters=s.pseudos,s.setFilters=new vt,a=ot.compile=function(e,t){var n,r=[],i=[],s=C[e+" "];if(!s){t||(t=mt(e)),n=t.length;while(n--)s=St(t[n]),s[b]?r.push(s):i.push(s);s=C(e,xt(i,r))}return s},r.sortStable=b.split("").sort(L).join("")===b,r.detectDuplicates=k,c(),r.sortDetached=ft(function(e){return 1&e.compareDocumentPosition(h.createElement("div"))}),ft(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||lt("type|href|height|width",function(e,n,r){return r?t:e.getAttribute(n,"type"===n.toLowerCase()?1:2)}),r.attributes&&ft(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||lt("value",function(e,n,r){return r||"input"!==e.nodeName.toLowerCase()?t:e.defaultValue}),ft(function(e){return null==e.getAttribute("disabled")})||lt(F,function(e,n,r){var i;return r?t:(i=e.getAttributeNode(n))&&i.specified?i.value:e[n]===!0?n.toLowerCase():null}),x.find=ot,x.expr=ot.selectors,x.expr[":"]=x.expr.pseudos,x.unique=ot.uniqueSort,x.text=ot.getText,x.isXMLDoc=ot.isXML,x.contains=ot.contains}(e);var D={};x.Callbacks=function(e){e="string"==typeof e?D[e]||A(e):x.extend({},e);var t,n,r,i,s,o,u=[],a=!e.once&&[],f=function(h){for(t=e.memory&&h,n=!0,o=i||0,i=0,s=u.length,r=!0;u&&s>o;o++)if(u[o].apply(h[0],h[1])===!1&&e.stopOnFalse){t=!1;break}r=!1,u&&(a?a.length&&f(a.shift()):t?u=[]:l.disable())},l={add:function(){if(u){var n=u.length;(function o(t){x.each(t,function(t,n){var r=x.type(n);"function"===r?e.unique&&l.has(n)||u.push(n):n&&n.length&&"string"!==r&&o(n)})})(arguments),r?s=u.length:t&&(i=n,f(t))}return this},remove:function(){return u&&x.each(arguments,function(e,t){var n;while((n=x.inArray(t,u,n))>-1)u.splice(n,1),r&&(s>=n&&s--,o>=n&&o--)}),this},has:function(e){return e?x.inArray(e,u)>-1:!!u&&!!u.length},empty:function(){return u=[],s=0,this},disable:function(){return u=a=t=undefined,this},disabled:function(){return!u},lock:function(){return a=undefined,t||l.disable(),this},locked:function(){return!a},fireWith:function(e,t){return!u||n&&!a||(t=t||[],t=[e,t.slice?t.slice():t],r?a.push(t):f(t)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!n}};return l},x.extend({Deferred:function(e){var t=[["resolve","done",x.Callbacks("once memory"),"resolved"],["reject","fail",x.Callbacks("once memory"),"rejected"],["notify","progress",x.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return x.Deferred(function(n){x.each(t,function(t,s){var o=s[0],u=x.isFunction(e[t])&&e[t];i[s[1]](function(){var e=u&&u.apply(this,arguments);e&&x.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o+"With"](this===r?n.promise():this,u?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?x.extend(e,r):r}},i={};return r.pipe=r.then,x.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[1^e][2].disable,t[2][2].lock),i[s[0]]=function(){return i[s[0]+"With"](this===i?r:this,arguments),this},i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=d.call(arguments),r=n.length,i=1!==r||e&&x.isFunction(e.promise)?r:0,s=1===i?e:x.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?d.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1)for(u=Array(r),a=Array(r),f=Array(r);r>t;t++)n[t]&&x.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i;return i||s.resolveWith(f,n),s.promise()}}),x.support=function(t){var n=o.createElement("input"),r=o.createDocumentFragment(),i=o.createElement("div"),s=o.createElement("select"),u=s.appendChild(o.createElement("option"));return n.type?(n.type="checkbox",t.checkOn=""!==n.value,t.optSelected=u.selected,t.reliableMarginRight=!0,t.boxSizingReliable=!0,t.pixelPosition=!1,n.checked=!0,t.noCloneChecked=n.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!u.disabled,n=o.createElement("input"),n.value="t",n.type="radio",t.radioValue="t"===n.value,n.setAttribute("checked","t"),n.setAttribute("name","t"),r.appendChild(n),t.checkClone=r.cloneNode(!0).cloneNode(!0).lastChild.checked,t.focusinBubbles="onfocusin"in e,i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===i.style.backgroundClip,x(function(){var n,r,s="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",u=o.getElementsByTagName("body")[0];u&&(n=o.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",u.appendChild(n).appendChild(i),i.innerHTML="",i.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",x.swap(u,null!=u.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===i.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(i,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(i,null)||{width:"4px"}).width,r=i.appendChild(o.createElement("div")),r.style.cssText=i.style.cssText=s,r.style.marginRight=r.style.width="0",i.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),u.removeChild(n))}),t):t}({});var L,q,H=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,O=/([A-Z])/g;F.uid=1,F.accepts=function(e){return e.nodeType?1===e.nodeType||9===e.nodeType:!0},F.prototype={key:function(e){if(!F.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=F.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(r){t[this.expando]=n,x.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var r,i=this.key(e),s=this.cache[i];if("string"==typeof t)s[t]=n;else if(x.isEmptyObject(s))x.extend(this.cache[i],t);else for(r in t)s[r]=t[r];return s},get:function(e,t){var n=this.cache[this.key(e)];return t===undefined?n:n[t]},access:function(e,t,n){var r;return t===undefined||t&&"string"==typeof t&&n===undefined?(r=this.get(e,t),r!==undefined?r:this.get(e,x.camelCase(t))):(this.set(e,t,n),n!==undefined?n:t)},remove:function(e,t){var n,r,i,s=this.key(e),o=this.cache[s];if(t===undefined)this.cache[s]={};else{x.isArray(t)?r=t.concat(t.map(x.camelCase)):(i=x.camelCase(t),t in o?r=[t,i]:(r=i,r=r in o?[r]:r.match(w)||[])),n=r.length;while(n--)delete o[r[n]]}},hasData:function(e){return!x.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}},L=new F,q=new F,x.extend({acceptData:F.accepts,hasData:function(e){return L.hasData(e)||q.hasData(e)},data:function(e,t,n){return L.access(e,t,n)},removeData:function(e,t){L.remove(e,t)},_data:function(e,t,n){return q.access(e,t,n)},_removeData:function(e,t){q.remove(e,t)}}),x.fn.extend({data:function(e,t){var n,r,i=this[0],s=0,o=null;if(e===undefined){if(this.length&&(o=L.get(i),1===i.nodeType&&!q.get(i,"hasDataAttrs"))){for(n=i.attributes;n.length>s;s++)r=n[s].name,0===r.indexOf("data-")&&(r=x.camelCase(r.slice(5)),P(i,r,o[r]));q.set(i,"hasDataAttrs",!0)}return o}return"object"==typeof e?this.each(function(){L.set(this,e)}):x.access(this,function(t){var n,r=x.camelCase(e);if(i&&t===undefined){if(n=L.get(i,e),n!==undefined)return n;if(n=L.get(i,r),n!==undefined)return n;if(n=P(i,r,undefined),n!==undefined)return n}else this.each(function(){var n=L.get(this,r);L.set(this,r,t),-1!==e.indexOf("-")&&n!==undefined&&L.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){L.remove(this,e)})}}),x.extend({queue:function(e,t,n){var r;return e?(t=(t||"fx")+"queue",r=q.get(e,t),n&&(!r||x.isArray(n)?r=q.access(e,t,x.makeArray(n)):r.push(n)),r||[]):undefined},dequeue:function(e,t){t=t||"fx";var n=x.queue(e,t),r=n.length,i=n.shift(),s=x._queueHooks(e,t),o=function(){x.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return q.get(e,n)||q.access(e,n,{empty:x.Callbacks("once memory").add(function(){q.remove(e,[t+"queue",n])})})}}),x.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),n>arguments.length?x.queue(this[0],e):t===undefined?this:this.each(function(){var n=x.queue(this,e,t);x._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&x.dequeue(this,e)})},dequeue:function(e){return this.each(function(){x.dequeue(this,e)})},delay:function(e,t){return e=x.fx?x.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=x.Deferred(),s=this,o=this.length,u=function(){--r||i.resolveWith(s,[s])};"string"!=typeof e&&(t=e,e=undefined),e=e||"fx";while(o--)n=q.get(s[o],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(u));return u(),i.promise(t)}});var R,M,W=/[\t\r\n\f]/g,$=/\r/g,B=/^(?:input|select|textarea|button)$/i;x.fn.extend({attr:function(e,t){return x.access(this,x.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){x.removeAttr(this,e)})},prop:function(e,t){return x.access(this,x.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[x.propFix[e]||e]})},addClass:function(e){var t,n,r,i,s,o=0,u=this.length,a="string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).addClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(w)||[];u>o;o++)if(n=this[o],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(W," "):" ")){s=0;while(i=t[s++])0>r.indexOf(" "+i+" ")&&(r+=i+" ");n.className=x.trim(r)}return this},removeClass:function(e){var t,n,r,i,s,o=0,u=this.length,a=0===arguments.length||"string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).removeClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(w)||[];u>o;o++)if(n=this[o],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(W," "):"")){s=0;while(i=t[s++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");n.className=e?x.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):x.isFunction(e)?this.each(function(n){x(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n){var t,i=0,s=x(this),o=e.match(w)||[];while(t=o[i++])s.hasClass(t)?s.removeClass(t):s.addClass(t)}else(n===r||"boolean"===n)&&(this.className&&q.set(this,"__className__",this.className),this.className=this.className||e===!1?"":q.get(this,"__className__")||"")})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(W," ").indexOf(t)>=0)return!0;return!1},val:function(e){var t,n,r,i=this[0];if(arguments.length)return r=x.isFunction(e),this.each(function(n){var i;1===this.nodeType&&(i=r?e.call(this,n,x(this).val()):e,null==i?i="":"number"==typeof i?i+="":x.isArray(i)&&(i=x.map(i,function(e){return null==e?"":e+""})),t=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&t.set(this,i,"value")!==undefined||(this.value=i))});if(i)return t=x.valHooks[i.type]||x.valHooks[i.nodeName.toLowerCase()],t&&"get"in t&&(n=t.get(i,"value"))!==undefined?n:(n=i.value,"string"==typeof n?n.replace($,""):null==n?"":n)}}),x.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s="select-one"===e.type||0>i,o=s?null:[],u=s?i+1:r.length,a=0>i?u:s?i:0;for(;u>a;a++)if(n=r[a],!(!n.selected&&a!==i||(x.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&x.nodeName(n.parentNode,"optgroup"))){if(t=x(n).val(),s)return t;o.push(t)}return o},set:function(e,t){var n,r,i=e.options,s=x.makeArray(t),o=i.length;while(o--)r=i[o],(r.selected=x.inArray(x(r).val(),s)>=0)&&(n=!0);return n||(e.selectedIndex=-1),s}}},attr:function(e,t,n){var i,s,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return typeof e.getAttribute===r?x.prop(e,t,n):(1===o&&x.isXMLDoc(e)||(t=t.toLowerCase(),i=x.attrHooks[t]||(x.expr.match.bool.test(t)?M:R)),n===undefined?i&&"get"in i&&null!==(s=i.get(e,t))?s:(s=x.find.attr(e,t),null==s?undefined:s):null!==n?i&&"set"in i&&(s=i.set(e,n,t))!==undefined?s:(e.setAttribute(t,n+""),n):(x.removeAttr(e,t),undefined))},removeAttr:function(e,t){var n,r,i=0,s=t&&t.match(w);if(s&&1===e.nodeType)while(n=s[i++])r=x.propFix[n]||n,x.expr.match.bool.test(n)&&(e[r]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!x.support.radioValue&&"radio"===t&&x.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var r,i,s,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return s=1!==o||!x.isXMLDoc(e),s&&(t=x.propFix[t]||t,i=x.propHooks[t]),n!==undefined?i&&"set"in i&&(r=i.set(e,n,t))!==undefined?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||B.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),M={set:function(e,t,n){return t===!1?x.removeAttr(e,n):e.setAttribute(n,n),n}},x.each(x.expr.match.bool.source.match(/\w+/g),function(e,t){var n=x.expr.attrHandle[t]||x.find.attr;x.expr.attrHandle[t]=function(e,t,r){var i=x.expr.attrHandle[t],s=r?undefined:(x.expr.attrHandle[t]=undefined)!=n(e,t,r)?t.toLowerCase():null;return x.expr.attrHandle[t]=i,s}}),x.support.optSelected||(x.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),x.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){x.propFix[this.toLowerCase()]=this}),x.each(["radio","checkbox"],function(){x.valHooks[this]={set:function(e,t){return x.isArray(t)?e.checked=x.inArray(x(e).val(),t)>=0:undefined}},x.support.checkOn||(x.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var I=/^key/,z=/^(?:mouse|contextmenu)|click/,_=/^(?:focusinfocus|focusoutblur)$/,X=/^([^.]*)(?:\.(.+)|)$/;x.event={global:{},add:function(e,t,n,i,s){var o,u,a,f,l,c,h,p,d,v,m,g=q.get(e);if(g){n.handler&&(o=n,n=o.handler,s=o.selector),n.guid||(n.guid=x.guid++),(f=g.events)||(f=g.events={}),(u=g.handle)||(u=g.handle=function(e){return typeof x===r||e&&x.event.triggered===e.type?undefined:x.event.dispatch.apply(u.elem,arguments)},u.elem=e),t=(t||"").match(w)||[""],l=t.length;while(l--)a=X.exec(t[l])||[],d=m=a[1],v=(a[2]||"").split(".").sort(),d&&(h=x.event.special[d]||{},d=(s?h.delegateType:h.bindType)||d,h=x.event.special[d]||{},c=x.extend({type:d,origType:m,data:i,handler:n,guid:n.guid,selector:s,needsContext:s&&x.expr.match.needsContext.test(s),namespace:v.join(".")},o),(p=f[d])||(p=f[d]=[],p.delegateCount=0,h.setup&&h.setup.call(e,i,v,u)!==!1||e.addEventListener&&e.addEventListener(d,u,!1)),h.add&&(h.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),s?p.splice(p.delegateCount++,0,c):p.push(c),x.event.global[d]=!0);e=null}},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=q.hasData(e)&&q.get(e);if(m&&(a=m.events)){t=(t||"").match(w)||[""],f=t.length;while(f--)if(u=X.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort(),p){c=x.event.special[p]||{},p=(r?c.delegateType:c.bindType)||p,h=a[p]||[],u=u[2]&&RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=s=h.length;while(s--)l=h[s],!i&&v!==l.origType||n&&n.guid!==l.guid||u&&!u.test(l.namespace)||r&&r!==l.selector&&("**"!==r||!l.selector)||(h.splice(s,1),l.selector&&h.delegateCount--,c.remove&&c.remove.call(e,l));o&&!h.length&&(c.teardown&&c.teardown.call(e,d,m.handle)!==!1||x.removeEvent(e,p,m.handle),delete a[p])}else for(p in a)x.event.remove(e,p+t[f],n,r,!0);x.isEmptyObject(a)&&(delete m.handle,q.remove(e,"events"))}},trigger:function(t,n,r,i){var s,u,a,f,l,c,h,p=[r||o],d=y.call(t,"type")?t.type:t,v=y.call(t,"namespace")?t.namespace.split("."):[];if(u=a=r=r||o,3!==r.nodeType&&8!==r.nodeType&&!_.test(d+x.event.triggered)&&(d.indexOf(".")>=0&&(v=d.split("."),d=v.shift(),v.sort()),l=0>d.indexOf(":")&&"on"+d,t=t[x.expando]?t:new x.Event(d,"object"==typeof t&&t),t.isTrigger=i?2:3,t.namespace=v.join("."),t.namespace_re=t.namespace?RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=undefined,t.target||(t.target=r),n=null==n?[t]:x.makeArray(n,[t]),h=x.event.special[d]||{},i||!h.trigger||h.trigger.apply(r,n)!==!1)){if(!i&&!h.noBubble&&!x.isWindow(r)){for(f=h.delegateType||d,_.test(f+d)||(u=u.parentNode);u;u=u.parentNode)p.push(u),a=u;a===(r.ownerDocument||o)&&p.push(a.defaultView||a.parentWindow||e)}s=0;while((u=p[s++])&&!t.isPropagationStopped())t.type=s>1?f:h.bindType||d,c=(q.get(u,"events")||{})[t.type]&&q.get(u,"handle"),c&&c.apply(u,n),c=l&&u[l],c&&x.acceptData(u)&&c.apply&&c.apply(u,n)===!1&&t.preventDefault();return t.type=d,i||t.isDefaultPrevented()||h._default&&h._default.apply(p.pop(),n)!==!1||!x.acceptData(r)||l&&x.isFunction(r[d])&&!x.isWindow(r)&&(a=r[l],a&&(r[l]=null),x.event.triggered=d,r[d](),x.event.triggered=undefined,a&&(r[l]=a)),t.result}},dispatch:function(e){e=x.event.fix(e);var t,n,r,i,s,o=[],u=d.call(arguments),a=(q.get(this,"events")||{})[e.type]||[],f=x.event.special[e.type]||{};if(u[0]=e,e.delegateTarget=this,!f.preDispatch||f.preDispatch.call(this,e)!==!1){o=x.event.handlers.call(this,e,a),t=0;while((i=o[t++])&&!e.isPropagationStopped()){e.currentTarget=i.elem,n=0;while((s=i.handlers[n++])&&!e.isImmediatePropagationStopped())(!e.namespace_re||e.namespace_re.test(s.namespace))&&(e.handleObj=s,e.data=s.data,r=((x.event.special[s.origType]||{}).handle||s.handler).apply(i.elem,u),r!==undefined&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()))}return f.postDispatch&&f.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,r,i,s,o=[],u=t.delegateCount,a=e.target;if(u&&a.nodeType&&(!e.button||"click"!==e.type))for(;a!==this;a=a.parentNode||this)if(a.disabled!==!0||"click"!==e.type){for(r=[],n=0;u>n;n++)s=t[n],i=s.selector+" ",r[i]===undefined&&(r[i]=s.needsContext?x(i,this).index(a)>=0:x.find(i,this,null,[a]).length),r[i]&&r.push(s);r.length&&o.push({elem:a,handlers:r})}return t.length>u&&o.push({elem:this,handlers:t.slice(u)}),o},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,s=t.button;return null==e.pageX&&null!=t.clientX&&(n=e.target.ownerDocument||o,r=n.documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),e.which||s===undefined||(e.which=1&s?1:2&s?3:4&s?2:0),e}},fix:function(e){if(e[x.expando])return e;var t,n,r,i=e.type,s=e,u=this.fixHooks[i];u||(this.fixHooks[i]=u=z.test(i)?this.mouseHooks:I.test(i)?this.keyHooks:{}),r=u.props?this.props.concat(u.props):this.props,e=new x.Event(s),t=r.length;while(t--)n=r[t],e[n]=s[n];return e.target||(e.target=o),3===e.target.nodeType&&(e.target=e.target.parentNode),u.filter?u.filter(e,s):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==V()&&this.focus?(this.focus(),!1):undefined},delegateType:"focusin"},blur:{trigger:function(){return this===V()&&this.blur?(this.blur(),!1):undefined},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&x.nodeName(this,"input")?(this.click(),!1):undefined},_default:function(e){return x.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==undefined&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=x.extend(new x.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?x.event.trigger(i,null,t):x.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},x.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},x.Event=function(e,t){return this instanceof x.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.getPreventDefault&&e.getPreventDefault()?U:Y):this.type=e,t&&x.extend(this,t),this.timeStamp=e&&e.timeStamp||x.now(),this[x.expando]=!0,undefined):new x.Event(e,t)},x.Event.prototype={isDefaultPrevented:Y,isPropagationStopped:Y,isImmediatePropagationStopped:Y,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=U,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=U,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=U,this.stopPropagation()}},x.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){x.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj;return(!i||i!==r&&!x.contains(r,i))&&(e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t),n}}}),x.support.focusinBubbles||x.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){x.event.simulate(t,e.target,x.event.fix(e),!0)};x.event.special[t]={setup:function(){0===n++&&o.addEventListener(e,r,!0)},teardown:function(){0===--n&&o.removeEventListener(e,r,!0)}}}),x.fn.extend({on:function(e,t,n,r,i){var s,o;if("object"==typeof e){"string"!=typeof t&&(n=n||t,t=undefined);for(o in e)this.on(o,t,n,e[o],i);return this}if(null==n&&null==r?(r=t,n=t=undefined):null==r&&("string"==typeof t?(r=n,n=undefined):(r=n,n=t,t=undefined)),r===!1)r=Y;else if(!r)return this;return 1===i&&(s=r,r=function(e){return x().off(e),s.apply(this,arguments)},r.guid=s.guid||(s.guid=x.guid++)),this.each(function(){x.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,x(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return(t===!1||"function"==typeof t)&&(n=t,t=undefined),n===!1&&(n=Y),this.each(function(){x.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){x.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?x.event.trigger(e,t,n,!0):undefined}});var G=/^.[^:#\[\.,]*$/,J=/^(?:parents|prev(?:Until|All))/,Q=x.expr.match.needsContext,K={children:!0,contents:!0,next:!0,prev:!0};x.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if("string"!=typeof e)return this.pushStack(x(e).filter(function(){for(t=0;i>t;t++)if(x.contains(r[t],this))return!0}));for(t=0;i>t;t++)x.find(e,r[t],n);return n=this.pushStack(i>1?x.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t=x(e,this),n=t.length;return this.filter(function(){var e=0;for(;n>e;e++)if(x.contains(this,t[e]))return!0})},not:function(e){return this.pushStack(et(this,e||[],!0))},filter:function(e){return this.pushStack(et(this,e||[],!1))},is:function(e){return!!et(this,"string"==typeof e&&Q.test(e)?x(e):e||[],!1).length},closest:function(e,t){var n,r=0,i=this.length,s=[],o=Q.test(e)||"string"!=typeof e?x(e,t||this.context):0;for(;i>r;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(11>n.nodeType&&(o?o.index(n)>-1:1===n.nodeType&&x.find.matchesSelector(n,e))){n=s.push(n);break}return this.pushStack(s.length>1?x.unique(s):s)},index:function(e){return e?"string"==typeof e?g.call(x(e),this[0]):g.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?x(e,t):x.makeArray(e&&e.nodeType?[e]:e),r=x.merge(this.get(),n);return this.pushStack(x.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),x.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return x.dir(e,"parentNode")},parentsUntil:function(e,t,n){return x.dir(e,"parentNode",n)},next:function(e){return Z(e,"nextSibling")},prev:function(e){return Z(e,"previousSibling")},nextAll:function(e){return x.dir(e,"nextSibling")},prevAll:function(e){return x.dir(e,"previousSibling")},nextUntil:function(e,t,n){return x.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return x.dir(e,"previousSibling",n)},siblings:function(e){return x.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return x.sibling(e.firstChild)},contents:function(e){return e.contentDocument||x.merge([],e.childNodes)}},function(e,t){x.fn[e]=function(n,r){var i=x.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=x.filter(r,i)),this.length>1&&(K[e]||x.unique(i),J.test(e)&&i.reverse()),this.pushStack(i)}}),x.extend({filter:function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?x.find.matchesSelector(r,e)?[r]:[]:x.find.matches(e,x.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,t,n){var r=[],i=n!==undefined;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&x(e).is(n))break;r.push(e)}return r},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var tt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,nt=/<([\w:]+)/,rt=/<|&#?\w+;/,it=/<(?:script|style|link)/i,ot=/^(?:checkbox|radio)$/i,st=/checked\s*(?:[^=]|=\s*.checked.)/i,at=/^$|\/(?:java|ecma)script/i,ut=/^true\/(.*)/,lt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ct={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ct.optgroup=ct.option,ct.tbody=ct.tfoot=ct.colgroup=ct.caption=ct.thead,ct.th=ct.td,x.fn.extend({text:function(e){return x.access(this,function(e){return e===undefined?x.text(this):this.empty().append((this[0]&&this[0].ownerDocument||o).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=pt(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=pt(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=e?x.filter(e,this):this,i=0;for(;null!=(n=r[i]);i++)t||1!==n.nodeType||x.cleanData(mt(n)),n.parentNode&&(t&&x.contains(n.ownerDocument,n)&&dt(mt(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){var e,t=0;for(;null!=(e=this[t]);t++)1===e.nodeType&&(x.cleanData(mt(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return x.clone(this,e,t)})},html:function(e){return x.access(this,function(e){var t=this[0]||{},n=0,r=this.length;if(e===undefined&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!it.test(e)&&!ct[(nt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(tt,"<$1></$2>");try{for(;r>n;n++)t=this[n]||{},1===t.nodeType&&(x.cleanData(mt(t,!1)),t.innerHTML=e);t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=x.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var r=e[t++],i=e[t++];i&&(r&&r.parentNode!==i&&(r=this.nextSibling),x(this).remove(),i.insertBefore(n,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=f.apply([],e);var r,i,s,o,u,a,l=0,c=this.length,h=this,p=c-1,d=e[0],v=x.isFunction(d);if(v||!(1>=c||"string"!=typeof d||x.support.checkClone)&&st.test(d))return this.each(function(r){var i=h.eq(r);v&&(e[0]=d.call(this,r,i.html())),i.domManip(e,t,n)});if(c&&(r=x.buildFragment(e,this[0].ownerDocument,!1,!n&&this),i=r.firstChild,1===r.childNodes.length&&(r=i),i)){for(s=x.map(mt(r,"script"),ft),o=s.length;c>l;l++)u=r,l!==p&&(u=x.clone(u,!0,!0),o&&x.merge(s,mt(u,"script"))),t.call(this[l],u,l);if(o)for(a=s[s.length-1].ownerDocument,x.map(s,ht),l=0;o>l;l++)u=s[l],at.test(u.type||"")&&!q.access(u,"globalEval")&&x.contains(a,u)&&(u.src?x._evalUrl(u.src):x.globalEval(u.textContent.replace(lt,"")))}return this}}),x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){x.fn[e]=function(e){var n,r=[],i=x(e),s=i.length-1,o=0;for(;s>=o;o++)n=o===s?this:this.clone(!0),x(i[o])[t](n),h.apply(r,n.get());return this.pushStack(r)}}),x.extend({clone:function(e,t,n){var r,i,s,o,u=e.cloneNode(!0),a=x.contains(e.ownerDocument,e);if(!(x.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||x.isXMLDoc(e)))for(o=mt(u),s=mt(e),r=0,i=s.length;i>r;r++)yt(s[r],o[r]);if(t)if(n)for(s=s||mt(e),o=o||mt(u),r=0,i=s.length;i>r;r++)gt(s[r],o[r]);else gt(e,u);return o=mt(u,"script"),o.length>0&&dt(o,!a&&mt(e,"script")),u},buildFragment:function(e,t,n,r){var i,s,o,u,a,f,l=0,c=e.length,h=t.createDocumentFragment(),p=[];for(;c>l;l++)if(i=e[l],i||0===i)if("object"===x.type(i))x.merge(p,i.nodeType?[i]:i);else if(rt.test(i)){s=s||h.appendChild(t.createElement("div")),o=(nt.exec(i)||["",""])[1].toLowerCase(),u=ct[o]||ct._default,s.innerHTML=u[1]+i.replace(tt,"<$1></$2>")+u[2],f=u[0];while(f--)s=s.lastChild;x.merge(p,s.childNodes),s=h.firstChild,s.textContent=""}else p.push(t.createTextNode(i));h.textContent="",l=0;while(i=p[l++])if((!r||-1===x.inArray(i,r))&&(a=x.contains(i.ownerDocument,i),s=mt(h.appendChild(i),"script"),a&&dt(s),n)){f=0;while(i=s[f++])at.test(i.type||"")&&n.push(i)}return h},cleanData:function(e){var t,n,r,i,s,o,u=x.event.special,a=0;for(;(n=e[a])!==undefined;a++){if(F.accepts(n)&&(s=n[q.expando],s&&(t=q.cache[s]))){if(r=Object.keys(t.events||{}),r.length)for(o=0;(i=r[o])!==undefined;o++)u[i]?x.event.remove(n,i):x.removeEvent(n,i,t.handle);q.cache[s]&&delete q.cache[s]}delete L.cache[n[L.expando]]}},_evalUrl:function(e){return x.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),x.fn.extend({wrapAll:function(e){var t;return x.isFunction(e)?this.each(function(t){x(this).wrapAll(e.call(this,t))}):(this[0]&&(t=x(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return x.isFunction(e)?this.each(function(t){x(this).wrapInner(e.call(this,t))}):this.each(function(){var t=x(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=x.isFunction(e);return this.each(function(n){x(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){x.nodeName(this,"body")||x(this).replaceWith(this.childNodes)}).end()}});var vt,xt,bt=/^(none|table(?!-c[ea]).+)/,wt=/^margin/,Tt=RegExp("^("+b+")(.*)$","i"),Ct=RegExp("^("+b+")(?!px)[a-z%]+$","i"),kt=RegExp("^([+-])=("+b+")","i"),Nt={BODY:"block"},Et={position:"absolute",visibility:"hidden",display:"block"},St={letterSpacing:0,fontWeight:400},jt=["Top","Right","Bottom","Left"],Dt=["Webkit","O","Moz","ms"];x.fn.extend({css:function(e,t){return x.access(this,function(e,t,n){var r,i,s={},o=0;if(x.isArray(t)){for(r=qt(e),i=t.length;i>o;o++)s[t[o]]=x.css(e,t[o],!1,r);return s}return n!==undefined?x.style(e,t,n):x.css(e,t)},e,t,arguments.length>1)},show:function(){return Ht(this,!0)},hide:function(){return Ht(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Lt(this)?x(this).show():x(this).hide()})}}),x.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=vt(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,s,o,u=x.camelCase(t),a=e.style;return t=x.cssProps[u]||(x.cssProps[u]=At(a,u)),o=x.cssHooks[t]||x.cssHooks[u],n===undefined?o&&"get"in o&&(i=o.get(e,!1,r))!==undefined?i:a[t]:(s=typeof n,"string"===s&&(i=kt.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(x.css(e,t)),s="number"),null==n||"number"===s&&isNaN(n)||("number"!==s||x.cssNumber[u]||(n+="px"),x.support.clearCloneStyle||""!==n||0!==t.indexOf("background")||(a[t]="inherit"),o&&"set"in o&&(n=o.set(e,n,r))===undefined||(a[t]=n)),undefined)}},css:function(e,t,n,r){var i,s,o,u=x.camelCase(t);return t=x.cssProps[u]||(x.cssProps[u]=At(e.style,u)),o=x.cssHooks[t]||x.cssHooks[u],o&&"get"in o&&(i=o.get(e,!0,n)),i===undefined&&(i=vt(e,t,r)),"normal"===i&&t in St&&(i=St[t]),""===n||n?(s=parseFloat(i),n===!0||x.isNumeric(s)?s||0:i):i}}),vt=function(e,t,n){var r,i,s,o=n||qt(e),u=o?o.getPropertyValue(t)||o[t]:undefined,a=e.style;return o&&(""!==u||x.contains(e.ownerDocument,e)||(u=x.style(e,t)),Ct.test(u)&&wt.test(t)&&(r=a.width,i=a.minWidth,s=a.maxWidth,a.minWidth=a.maxWidth=a.width=u,u=o.width,a.width=r,a.minWidth=i,a.maxWidth=s)),u},x.each(["height","width"],function(e,t){x.cssHooks[t]={get:function(e,n,r){return n?0===e.offsetWidth&&bt.test(x.css(e,"display"))?x.swap(e,Et,function(){return Pt(e,t,r)}):Pt(e,t,r):undefined},set:function(e,n,r){var i=r&&qt(e);return Ot(e,n,r?Ft(e,t,r,x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,i),i):0)}}}),x(function(){x.support.reliableMarginRight||(x.cssHooks.marginRight={get:function(e,t){return t?x.swap(e,{display:"inline-block"},vt,[e,"marginRight"]):undefined}}),!x.support.pixelPosition&&x.fn.position&&x.each(["top","left"],function(e,t){x.cssHooks[t]={get:function(e,n){return n?(n=vt(e,t),Ct.test(n)?x(e).position()[t]+"px":n):undefined}}})}),x.expr&&x.expr.filters&&(x.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight},x.expr.filters.visible=function(e){return!x.expr.filters.hidden(e)}),x.each({margin:"",padding:"",border:"Width"},function(e,t){x.cssHooks[e+t]={expand:function(n){var r=0,i={},s="string"==typeof n?n.split(" "):[n];for(;4>r;r++)i[e+jt[r]+t]=s[r]||s[r-2]||s[0];return i}},wt.test(e)||(x.cssHooks[e+t].set=Ot)});var Wt=/%20/g,$t=/\[\]$/,Bt=/\r?\n/g,It=/^(?:submit|button|image|reset|file)$/i,zt=/^(?:input|select|textarea|keygen)/i;x.fn.extend({serialize:function(){return x.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=x.prop(this,"elements");return e?x.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!x(this).is(":disabled")&&zt.test(this.nodeName)&&!It.test(e)&&(this.checked||!ot.test(e))}).map(function(e,t){var n=x(this).val();return null==n?null:x.isArray(n)?x.map(n,function(e){return{name:t.name,value:e.replace(Bt,"\r\n")}}):{name:t.name,value:n.replace(Bt,"\r\n")}}).get()}}),x.param=function(e,t){var n,r=[],i=function(e,t){t=x.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(t===undefined&&(t=x.ajaxSettings&&x.ajaxSettings.traditional),x.isArray(e)||e.jquery&&!x.isPlainObject(e))x.each(e,function(){i(this.name,this.value)});else for(n in e)_t(n,e[n],t,i);return r.join("&").replace(Wt,"+")},x.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){x.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),x.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var Xt,Ut,Yt=x.now(),Vt=/\?/,Gt=/#.*$/,Jt=/([?&])_=[^&]*/,Qt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Kt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Zt=/^(?:GET|HEAD)$/,en=/^\/\//,tn=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,nn=x.fn.load,rn={},on={},sn="*/".concat("*");try{Ut=i.href}catch(an){Ut=o.createElement("a"),Ut.href="",Ut=Ut.href}Xt=tn.exec(Ut.toLowerCase())||[],x.fn.load=function(e,t,n){if("string"!=typeof e&&nn)return nn.apply(this,arguments);var r,i,s,o=this,u=e.indexOf(" ");return u>=0&&(r=e.slice(u),e=e.slice(0,u)),x.isFunction(t)?(n=t,t=undefined):t&&"object"==typeof t&&(i="POST"),o.length>0&&x.ajax({url:e,type:i,dataType:"html",data:t}).done(function(e){s=arguments,o.html(r?x("<div>").append(x.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){o.each(n,s||[e.responseText,t,e])}),this},x.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){x.fn[t]=function(e){return this.on(t,e)}}),x.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ut,type:"GET",isLocal:Kt.test(Xt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":sn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":x.parseJSON,"text xml":x.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?cn(cn(e,x.ajaxSettings),t):cn(x.ajaxSettings,e)},ajaxPrefilter:un(rn),ajaxTransport:un(on),ajax:function(e,t){function T(e,t,s,u){var f,m,g,b,w,S=t;2!==y&&(y=2,o&&clearTimeout(o),n=undefined,i=u||"",E.readyState=e>0?4:0,f=e>=200&&300>e||304===e,s&&(b=pn(l,E,s)),b=fn(l,b,E,f),f?(l.ifModified&&(w=E.getResponseHeader("Last-Modified"),w&&(x.lastModified[r]=w),w=E.getResponseHeader("etag"),w&&(x.etag[r]=w)),204===e||"HEAD"===l.type?S="nocontent":304===e?S="notmodified":(S=b.state,m=b.data,g=b.error,f=!g)):(g=S,(e||!S)&&(S="error",0>e&&(e=0))),E.status=e,E.statusText=(t||S)+"",f?p.resolveWith(c,[m,S,E]):p.rejectWith(c,[E,S,g]),E.statusCode(v),v=undefined,a&&h.trigger(f?"ajaxSuccess":"ajaxError",[E,l,f?m:g]),d.fireWith(c,[E,S]),a&&(h.trigger("ajaxComplete",[E,l]),--x.active||x.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=undefined),t=t||{};var n,r,i,s,o,u,a,f,l=x.ajaxSetup({},t),c=l.context||l,h=l.context&&(c.nodeType||c.jquery)?x(c):x.event,p=x.Deferred(),d=x.Callbacks("once memory"),v=l.statusCode||{},m={},g={},y=0,b="canceled",E={readyState:0,getResponseHeader:function(e){var t;if(2===y){if(!s){s={};while(t=Qt.exec(i))s[t[1].toLowerCase()]=t[2]}t=s[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===y?i:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return y||(e=g[n]=g[n]||e,m[e]=t),this},overrideMimeType:function(e){return y||(l.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>y)for(t in e)v[t]=[v[t],e[t]];else E.always(e[E.status]);return this},abort:function(e){var t=e||b;return n&&n.abort(t),T(0,t),this}};if(p.promise(E).complete=d.add,E.success=E.done,E.error=E.fail,l.url=((e||l.url||Ut)+"").replace(Gt,"").replace(en,Xt[1]+"//"),l.type=t.method||t.type||l.method||l.type,l.dataTypes=x.trim(l.dataType||"*").toLowerCase().match(w)||[""],null==l.crossDomain&&(u=tn.exec(l.url.toLowerCase()),l.crossDomain=!(!u||u[1]===Xt[1]&&u[2]===Xt[2]&&(u[3]||("http:"===u[1]?"80":"443"))===(Xt[3]||("http:"===Xt[1]?"80":"443")))),l.data&&l.processData&&"string"!=typeof l.data&&(l.data=x.param(l.data,l.traditional)),ln(rn,l,t,E),2===y)return E;a=l.global,a&&0===x.active++&&x.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!Zt.test(l.type),r=l.url,l.hasContent||(l.data&&(r=l.url+=(Vt.test(r)?"&":"?")+l.data,delete l.data),l.cache===!1&&(l.url=Jt.test(r)?r.replace(Jt,"$1_="+Yt++):r+(Vt.test(r)?"&":"?")+"_="+Yt++)),l.ifModified&&(x.lastModified[r]&&E.setRequestHeader("If-Modified-Since",x.lastModified[r]),x.etag[r]&&E.setRequestHeader("If-None-Match",x.etag[r])),(l.data&&l.hasContent&&l.contentType!==!1||t.contentType)&&E.setRequestHeader("Content-Type",l.contentType),E.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+("*"!==l.dataTypes[0]?", "+sn+"; q=0.01":""):l.accepts["*"]);for(f in l.headers)E.setRequestHeader(f,l.headers[f]);if(!l.beforeSend||l.beforeSend.call(c,E,l)!==!1&&2!==y){b="abort";for(f in{success:1,error:1,complete:1})E[f](l[f]);if(n=ln(on,l,t,E)){E.readyState=1,a&&h.trigger("ajaxSend",[E,l]),l.async&&l.timeout>0&&(o=setTimeout(function(){E.abort("timeout")},l.timeout));try{y=1,n.send(m,T)}catch(S){if(!(2>y))throw S;T(-1,S)}}else T(-1,"No Transport");return E}return E.abort()},getJSON:function(e,t,n){return x.get(e,t,n,"json")},getScript:function(e,t){return x.get(e,undefined,t,"script")}}),x.each(["get","post"],function(e,t){x[t]=function(e,n,r,i){return x.isFunction(n)&&(i=i||r,r=n,n=undefined),x.ajax({url:e,type:t,dataType:i,data:n,success:r})}}),x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return x.globalEval(e),e}}}),x.ajaxPrefilter("script",function(e){e.cache===undefined&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),x.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(r,i){t=x("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),o.head.appendChild(t[0])},abort:function(){n&&n()}}}});var hn=[],dn=/(=)\?(?=&|$)|\?\?/;x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=hn.pop()||x.expando+"_"+Yt++;return this[e]=!0,e}}),x.ajaxPrefilter("json jsonp",function(t,n,r){var i,s,o,u=t.jsonp!==!1&&(dn.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&dn.test(t.data)&&"data");return u||"jsonp"===t.dataTypes[0]?(i=t.jsonpCallback=x.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,u?t[u]=t[u].replace(dn,"$1"+i):t.jsonp!==!1&&(t.url+=(Vt.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return o||x.error(i+" was not called"),o[0]},t.dataTypes[0]="json",s=e[i],e[i]=function(){o=arguments},r.always(function(){e[i]=s,t[i]&&(t.jsonpCallback=n.jsonpCallback,hn.push(i)),o&&x.isFunction(s)&&s(o[0]),o=s=undefined}),"script"):undefined}),x.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var gn=x.ajaxSettings.xhr(),mn={0:200,1223:204},yn=0,vn={};e.ActiveXObject&&x(e).on("unload",function(){for(var e in vn)vn[e]();vn=undefined}),x.support.cors=!!gn&&"withCredentials"in gn,x.support.ajax=gn=!!gn,x.ajaxTransport(function(e){var t;return x.support.cors||gn&&!e.crossDomain?{send:function(n,r){var i,s,o=e.xhr();if(o.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(i in e.xhrFields)o[i]=e.xhrFields[i];e.mimeType&&o.overrideMimeType&&o.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(i in n)o.setRequestHeader(i,n[i]);t=function(e){return function(){t&&(delete vn[s],t=o.onload=o.onerror=null,"abort"===e?o.abort():"error"===e?r(o.status||404,o.statusText):r(mn[o.status]||o.status,o.statusText,"string"==typeof o.responseText?{text:o.responseText}:undefined,o.getAllResponseHeaders()))}},o.onload=t(),o.onerror=t("error"),t=vn[s=yn++]=t("abort"),o.send(e.hasContent&&e.data||null)},abort:function(){t&&t()}}:undefined});var xn,bn,wn=/^(?:toggle|show|hide)$/,Tn=RegExp("^(?:([+-])=|)("+b+")([a-z%]*)$","i"),Cn=/queueHooks$/,kn=[An],Nn={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=Tn.exec(t),s=i&&i[3]||(x.cssNumber[e]?"":"px"),o=(x.cssNumber[e]||"px"!==s&&+r)&&Tn.exec(x.css(n.elem,e)),u=1,a=20;if(o&&o[3]!==s){s=s||o[3],i=i||[],o=+r||1;do u=u||".5",o/=u,x.style(n.elem,e,o+s);while(u!==(u=n.cur()/r)&&1!==u&&--a)}return i&&(o=n.start=+o||+r||0,n.unit=s,n.end=i[1]?o+(i[1]+1)*i[2]:+i[2]),n}]};x.Animation=x.extend(jn,{tweener:function(e,t){x.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;i>r;r++)n=e[r],Nn[n]=Nn[n]||[],Nn[n].unshift(t)},prefilter:function(e,t){t?kn.unshift(e):kn.push(e)}}),x.Tween=Ln,Ln.prototype={constructor:Ln,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(x.cssNumber[n]?"":"px")},cur:function(){var e=Ln.propHooks[this.prop];return e&&e.get?e.get(this):Ln.propHooks._default.get(this)},run:function(e){var t,n=Ln.propHooks[this.prop];return this.pos=t=this.options.duration?x.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Ln.propHooks._default.set(this),this}},Ln.prototype.init.prototype=Ln.prototype,Ln.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=x.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){x.fx.step[e.prop]?x.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[x.cssProps[e.prop]]||x.cssHooks[e.prop])?x.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Ln.propHooks.scrollTop=Ln.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},x.each(["toggle","show","hide"],function(e,t){var n=x.fn[t];x.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(qn(t,!0),e,r,i)}}),x.fn.extend({fadeTo:function(e,t,n,r){return this.filter(Lt).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=x.isEmptyObject(e),s=x.speed(t,n,r),o=function(){var t=jn(this,x.extend({},e),s);(i||q.get(this,"finish"))&&t.stop(!0)};return o.finish=o,i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=undefined),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",s=x.timers,o=q.get(this);if(i)o[i]&&o[i].stop&&r(o[i]);else for(i in o)o[i]&&o[i].stop&&Cn.test(i)&&r(o[i]);for(i=s.length;i--;)s[i].elem!==this||null!=e&&s[i].queue!==e||(s[i].anim.stop(n),t=!1,s.splice(i,1));(t||!n)&&x.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=q.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],s=x.timers,o=r?r.length:0;for(n.finish=!0,x.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;o>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),x.each({slideDown:qn("show"),slideUp:qn("hide"),slideToggle:qn("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){x.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),x.speed=function(e,t,n){var r=e&&"object"==typeof e?x.extend({},e):{complete:n||!n&&t||x.isFunction(e)&&e,duration:e,easing:n&&t||t&&!x.isFunction(t)&&t};return r.duration=x.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in x.fx.speeds?x.fx.speeds[r.duration]:x.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){x.isFunction(r.old)&&r.old.call(this),r.queue&&x.dequeue(this,r.queue)},r},x.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},x.timers=[],x.fx=Ln.prototype.init,x.fx.tick=function(){var e,t=x.timers,n=0;for(xn=x.now();t.length>n;n++)e=t[n],e()||t[n]!==e||t.splice(n--,1);t.length||x.fx.stop(),xn=undefined},x.fx.timer=function(e){e()&&x.timers.push(e)&&x.fx.start()},x.fx.interval=13,x.fx.start=function(){bn||(bn=setInterval(x.fx.tick,x.fx.interval))},x.fx.stop=function(){clearInterval(bn),bn=null},x.fx.speeds={slow:600,fast:200,_default:400},x.fx.step={},x.expr&&x.expr.filters&&(x.expr.filters.animated=function(e){return x.grep(x.timers,function(t){return e===t.elem}).length}),x.fn.offset=function(e){if(arguments.length)return e===undefined?this:this.each(function(t){x.offset.setOffset(this,e,t)});var t,n,i=this[0],s={top:0,left:0},o=i&&i.ownerDocument;if(o)return t=o.documentElement,x.contains(t,i)?(typeof i.getBoundingClientRect!==r&&(s=i.getBoundingClientRect()),n=Hn(o),{top:s.top+n.pageYOffset-t.clientTop,left:s.left+n.pageXOffset-t.clientLeft}):s},x.offset={setOffset:function(e,t,n){var r,i,s,o,u,a,f,l=x.css(e,"position"),c=x(e),h={};"static"===l&&(e.style.position="relative"),u=c.offset(),s=x.css(e,"top"),a=x.css(e,"left"),f=("absolute"===l||"fixed"===l)&&(s+a).indexOf("auto")>-1,f?(r=c.position(),o=r.top,i=r.left):(o=parseFloat(s)||0,i=parseFloat(a)||0),x.isFunction(t)&&(t=t.call(e,n,u)),null!=t.top&&(h.top=t.top-u.top+o),null!=t.left&&(h.left=t.left-u.left+i),"using"in t?t.using.call(e,h):c.css(h)}},x.fn.extend({position:function(){if(this[0]){var e,t,n=this[0],r={top:0,left:0};return"fixed"===x.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),x.nodeName(e[0],"html")||(r=e.offset()),r.top+=x.css(e[0],"borderTopWidth",!0),r.left+=x.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-x.css(n,"marginTop",!0),left:t.left-r.left-x.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||s;while(e&&!x.nodeName(e,"html")&&"static"===x.css(e,"position"))e=e.offsetParent;return e||s})}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,n){var r="pageYOffset"===n;x.fn[t]=function(i){return x.access(this,function(t,i,s){var o=Hn(t);return s===undefined?o?o[n]:t[i]:(o?o.scrollTo(r?e.pageXOffset:s,r?s:e.pageYOffset):t[i]=s,undefined)},t,i,arguments.length,null)}}),x.each({Height:"height",Width:"width"},function(e,t){x.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){x.fn[r]=function(r,i){var s=arguments.length&&(n||"boolean"!=typeof r),o=n||(r===!0||i===!0?"margin":"border");return x.access(this,function(t,n,r){var i;return x.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):r===undefined?x.css(t,n,o):x.style(t,n,r,o)},t,s?r:undefined,s,null)}})}),x.fn.size=function(){return this.length},x.fn.andSelf=x.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=x:"function"==typeof define&&define.amd&&define("jquery",[],function(){return x}),"object"==typeof e&&"object"==typeof e.document&&(e.jQuery=e.$=x)})(window),!function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=i.toString,l=i.hasOwnProperty,c=r.forEach,h=r.map,p=r.reduce,d=r.reduceRight,v=r.filter,m=r.every,g=r.some,y=r.indexOf,b=r.lastIndexOf,w=Array.isArray,E=Object.keys,S=s.bind,x=function(e){return e instanceof x?e:this instanceof x?(this._wrapped=e,void 0):new x(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.5.1";var T=x.each=x.forEach=function(e,t,r){if(null!=e)if(c&&e.forEach===c)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;s>i;i++)if(t.call(r,e[i],i,e)===n)return}else for(var o in e)if(x.has(e,o)&&t.call(r,e[o],o,e)===n)return};x.map=x.collect=function(e,t,n){var r=[];return null==e?r:h&&e.map===h?e.map(t,n):(T(e,function(e,i,s){r.push(t.call(n,e,i,s))}),r)};var N="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return r&&(t=x.bind(t,r)),i?e.reduce(t,n):e.reduce(t);if(T(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)}),!i)throw new TypeError(N);return n},x.reduceRight=x.foldr=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),d&&e.reduceRight===d)return r&&(t=x.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=x.keys(e);s=o.length}if(T(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)}),!i)throw new TypeError(N);return n},x.find=x.detect=function(e,t,n){var r;return C(e,function(e,i,s){return t.call(n,e,i,s)?(r=e,!0):void 0}),r},x.filter=x.select=function(e,t,n){var r=[];return null==e?r:v&&e.filter===v?e.filter(t,n):(T(e,function(e,i,s){t.call(n,e,i,s)&&r.push(e)}),r)},x.reject=function(e,t,n){return x.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},x.every=x.all=function(e,t,r){t||(t=x.identity);var i=!0;return null==e?i:m&&e.every===m?e.every(t,r):(T(e,function(e,s,o){return(i=i&&t.call(r,e,s,o))?void 0:n}),!!i)};var C=x.some=x.any=function(e,t,r){t||(t=x.identity);var i=!1;return null==e?i:g&&e.some===g?e.some(t,r):(T(e,function(e,s,o){return i||(i=t.call(r,e,s,o))?n:void 0}),!!i)};x.contains=x.include=function(e,t){return null==e?!1:y&&e.indexOf===y?e.indexOf(t)!=-1:C(e,function(e){return e===t})},x.invoke=function(e,t){var n=u.call(arguments,2),r=x.isFunction(t);return x.map(e,function(e){return(r?t:e[t]).apply(e,n)})},x.pluck=function(e,t){return x.map(e,function(e){return e[t]})},x.where=function(e,t,n){return x.isEmpty(t)?n?void 0:[]:x[n?"find":"filter"](e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},x.findWhere=function(e,t){return x.where(e,t,!0)},x.max=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&x.isEmpty(e))return-1/0;var r={computed:-1/0,value:-1/0};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>r.computed&&(r={value:e,computed:o})}),r.value},x.min=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&x.isEmpty(e))return 1/0;var r={computed:1/0,value:1/0};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o<r.computed&&(r={value:e,computed:o})}),r.value},x.shuffle=function(e){var t,n=0,r=[];return T(e,function(e){t=x.random(n++),r[n-1]=r[t],r[t]=e}),r};var k=function(e){return x.isFunction(e)?e:function(t){return t[e]}};x.sortBy=function(e,t,n){var r=k(t);return x.pluck(x.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(r>n||r===void 0)return-1}return e.index<t.index?-1:1}),"value")};var L=function(e,t,n,r){var i={},s=k(null==t?x.identity:t);return T(e,function(t,o){var u=s.call(n,t,o,e);r(i,u,t)}),i};x.groupBy=function(e,t,n){return L(e,t,n,function(e,t,n){(x.has(e,t)?e[t]:e[t]=[]).push(n)})},x.countBy=function(e,t,n){return L(e,t,n,function(e,t){x.has(e,t)||(e[t]=0),e[t]++})},x.sortedIndex=function(e,t,n,r){n=null==n?x.identity:k(n);for(var i=n.call(r,t),s=0,o=e.length;o>s;){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},x.toArray=function(e){return e?x.isArray(e)?u.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return null==e?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:u.call(e,0,t)},x.initial=function(e,t,n){return u.call(e,0,e.length-(null==t||n?1:t))},x.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:u.call(e,Math.max(e.length-t,0))},x.rest=x.tail=x.drop=function(e,t,n){return u.call(e,null==t||n?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var A=function(e,t,n){return t&&x.every(e,x.isArray)?a.apply(n,e):(T(e,function(e){x.isArray(e)||x.isArguments(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n)};x.flatten=function(e,t){return A(e,t,[])},x.without=function(e){return x.difference(e,u.call(arguments,1))},x.uniq=x.unique=function(e,t,n,r){x.isFunction(t)&&(r=n,n=t,t=!1);var i=n?x.map(e,n,r):e,s=[],o=[];return T(i,function(n,r){(t?r&&o[o.length-1]===n:x.contains(o,n))||(o.push(n),s.push(e[r]))}),s},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(e){var t=u.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.indexOf(t,e)>=0})})},x.difference=function(e){var t=a.apply(r,u.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){for(var e=x.max(x.pluck(arguments,"length").concat(0)),t=new Array(e),n=0;e>n;n++)t[n]=x.pluck(arguments,""+n);return t},x.object=function(e,t){if(null==e)return{};for(var n={},r=0,i=e.length;i>r;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},x.indexOf=function(e,t,n){if(null==e)return-1;var r=0,i=e.length;if(n){if("number"!=typeof n)return r=x.sortedIndex(e,t),e[r]===t?r:-1;r=0>n?Math.max(0,i+n):n}if(y&&e.indexOf===y)return e.indexOf(t,n);for(;i>r;r++)if(e[r]===t)return r;return-1},x.lastIndexOf=function(e,t,n){if(null==e)return-1;var r=null!=n;if(b&&e.lastIndexOf===b)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var i=r?n:e.length;i--;)if(e[i]===t)return i;return-1},x.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);r>i;)s[i++]=e,e+=n;return s};var O=function(){};x.bind=function(e,t){var n,r;if(S&&e.bind===S)return S.apply(e,u.call(arguments,1));if(!x.isFunction(e))throw new TypeError;return n=u.call(arguments,2),r=function(){if(this instanceof r){O.prototype=e.prototype;var i=new O;O.prototype=null;var s=e.apply(i,n.concat(u.call(arguments)));return Object(s)===s?s:i}return e.apply(t,n.concat(u.call(arguments)))}},x.partial=function(e){var t=u.call(arguments,1);return function(){return e.apply(this,t.concat(u.call(arguments)))}},x.bindAll=function(e){var t=u.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return T(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var n={};return t||(t=x.identity),function(){var r=t.apply(this,arguments);return x.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},x.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(u.call(arguments,1)))},x.throttle=function(e,t,n){var r,i,s,o=null,u=0;n||(n={});var a=function(){u=n.leading===!1?0:new Date,o=null,s=e.apply(r,i)};return function(){var f=new Date;u||n.leading!==!1||(u=f);var l=t-(f-u);return r=this,i=arguments,0>=l?(clearTimeout(o),o=null,u=f,s=e.apply(r,i)):o||n.trailing===!1||(o=setTimeout(a,l)),s}},x.debounce=function(e,t,n){var r,i=null;return function(){var s=this,o=arguments,u=function(){i=null,n||(r=e.apply(s,o))},a=n&&!i;return clearTimeout(i),i=setTimeout(u,t),a&&(r=e.apply(s,o)),r}},x.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}},x.wrap=function(e,t){return function(){var n=[e];return o.apply(n,arguments),t.apply(this,n)}},x.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},x.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},x.keys=E||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)x.has(e,n)&&t.push(n);return t},x.values=function(e){var t=[];for(var n in e)x.has(e,n)&&t.push(e[n]);return t},x.pairs=function(e){var t=[];for(var n in e)x.has(e,n)&&t.push([n,e[n]]);return t},x.invert=function(e){var t={};for(var n in e)x.has(e,n)&&(t[e[n]]=n);return t},x.functions=x.methods=function(e){var t=[];for(var n in e)x.isFunction(e[n])&&t.push(n);return t.sort()},x.extend=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},x.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return T(n,function(n){n in e&&(t[n]=e[n])}),t},x.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)x.contains(n,i)||(t[i]=e[i]);return t},x.defaults=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]===void 0&&(e[n]=t[n])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var M=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var i=f.call(e);if(i!=f.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var s=n.length;s--;)if(n[s]==e)return r[s]==t;var o=e.constructor,u=t.constructor;if(o!==u&&!(x.isFunction(o)&&o instanceof o&&x.isFunction(u)&&u instanceof u))return!1;n.push(e),r.push(t);var a=0,l=!0;if("[object Array]"==i){if(a=e.length,l=a==t.length)for(;a--&&(l=M(e[a],t[a],n,r)););}else{for(var c in e)if(x.has(e,c)&&(a++,!(l=x.has(t,c)&&M(e[c],t[c],n,r))))break;if(l){for(c in t)if(x.has(t,c)&&!(a--))break;l=!a}}return n.pop(),r.pop(),l};x.isEqual=function(e,t){return M(e,t,[],[])},x.isEmpty=function(e){if(null==e)return!0;if(x.isArray(e)||x.isString(e))return 0===e.length;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!!e&&1===e.nodeType},x.isArray=w||function(e){return"[object Array]"==f.call(e)},x.isObject=function(e){return e===Object(e)},T(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return f.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!!e&&!!x.has(e,"callee")}),"function"!=typeof /./&&(x.isFunction=function(e){return"function"==typeof e}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==f.call(e)},x.isNull=function(e){return null===e},x.isUndefined=function(e){return e===void 0},x.has=function(e,t){return l.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.times=function(e,t,n){for(var r=Array(Math.max(0,e)),i=0;e>i;i++)r[i]=t.call(n,i);return r},x.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var _={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};_.unescape=x.invert(_.escape);var D={escape:new RegExp("["+x.keys(_.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(_.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return null==t?"":(""+t).replace(D[e],function(t){return _[e][t]})}}),x.result=function(e,t){if(null==e)return void 0;var n=e[t];return x.isFunction(n)?n.call(e):n},x.mixin=function(e){T(x.functions(e),function(t){var n=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),F.call(this,n.apply(x,e))}})};var P=0;x.uniqueId=function(e){var t=++P+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,n){var r;n=x.defaults({},n,x.templateSettings);var i=new RegExp([(n.escape||H).source,(n.interpolate||H).source,(n.evaluate||H).source].join("|")+"|$","g"),s=0,o="__p+='";e.replace(i,function(t,n,r,i,u){return o+=e.slice(s,u).replace(j,function(e){return"\\"+B[e]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(o+="';\n"+i+"\n__p+='"),s=u+t.length,t}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=new Function(n.variable||"obj","_",o)}catch(u){throw u.source=o,u}if(t)return r(t,x);var a=function(e){return r.call(this,e,x)};return a.source="function("+(n.variable||"obj")+"){\n"+o+"}",a},x.chain=function(e){return x(e).chain()};var F=function(e){return this._chain?x(e).chain():e};x.mixin(x),T(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];x.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!=e&&"splice"!=e||0!==n.length||delete n[0],F.call(this,n)}}),T(["concat","join","slice"],function(e){var t=r[e];x.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),define("underscore",function(e){return function(){var t,n;return t||e._}}(this)),function(){var e=this,t=e.Backbone,n=[],r=n.push,i=n.slice,s=n.splice,o;typeof exports!="undefined"?o=exports:o=e.Backbone={},o.VERSION="1.0.0";var u=e._;!u&&typeof require!="undefined"&&(u=require("underscore")),o.$=e.jQuery||e.Zepto||e.ender||e.$,o.noConflict=function(){return e.Backbone=t,this},o.emulateHTTP=!1,o.emulateJSON=!1;var a=o.Events={on:function(e,t,n){if(!l(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var r=this._events[e]||(this._events[e]=[]);return r.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,n){if(!l(this,"once",e,[t,n])||!t)return this;var r=this,i=u.once(function(){r.off(e,i),t.apply(this,arguments)});return i._callback=t,this.on(e,i,n)},off:function(e,t,n){var r,i,s,o,a,f,c,h;if(!this._events||!l(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events={},this;o=e?[e]:u.keys(this._events);for(a=0,f=o.length;a<f;a++){e=o[a];if(s=this._events[e]){this._events[e]=r=[];if(t||n)for(c=0,h=s.length;c<h;c++)i=s[c],(t&&t!==i.callback&&t!==i.callback._callback||n&&n!==i.context)&&r.push(i);r.length||delete this._events[e]}}return this},trigger:function(e){if(!this._events)return this;var t=i.call(arguments,1);if(!l(this,"trigger",e,t))return this;var n=this._events[e],r=this._events.all;return n&&c(n,t),r&&c(r,arguments),this},stopListening:function(e,t,n){var r=this._listeners;if(!r)return this;var i=!t&&!n;typeof t=="object"&&(n=this),e&&((r={})[e._listenerId]=e);for(var s in r)r[s].off(t,n,this),i&&delete this._listeners[s];return this}},f=/\s+/,l=function(e,t,n,r){if(!n)return!0;if(typeof n=="object"){for(var i in n)e[t].apply(e,[i,n[i]].concat(r));return!1}if(f.test(n)){var s=n.split(f);for(var o=0,u=s.length;o<u;o++)e[t].apply(e,[s[o]].concat(r));return!1}return!0},c=function(e,t){var n,r=-1,i=e.length,s=t[0],o=t[1],u=t[2];switch(t.length){case 0:while(++r<i)(n=e[r]).callback.call(n.ctx);return;case 1:while(++r<i)(n=e[r]).callback.call(n.ctx,s);return;case 2:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o);return;case 3:while(++r<i)(n=e[r]).callback.call(n.ctx,s,o,u);return;default:while(++r<i)(n=e[r]).callback.apply(n.ctx,t)}},h={listenTo:"on",listenToOnce:"once"};u.each(h,function(e,t){a[t]=function(t,n,r){var i=this._listeners||(this._listeners={}),s=t._listenerId||(t._listenerId=u.uniqueId("l"));return i[s]=t,typeof n=="object"&&(r=this),t[e](n,r,this),this}}),a.bind=a.on,a.unbind=a.off,u.extend(o,a);var p=o.Model=function(e,t){var n,r=e||{};t||(t={}),this.cid=u.uniqueId("c"),this.attributes={},u.extend(this,u.pick(t,d)),t.parse&&(r=this.parse(r,t)||{});if(n=u.result(this,"defaults"))r=u.defaults({},r,n);this.set(r,t),this.changed={},this.initialize.apply(this,arguments)},d=["url","urlRoot","collection"];u.extend(p.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(e){return u.clone(this.attributes)},sync:function(){return o.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return u.escape(this.get(e))},has:function(e){return this.get(e)!=null},set:function(e,t,n){var r,i,s,o,a,f,l,c;if(e==null)return this;typeof e=="object"?(i=e,n=t):(i={})[e]=t,n||(n={});if(!this._validate(i,n))return!1;s=n.unset,a=n.silent,o=[],f=this._changing,this._changing=!0,f||(this._previousAttributes=u.clone(this.attributes),this.changed={}),c=this.attributes,l=this._previousAttributes,this.idAttribute in i&&(this.id=i[this.idAttribute]);for(r in i)t=i[r],u.isEqual(c[r],t)||o.push(r),u.isEqual(l[r],t)?delete this.changed[r]:this.changed[r]=t,s?delete c[r]:c[r]=t;if(!a){o.length&&(this._pending=!0);for(var h=0,p=o.length;h<p;h++)this.trigger("change:"+o[h],this,c[o[h]],n)}if(f)return this;if(!a)while(this._pending)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,u.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,u.extend({},e,{unset:!0}))},hasChanged:function(e){return e==null?!u.isEmpty(this.changed):u.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?u.clone(this.changed):!1;var t,n=!1,r=this._changing?this._previousAttributes:this.attributes;for(var i in e){if(u.isEqual(r[i],t=e[i]))continue;(n||(n={}))[i]=t}return n},previous:function(e){return e==null||!this._previousAttributes?null:this._previousAttributes[e]},previousAttributes:function(){return u.clone(this._previousAttributes)},fetch:function(e){e=e?u.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=this,n=e.success;return e.success=function(r){if(!t.set(t.parse(r,e),e))return!1;n&&n(t,r,e),t.trigger("sync",t,r,e)},j(this,e),this.sync("read",this,e)},save:function(e,t,n){var r,i,s,o=this.attributes;e==null||typeof e=="object"?(r=e,n=t):(r={})[e]=t;if(r&&(!n||!n.wait)&&!this.set(r,n))return!1;n=u.extend({validate:!0},n);if(!this._validate(r,n))return!1;r&&n.wait&&(this.attributes=u.extend({},o,r)),n.parse===void 0&&(n.parse=!0);var a=this,f=n.success;return n.success=function(e){a.attributes=o;var t=a.parse(e,n);n.wait&&(t=u.extend(r||{},t));if(u.isObject(t)&&!a.set(t,n))return!1;f&&f(a,e,n),a.trigger("sync",a,e,n)},j(this,n),i=this.isNew()?"create":n.patch?"patch":"update",i==="patch"&&(n.attrs=r),s=this.sync(i,this,n),r&&n.wait&&(this.attributes=o),s},destroy:function(e){e=e?u.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};e.success=function(i){(e.wait||t.isNew())&&r(),n&&n(t,i,e),t.isNew()||t.trigger("sync",t,i,e)};if(this.isNew())return e.success(),!1;j(this,e);var i=this.sync("delete",this,e);return e.wait||r(),i},url:function(){var e=u.result(this,"urlRoot")||u.result(this.collection,"url")||B();return this.isNew()?e:e+(e.charAt(e.length-1)==="/"?"":"/")+encodeURIComponent(this.id)},parse:function(e,t){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},isValid:function(e){return this._validate({},u.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=u.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return n?(this.trigger("invalid",this,n,u.extend(t||{},{validationError:n})),!1):!0}});var v=["keys","values","pairs","invert","pick","omit"];u.each(v,function(e){p.prototype[e]=function(){var t=i.call(arguments);return t.unshift(this.attributes),u[e].apply(u,t)}});var m=o.Collection=function(e,t){t||(t={}),t.url&&(this.url=t.url),t.model&&(this.model=t.model),t.comparator!==void 0&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,u.extend({silent:!0},t))},g={add:!0,remove:!0,merge:!0},y={add:!0,merge:!1,remove:!1};u.extend(m.prototype,a,{model:p,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return o.sync.apply(this,arguments)},add:function(e,t){return this.set(e,u.defaults(t||{},y))},remove:function(e,t){e=u.isArray(e)?e.slice():[e],t||(t={});var n,r,i,s;for(n=0,r=e.length;n<r;n++){s=this.get(e[n]);if(!s)continue;delete this._byId[s.id],delete this._byId[s.cid],i=this.indexOf(s),this.models.splice(i,1),this.length--,t.silent||(t.index=i,s.trigger("remove",s,this,t)),this._removeReference(s)}return this},set:function(e,t){t=u.defaults(t||{},g),t.parse&&(e=this.parse(e,t)),u.isArray(e)||(e=e?[e]:[]);var n,i,o,a,f,l,c=t.at,h=this.comparator&&c==null&&t.sort!==!1,p=u.isString(this.comparator)?this.comparator:null,d=[],v=[],m={};for(n=0,i=e.length;n<i;n++){if(!(o=this._prepareModel(e[n],t)))continue;(f=this.get(o))?(t.remove&&(m[f.cid]=!0),t.merge&&(f.set(o.attributes,t),h&&!l&&f.hasChanged(p)&&(l=!0))):t.add&&(d.push(o),o.on("all",this._onModelEvent,this),this._byId[o.cid]=o,o.id!=null&&(this._byId[o.id]=o))}if(t.remove){for(n=0,i=this.length;n<i;++n)m[(o=this.models[n]).cid]||v.push(o);v.length&&this.remove(v,t)}d.length&&(h&&(l=!0),this.length+=d.length,c!=null?s.apply(this.models,[c,0].concat(d)):r.apply(this.models,d)),l&&this.sort({silent:!0});if(t.silent)return this;for(n=0,i=d.length;n<i;n++)(o=d[n]).trigger("add",o,this,t);return l&&this.trigger("sort",this,t),this},reset:function(e,t){t||(t={});for(var n=0,r=this.models.length;n<r;n++)this._removeReference(this.models[n]);return t.previousModels=this.models,this._reset(),this.add(e,u.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,u.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,u.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){return e==null?void 0:this._byId[e.id!=null?e.id:e.cid||e]},at:function(e){return this.models[e]},where:function(e,t){return u.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),u.isString(this.comparator)||this.comparator.length===1?this.models=this.sortBy(this.comparator,this):this.models.sort(u.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},sortedIndex:function(e,t,n){t||(t=this.comparator);var r=u.isFunction(t)?t:function(e){return e.get(t)};return u.sortedIndex(this.models,e,r,n)},pluck:function(e){return u.invoke(this.models,"get",e)},fetch:function(e){e=e?u.clone(e):{},e.parse===void 0&&(e.parse=!0);var t=e.success,n=this;return e.success=function(r){var i=e.reset?"reset":"set";n[i](r,e),t&&t(n,r,e),n.trigger("sync",n,r,e)},j(this,e),this.sync("read",this,e)},create:function(e,t){t=t?u.clone(t):{};if(!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,r=t.success;return t.success=function(i){t.wait&&n.add(e,t),r&&r(e,i,t)},e.save(null,t),e},parse:function(e,t){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof p)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var n=new this.model(e,t);return n._validate(e,t)?n:(this.trigger("invalid",this,e,t),!1)},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,r){if((e==="add"||e==="remove")&&n!==this)return;e==="destroy"&&this.remove(t,r),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],t.id!=null&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments)}});var b=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];u.each(b,function(e){m.prototype[e]=function(){var t=i.call(arguments);return t.unshift(this.models),u[e].apply(u,t)}});var w=["groupBy","countBy","sortBy"];u.each(w,function(e){m.prototype[e]=function(t,n){var r=u.isFunction(t)?t:function(e){return e.get(t)};return u[e](this.models,r,n)}});var E=o.View=function(e){this.cid=u.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},S=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];u.extend(E.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,t){return this.$el&&this.undelegateEvents(),this.$el=e instanceof o.$?e:o.$(e),this.el=this.$el[0],t!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=u.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var n=e[t];u.isFunction(n)||(n=this[e[t]]);if(!n)continue;var r=t.match(S),i=r[1],s=r[2];n=u.bind(n,this),i+=".delegateEvents"+this.cid,s===""?this.$el.on(i,n):this.$el.on(i,s,n)}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_configure:function(e){this.options&&(e=u.extend({},u.result(this,"options"),e)),u.extend(this,u.pick(e,x)),this.options=e},_ensureElement:function(){if(!this.el){var e=u.extend({},u.result(this,"attributes"));this.id&&(e.id=u.result(this,"id")),this.className&&(e["class"]=u.result(this,"className"));var t=o.$("<"+u.result(this,"tagName")+">").attr(e);this.setElement(t,!1)}else this.setElement(u.result(this,"el"),!1)}}),o.sync=function(e,t,n){var r=T[e];u.defaults(n||(n={}),{emulateHTTP:o.emulateHTTP,emulateJSON:o.emulateJSON});var i={type:r,dataType:"json"};n.url||(i.url=u.result(t,"url")||B()),n.data==null&&t&&(e==="create"||e==="update"||e==="patch")&&(i.contentType="application/json",i.data=JSON.stringify(n.attrs||t.toJSON(n))),n.emulateJSON&&(i.contentType="application/x-www-form-urlencoded",i.data=i.data?{model:i.data}:{});if(n.emulateHTTP&&(r==="PUT"||r==="DELETE"||r==="PATCH")){i.type="POST",n.emulateJSON&&(i.data._method=r);var s=n.beforeSend;n.beforeSend=function(e){e.setRequestHeader("X-HTTP-Method-Override",r);if(s)return s.apply(this,arguments)}}i.type!=="GET"&&!n.emulateJSON&&(i.processData=!1),i.type==="PATCH"&&window.ActiveXObject&&(!window.external||!window.external.msActiveXFilteringEnabled)&&(i.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var a=n.xhr=o.ajax(u.extend(i,n));return t.trigger("request",t,a,n),a};var T={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};o.ajax=function(){return o.$.ajax.apply(o.$,arguments)};var N=o.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},C=/\((.*?)\)/g,k=/(\(\?)?:\w+/g,L=/\*\w+/g,A=/[\-{}\[\]+?.,\\\^$|#\s]/g;u.extend(N.prototype,a,{initialize:function(){},route:function(e,t,n){u.isRegExp(e)||(e=this._routeToRegExp(e)),u.isFunction(t)&&(n=t,t=""),n||(n=this[t]);var r=this;return o.history.route(e,function(i){var s=r._extractParameters(e,i);n&&n.apply(r,s),r.trigger.apply(r,["route:"+t].concat(s)),r.trigger("route",t,s),o.history.trigger("route",r,t,s)}),this},navigate:function(e,t){return o.history.navigate(e,t),this},_bindRoutes:function(){if(!this.routes)return;this.routes=u.result(this,"routes");var e,t=u.keys(this.routes);while((e=t.pop())!=null)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(A,"\\$&").replace(C,"(?:$1)?").replace(k,function(e,t){return t?e:"([^/]+)"}).replace(L,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return u.map(n,function(e){return e?decodeURIComponent(e):null})}});var O=o.History=function(){this.handlers=[],u.bindAll(this,"checkUrl"),typeof window!="undefined"&&(this.location=window.location,this.history=window.history)},M=/^[#\/]|\s+$/g,_=/^\/+|\/+$/g,D=/msie [\w.]+/,P=/\/$/;O.started=!1,u.extend(O.prototype,a,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(e==null)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(P,"");e.indexOf(n)||(e=e.substr(n.length))}else e=this.getHash();return e.replace(M,"")},start:function(e){if(O.started)throw new Error("Backbone.history has already been started");O.started=!0,this.options=u.extend({},{root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var t=this.getFragment(),n=document.documentMode,r=D.exec(navigator.userAgent.toLowerCase())&&(!n||n<=7);this.root=("/"+this.root+"/").replace(_,"/"),r&&this._wantsHashChange&&(this.iframe=o.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(t)),this._hasPushState?o.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?o.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=t;var i=this.location,s=i.pathname.replace(/[^\/]$/,"$&/")===this.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!s)return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&s&&i.hash&&(this.fragment=this.getHash().replace(M,""),this.history.replaceState({},document.title,this.root+this.fragment+i.search));if(!this.options.silent)return this.loadUrl()},stop:function(){o.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),O.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(e){var t=this.getFragment();t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe)));if(t===this.fragment)return!1;this.iframe&&this.navigate(t),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=u.any(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0});return n},navigate:function(e,t){if(!O.started)return!1;if(!t||t===!0)t={trigger:t};e=this.getFragment(e||"");if(this.fragment===e)return;this.fragment=e;var n=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)},_updateHash:function(e,t,n){if(n){var r=e.href.replace(/(javascript:|#).*$/,"");e.replace(r+"#"+t)}else e.hash="#"+t}}),o.history=new O;var H=function(e,t){var n=this,r;e&&u.has(e,"constructor")?r=e.constructor:r=function(){return n.apply(this,arguments)},u.extend(r,n,t);var i=function(){this.constructor=r};return i.prototype=n.prototype,r.prototype=new i,e&&u.extend(r.prototype,e),r.__super__=n.prototype,r};p.extend=m.extend=N.extend=E.extend=O.extend=H;var B=function(){throw new Error('A "url" property or function must be specified')},j=function(e,t){var n=t.error;t.error=function(r){n&&n(e,r,t),e.trigger("error",e,r,t)}}}.call(this),define("backbone",["jquery","underscore"],function(e){return function(){var t,n;return t||e.Backbone}}(this)),define("expressoAPI",["jquery","underscore","backbone"],function(e,t,n){jQuery.ajaxTransport("arraybuffer",function(e,t,n){return{send:function(t,r){n=new XMLHttpRequest,n.open(e.type,e.url),n.responseType=e.dataType,n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.timeout=e.xdrTimeout||Number.MAX_VALUE,n.onload=function(){e.loadArrayBuffer(n.response)},n.send(e.hasContent&&e.data||null)},abort:function(){n&&(n.onerror=jQuery.noop,n.abort())}}}),jQuery.ajaxTransport("fileupload",function(e,t,n){return{send:function(t,r){n=new XMLHttpRequest,n.open(e.type,e.url,!0);var i="AaB03x03923248232482",s="",o={id:e.id,params:e.params};s+="--"+i+"\r\n",s+='Content-Disposition: form-data; name="id"\r\n\r\n',s+=e.id,s+="\r\n";for(var u in e.params)s+="--"+i+"\r\n",s+='Content-Disposition: form-data; name="params['+u+']"\r\n',s+="Content-Type: text/plain; charset=UTF-8 \r\n\r\n",s+=unescape(encodeURIComponent(e.params[u].replace(/\t/g,""))),s+="\r\n";for(var u in e.files){var a=e.files[u];s+="--"+i+"\r\n",s+="Content-Disposition: form-data; name='upload"+u+"'; filename='"+a.filename+"'\r\n",s+="Content-Type: application/octet-stream\r\n",s+="Content-Transfer-Encoding: binary\r\n\r\n",e.files[u].dataType=="base64"?s+=a.data?a.data:atob(a.src.replace(/[^A-Za-z0-9\+\/\=]/g,""))+"\r\n":s+=e.files[u].src+"\r\n"}s+="--"+i+"--",n.setRequestHeader("content-type","multipart/form-data; boundary="+i),n.onload=function(){e.loadArrayBuffer(n.response)},n.onerror=function(){};if(typeof XMLHttpRequest.prototype.sendAsBinary=="undefined"){var f=new Uint8Array(Array.prototype.map.call(s,function(e){return e.charCodeAt(0)&255}));n.send(f.buffer)}else n.sendAsBinary(s)},abort:function(){n&&(n.onerror=jQuery.noop,n.abort())}}});var r=new function(){var t="0",n="",r="",i="",s=!0,o="",u={},a=[],f=!1,l=!1,c=[],h=!1,p=!1,d="",v=0,m=300,g=3600,y=86400,b=604800,w=2419200,E=["/Login","/Logout","/Mail/Send","/Mail/AddFolder","/Mail/DelFolder","/Mail/RenameFolder","/Mail/DelMessage","/Mail/CleanTrash","/Mail/SendSupportFeedback","/Preferences/ChangePassword","/Preferences/ChangeUserPreferences","/Services/Chat","/Catalog/ContactAdd","/Catalog/ContactDelete","/Calendar/AddEvent","/Calendar/DelEvent"],S=["/Mail/Messages","/Mail/Folders"],x=["/Preferences/UserPreferences","/Mail/Attachment"],T=["/Catalog/Contacts","/Calendar/Events","/Calendar/EventCategories"],N=["/ExpressoVersion","/Catalog/ContactPicture"],C=[],k,L,A,O;this.id=function(e){if(e==undefined)return t;var n=parseInt(String(e));return t=isNaN(n)?0:n,u[t]={},this.resource("").type("POST").params({}).done().always().fail(this.defaultErrorCallback),this._isOffline=!1,this._ignoreCache=!1,this},this.defaultErrorCallback=function(e){},this.getRequest=function(e){var t={};t.resource=this.resource(),t.params=this.params(),t.date=Date.now();var n=Object.keys(t.params);return t.response=e,t.timeToLive=0,E.indexOf(t.resource)>=0&&(t.timeToLive=v),S.indexOf(t.resource)>=0&&(t.timeToLive=m),x.indexOf(t.resource)>=0&&(t.timeToLive=g),T.indexOf(t.resource)>=0&&(t.timeToLive=y),N.indexOf(t.resource)>=0&&(t.timeToLive=b),C.indexOf(t.resource)>=0&&(t.timeToLive=w),t.resource=="/Mail/Messages"&&t.params.msgID!=undefined&&(t.timeToLive=w),t},this.getCacheResponse=function(e,t){var n=this,r=e.resource,i=e.params,s=e.timeToLive*1e3,o=function(e){n._cache=e;var o=!1;for(var u in e)if(r==e[u].resource){var a=!0;for(var f in i)f!="auth"&&i[f]!=e[u].params[f]&&(a=!1);if(a)if(n._isOffline==0){var l=new Date;s>l-e[u].date&&(o=e[u])}else o=e[u]}t(o)},u=function(){t(!1)};this.getLocalStorageValue(this.getCacheID(),o,u)},this.createRequest=function(e,t,n){var r={};return r.params={},r.resource=e,r.params=t,r},this.triggerCacheRequest=function(e,t){var n=[];n.push(this.createRequest("/Login",{}));if(t.resource=="/Mail/AddFolder"||t.resource=="/Mail/RenameFolder"||t.resource=="/Mail/DelFolder")n.push(this.createRequest("/Mail/Folders",{})),n.push(this.createRequest("/Mail/Messages",{folderID:t.params.folderID})),n.push(this.createRequest(t.resource,{}));t.resource=="/Mail/DelMessage"&&(n.push(this.createRequest("/Mail/Messages",{folderID:t.params.folderID,msgID:""})),n.push(this.createRequest("/Mail/Messages",{folderID:t.params.folderID,msgID:t.params.msgID})),n.push(this.createRequest("/Mail/DelMessage",{folderID:t.params.folderID,msgID:t.params.msgID}))),t.resource=="/Preferences/ChangeUserPreferences"&&(n.push(this.createRequest("/Preferences/UserPreferences",{})),n.push(this.createRequest("/Preferences/ChangeUserPreferences",{}))),t.resource=="/Calendar/AddEvent"&&n.push(this.createRequest("/Calendar/Events",{})),t.resource=="/Calendar/DelEvent"&&n.push(this.createRequest("/Calendar/Events",{}));var r=!1,i=[],s=[];r&&(console.log("request: "+t.resource+" - "+JSON.stringify(t.params)),console.log("filterRequestsLength:"+n.length),console.log("currentCacheLenght: "+e.length));if(n.length!=0){for(var o in n){r&&console.log("filter: "+n[o].resource+" - "+JSON.stringify(n[o].params));for(var u in e){r&&console.log("Cache "+u+":"+e[u].resource+" - "+JSON.stringify(e[u].params));if(e[u].resource==n[o].resource){var a=!0;for(var f in n[o].params)for(var l in e[u].params)l==f&&e[u].params[l]!=n[o].params[f]&&(a=!1);a&&i.push(u)}}}r&&(console.log("WillRemoveFromCache"),console.log(i));for(var o in e)i.indexOf(o)<0&&s.push(e[o])}else s=e;return s},this.getCacheID=function(){return"expressoCache"},this.addToCache=function(e,t){var n=this,r=function(e,t,r){r==undefined&&(r=[]),n._cache=r;var i=e.params,s=!1;for(var o in n._cache)if(e.resource==n._cache[o].resource){var u=!0;for(var a in i)a!="auth"&&i[a]!=n._cache[o].params[a]&&(u=!1);u&&t.result&&(n._cache[o].date=Date.now(),n._cache[o].response=t,s=e)}s||t.result&&(e.response=t,n._cache.push(e)),n._cache=n.triggerCacheRequest(n._cache,e),n.setLocalStorageValue(n.getCacheID(),n._cache)},i=function(n){r(e,t,n)},s=function(){console.log("ERROR - FROM CACHE"),r(e,t,n._cache)};this.getLocalStorageValue(this.getCacheID(),i,s)},this.ignoreCache=function(e){return e==undefined?p:(p=e,this)},this.crossdomain=function(e){return e==undefined?r:(r=String(e),this)},this.context=function(e){return e==undefined?n:(n=e?e=="/"?"":String(e).replace(/\/+$/g,""):".",this)},this.auth=function(e){return e==undefined?i:(i=String(e),this)},this.phoneGap=function(e){return e==undefined?f:(f=e,this)},this.android=function(e){return e==undefined?l:(l=e,this)},this.debug=function(e){return e==undefined?s:(s=String(e).toLowerCase()=="true",this)},this.dataType=function(e){return e==undefined?o:(o=e,this)},this.resource=function(e){return e==undefined?u[t].resource:(o="",u[t].resource="/"+String(e).replace(/^\/*|\/*$/g,""),this)},this.type=function(e){return e==undefined?u[t].type:(u[t].type=e.toUpperCase()=="GET"?"GET":"POST",this)},this.clearFiles=function(){return a=[],this},this.addFile=function(e,t,n){return a.push({filename:t,src:e,dataType:n}),this},this.params=function(e){return e==undefined?u[t].params:(u[t].params=e,this)},this.done=function(e){return u[t].done=e,this},this.fail=function(e){return u[t].fail=e,this},this.always=function(e){return u[t].always=e,this},this.url=function(){return f?this.context()+this.resource():this.context()+this.resource()+(r?"?crossdomain="+r:"")},this.setCookie=function(e,t,n){window.localStorage.setItem(e,t)},this.read_cookie=function(e){},this.updatePhonegapDatabase=function(e){var t=JSON.stringify(L),n="UPDATE expresso set data = '"+t+"' where id = '1'";e.executeSql(n)},this.updatePhonegapCache=function(e){var t=JSON.stringify(A),n="UPDATE expressoCache set data = '"+t+"' where id = '1'";e.executeSql(n)},this.getPhonegapDatabaseValue=function(e){var t=this,n=function(e,t){if(t){var n=t.rows.length;for(var r=0;r<n;r++)O=JSON.parse(t.rows.item(r).data),_tempCallback!=undefined&&_tempCallback(O)}else console.log("NO-RESULTS")},r="SELECT * FROM expresso where id = '1'";e.executeSql(r,[],n,t.errorCB)},this.getPhonegapCacheValue=function(e){var t=function(e,t){if(t){var n=t.rows.length;for(var r=0;r<n;r++)_tempResultCache=JSON.parse(t.rows.item(r).data),_tempCallbackCache!=undefined&&_tempCallbackCache(_tempResultCache)}else console.log("NO-RESULTS")},n=function(e){console.log("errorCache")},r="SELECT * FROM expressoCache where id = '1'";e.executeSql(r,[],t,n)},this.clearCache=function(e){this.setLocalStorageValue(e,[])},this.setLocalStorageValue=function(e,t){if(window.localStorage!=undefined)try{return window.localStorage.setItem(e,JSON.stringify(t)),!0}catch(n){return window.localStorage.setItem("expressoCache","[]"),!1}},this.removeLocalStorageValue=function(e){window.localStorage.removeItem(e)},this.getLocalStorageValue=function(e,t,n){if(window.localStorage!=undefined)var r=window.localStorage.getItem(e);r?t(JSON.parse(r)):n&&n()},this.errorCB=function(e){},this.successCB=function(e){},this.populatePhoneGapDatabase=function(e){e.executeSql("DROP TABLE IF EXISTS expresso"),e.executeSql("DROP TABLE IF EXISTS expressoCache");var t={auth:"",profile:"",username:"",password:"",phoneGap:!0,serverAPI:"",settings:{resultsPerPage:30,automaticLogin:!1,mailSignature:"Mensagem enviada pelo Expresso Mobile."}},n=JSON.stringify(t),r=JSON.stringify([]);e.executeSql("CREATE TABLE IF NOT EXISTS expresso (id unique, data)"),e.executeSql("CREATE TABLE IF NOT EXISTS expressoCache (id unique, data)");var i="INSERT INTO expresso (id, data) VALUES ('1', '"+n+"')";e.executeSql(i),i="INSERT INTO expressoCache (id, data) VALUES ('1', '"+r+"')",e.executeSql(i)},this.createPhoneGapDatabase=function(){},this.readCookie=function(e){var t=window.localStorage.getItem(e);if(t)return t},this.options=function(e){for(var t in e)this.hasOwnProperty(t)&&this[t](e[t]);return this},this.conf=function(){u[t].send={},u[t].send.id=t,u[t].send.params=this.params(),i&&(u[t].send.params.auth=i);var e={};return e.headers={},e.xhrFields={withCredentials:!1},f?(e.id=t,e.type=this.type(),e.url=this.url(),e.data=u[t].send,e.params=u[t].send.params,e.crossDomain=!0,e.phoneGap=f,this.dataType()=="arraybuffer"?(e.dataType=this.dataType(),e.loadArrayBuffer=function(e){u[this.id].done&&u[this.id].done(e,u[this.id].send)}):this.dataType()=="fileupload"?(e.dataType=this.dataType(),e.files=a,e.loadArrayBuffer=function(e){var t=JSON.parse(e);t&&t.error&&t.error.message?u[this.id].fail&&u[this.id].fail(t.error,u[this.id].send):u[this.id].done&&u[this.id].done(t.result,u[this.id].send)}):e.timeout=3e4):(e.id=t,e.type=this.type(),e.url=this.url(),e.data=u[t].send,e.params=u[t].send.params,e.phoneGap=f,this.dataType()=="arraybuffer"?(e.dataType=this.dataType(),e.loadArrayBuffer=function(e){u[this.id].done&&u[this.id].done(e,u[this.id].send)}):this.dataType()=="fileupload"?(e.dataType=this.dataType(),e.files=a,e.loadArrayBuffer=function(e){u[this.id].done&&u[this.id].done(e,u[this.id].send)}):e.timeout=3e4),e},this.execute=function(){var n=this,r=this.conf();s=!1,s&&(console.log("ExpressoAPI - Execute:"+this.resource()),console.log(r));var i={error:{code:100,message:"Verifique sua conexão com a Internet."}},o={error:{code:100,message:"Esgotou-se o tempo limite da solicitação."}};if(f&&l){var a=navigator.connection.type;a==Connection.NONE&&(n._isOffline=!0,u[this.id()].fail&&u[this.id()].fail(i))}else if(!f){var c=navigator.onLine;c||(n._isOffline=!0,console.log("OFFLINEEEE"),u[this.id()].fail&&u[this.id()].fail(i))}this._data=u,r.error=function(e,t,r){t==="timeout"?(n._isOffline=!0,u[n.id()].fail&&u[n.id()].fail(o)):n._isOffline=!0};var h=this.getRequest();n._isOffline==0||n._isOffline==undefined?e("#isOffline").hide():e("#isOffline").show();var p=function(t){n.ignoreCache()==1&&(t=!1),t!=0&&t.response.result!=undefined&&t.response!=undefined?t.response.result&&t.response?n._data[n.id()].done&&n._data[n.id()].done(t.response.result,n._data[n.id()].send):n._data[n.id()].fail&&n._data[n.id()].fail(t.response,n.data[n.id()].send):(n._isOffline==0||n._isOffline==undefined)&&jQuery.ajax(r).done(function(t){!t.result&&!t.error&&(t=JSON.parse(t)),n.addToCache(h,t);if(t&&t.result)s&&(console.log("ExpressoAPI - DONE callback"),console.log(JSON.stringify(t))),t.result.auth&&n.auth(t.result.auth),u[this.id]&&(u[this.id].resource=="/Logout"&&n.auth(""),u[this.id].done&&u[this.id].done(t.result,u[this.id].send));else{s&&(console.log("ExpressoAPI - ERROR callback"),console.log(JSON.stringify(t)));if(t.error.code==100){s&&(console.log("ExpressoAPI - OFFLINE ERROR"),console.log(JSON.stringify(t))),e("#isOffline").show(),n._isOffline=!0;var r=n,i=u,o=this.id,a=function(e){e?e.response.result&&e.response&&i[o].done&&i[o].done(e.response.result,i[o].send):i[o].fail&&i[o].fail(t,i[o].send)};n.getCacheResponse(h,a)}else u[this.id].fail&&u[this.id].fail(t,u[this.id].send)}n.ignoreCache(!1)}).fail(function(e){s&&(console.log("ExpressoAPI - FAIL callback"),console.log(JSON.stringify(e))),u[this.id].fail&&u[this.id].fail(e,u[this.id].send),n.ignoreCache(!1)}).always(function(){s&&console.log("ExpressoAPI - ALWAYS callback"),u[this.id]&&(u[this.id].always&&u[this.id].always(u[this.id].send),delete u[this.id]),n.ignoreCache(!1)})};return this.getCacheResponse(h,p),this.id(t+1),this}};return r}),function(e){var t=new function(){var e,t={};this.id=function(n){if(n==undefined)return e;var r=parseInt(String(n));return e=isNaN(r)?0:r,t[e]={stage:0},this.url("").type("POST").params({}).done().always().fail(),this},this.url=function(n){return n==undefined?t[e].url:(t[e].url=n,this)},this.type=function(n){return n==undefined?t[e].type:(t[e].type=n.toUpperCase()=="GET"?"GET":"POST",this)},this.params=function(n){return n==undefined?t[e].params:(t[e].params=n,this)},this.done=function(n){return t[e].done=n,this},this.fail=function(n){return t[e].fail=n,this},this.always=function(n){return t[e].always=n,this},this.options=function(e){for(var t in e)this.hasOwnProperty(t)&&this[t](e[t]);return this},this.length=function(){var e=0,n;for(n in t)t.hasOwnProperty(n)&&t[n].stage>0&&e++;return e},this.conf=function(){t[e].send={},t[e].send.id=e,t[e].send.params=this.params();var n={};return n.id=e,n.type=this.type(),n.url=this.url(),n.data=this.params(),n.dataType="text",n},this.transport=function(){return window.XDomainRequest&&jQuery.ajaxTransport(function(e,n){if(e.crossDomain&&e.async){e.timeout&&(e.xdrTimeout=e.timeout,delete e.timeout);var r;return{send:function(i,u){function a(e,t,n,i){r.onload=r.onerror=r.ontimeout=jQuery.noop,r=undefined,u(e,t,n,i)}r=new XDomainRequest,n.id!=undefined&&(t[n.id].xdr=r),r.onload=function(){a(200,"OK",{text:r.responseText},"Content-Type: "+r.contentType)},r.onerror=function(){a(404,"Not Found")},r.onprogress=function(){},r.ontimeout=function(){a(0,"timeout")},r.timeout=e.xdrTimeout||Number.MAX_VALUE,r.open(e.type,e.url),r.send(e.hasContent&&e.data||null)},abort:function(){r&&(r.onerror=jQuery.noop,r.abort())}}}}),this},this.execute=function(){var n=this.conf();return t[e].stage=1,t[e].ajax=jQuery.ajax(n).done(function(e){if(t[this.id]==undefined)return;t[this.id].stage=-1,t[this.id].send.response=e,t[this.id].done&&t[this.id].done(e,t[this.id].send)}).fail(function(e){if(t[this.id]==undefined)return;t[this.id].stage=-1,t[this.id].fail&&t[this.id].fail(e,t[this.id].send)}).always(function(){if(t[this.id]==undefined)return;t[this.id].always&&t[this.id].always(t[this.id].send),delete t[this.id]}),this.id(e+1),this},this.abortAll=function(){var n=t[e];return t={},t[e]=n,this}};t.transport().id(0),e.xmpp={rid:null,sid:null,jid:null,url:null,uri:null,myPresence:"unavailable",domainJabber:"",listening:!1,hasConn:!1,onRoster:null,onMessage:null,onIq:null,onComposing:null,onPresence:null,onError:null,connections:0,resource:null,connected:!1,wait:60,inactivity:60,_jsTimeout:null,_timeoutMilis:500,__lastAjaxRequest:null,connect:function(t){this.rid=Math.round(Math.random()*Math.pow(10,10)),this.jid=t.username+"@"+t.domain;var n=t.domain;this.domainJabber=t.domain,this.hasConn=!0;var r=this;t.url==null?this.url="/http-bind":this.url=t.url,isNaN(t.wait)||(this.wait=t.wait),this._timeoutMilis=r.wait*1e3,isNaN(t.inactivity)||(this.inactivity=t.inactivity),this.uri=this.jid,t.resource==null?this.resource="":(this.resource=t.resource,this.uri+="/"+this.resource),this.onMessage=t.onMessage,this.onIq=t.onIq,this.onPresence=t.onPresence,this.onError=t.onError,this.onDisconnect=t.onDisconnect,this.onConnect=t.onConnect,this.onRoster=t.onRoster,this.onComposing=t.onComposing;var i="<body rid='"+this.rid+"' xmlns='http://jabber.org/protocol/httpbind' to='"+n+"' xml:lang='en' wait='"+this.wait+"' inactivity='"+this.inactivity+"' hold='1' content='text/xml; charset=utf-8' ver='1.6' xmpp:version='1.0' xmlns:xmpp='urn:xmpp:xbosh'/>";e.post(this.url,i,function(n){var i=e(r.fixBody(n));r.sid=i.attr("sid"),i.find("mechanism:contains('PLAIN')").length?r.loginPlain(t):i.find("mechanism:contains('DIGEST-MD5')").length?r.loginDigestMD5(t):r.onError!=null&&r.onError({error:"No auth method supported",data:n})},"text")},attach:function(e){this.jid=e.username+"@"+e.domain,this.sid=e.sid,this.rid=e.rid;var t=this;e.url==null?this.url="/http-bind":this.url=e.url,this.uri=this.jid,e.resource==null?this.resource="":(this.resource=e.resource,this.uri+="/"+this.resource),this.onMessage=e.onMessage,this.onIq=e.onIq,this.onPresence=e.onPresence,this.onError=e.onError,this.onDisconnect=e.onDisconnect,this.onConnect=e.onConnect,isNaN(e.wait)||(this.wait=e.wait),this._timeoutMilis=t.wait*1e3,e.onConnect!=null&&(t.connected=!0),e.onConnect(),t.listen()},disconnectSync:function(t){var n=this;n.rid=n.rid+1,this.listening=!0,n.connections=n.connections+1;var r="<body rid='"+this.rid+"' xmlns='http://jabber.org/protocol/httpbind' sid='"+this.sid+"' type='terminate'><presence xmlns='jabber:client' type='unavailable'/></body>";e.ajax({type:"POST",url:this.url,data:r,success:function(e){n.connections=n.connections-1,n.messageHandler(e),n.listening=!1,t!=null&&t(e),n.onDisconnect!=null&&(n.connected=!1),n.onDisconnect(e),n.myPresence="unavailable"},dataType:"text",async:!1})},disconnect:function(t){this.hasConn=!1;var n=this;n.rid=n.rid+1,this.listening=!0,n.connections=n.connections+1;var r="<body rid='"+this.rid+"' xmlns='http://jabber.org/protocol/httpbind' sid='"+this.sid+"' type='terminate'><presence xmlns='jabber:client' type='unavailable'/></body>";e.post(this.url,r,function(e){n.connections=n.connections-1,n.messageHandler(e),n.listening=!1,n.myPresence="unavailable",t!=null&&t(e),n.onDisconnect!=null&&(n.connected=!1),n.onDisconnect(e)},"text")},loginDigestMD5:function(t){var n=this;this.rid++;var r="<body rid='"+this.rid+"' xmlns='http://jabber.org/protocol/httpbind' sid='"+this.sid+"'><auth xmlns='urn:ietf:params:xml:ns:xmpp-sasl' mechanism='DIGEST-MD5'/></body>";e.post(this.url,r,function(r){var i=e(r),s=t.domain,o=t.username,u=/([a-z]+)=("[^"]+"|[^,"]+)(?:,|$)/,a=Base64.decode(i.text()),f=MD5.hexdigest(""+Math.random()*1234567890),l="",c=null,h="",p="",d;while(a.match(u)){d=a.match(u),a=a.replace(d[0],""),d[2]=d[2].replace(/^"(.+)"$/,"$1");switch(d[1]){case"realm":l=d[2];break;case"nonce":h=d[2];break;case"qop":p=d[2];break;case"host":c=d[2]}}var v="xmpp/"+s;c!==null&&(v=v+"/"+c);var m=MD5.hash(o+":"+l+":"+t.password)+":"+h+":"+f,g="AUTHENTICATE:"+v,y="";y+="username="+n._quote(o)+",",y+="realm="+n._quote(l)+",",y+="nonce="+n._quote(h)+",",y+="cnonce="+n._quote(f)+",",y+='nc="00000001",',y+='qop="auth",',y+="digest-uri="+n._quote(v)+",",y+="response="+n._quote(MD5.hexdigest(MD5.hexdigest(m)+":"+h+":00000001:"+f+":auth:"+MD5.hexdigest(g)))+",",y+='charset="utf-8"',n.rid++;var b="<body rid='"+n.rid+"' xmlns='http://jabber.org/protocol/httpbind' sid='"+n.sid+"'><response xmlns='urn:ietf:params:xml:ns:xmpp-sasl'>"+Base64.encode(y)+"</response></body>";e.post(this.url,b,function(r){var i=e(n.fixBody(r));if(!i.find("failure").length){n.rid++;var o="<body rid='"+n.rid+"' xmlns='http://jabber.org/protocol/httpbind' sid='"+n.sid+"'><response xmlns='urn:ietf:params:xml:ns:xmpp-sasl'/></body>";e.post(this.url,o,function(r){var i=e(n.fixBody(r));if(i.find("success").length){n.rid++;var o="<body rid='"+n.rid+"' xmlns='http://jabber.org/protocol/httpbind' sid='"+n.sid+"' to='"+s+"' xml:lang='en' xmpp:restart='true' xmlns:xmpp='urn:xmpp:xbosh'/>";e.post(this.url,o,function(r){n.rid++;var i="<body rid='"+n.rid+"' xmlns='http://jabber.org/protocol/httpbind' sid='"+n.sid+"'><iq type='set' id='_bind_auth_2' xmlns='jabber:client'><bind xmlns='urn:ietf:params:xml:ns:xmpp-bind'><resource>"+n.resource+"</resource></bind></iq></body>";e.post(this.url,i,function(r){n.rid++;var i="<body rid='"+n.rid+"' xmlns='http://jabber.org/protocol/httpbind' sid='"+n.sid+"'><iq type='set' id='_session_auth_2' xmlns='jabber:client'><session xmlns='urn:ietf:params:xml:ns:xmpp-session'/></iq></body>";e.post(this.url,i,function(e){t.onConnect!=null&&(n.connected=!0),t.onConnect(e),n.listen()},"text")},"text")},"text")}else n.onError!=null&&n.onError({error:"Invalid credentials",data:r})},"text")}else n.onError!=null&&n.onError({error:"Invalid credentials",data:r})},"text")},"text")},_quote:function(e){return'"'+e+'"'},loginPlainPHP:function(t){this.rid++;var n=t.domain,r=this,i="",s=this.url;e.post("bind.php",s,function(o){var u=e.trim(o),a="<body rid='"+r.rid+"' xmlns='http://jabber.org/protocol/httpbind' sid='"+r.sid+"'><auth xmlns='urn:ietf:params:xml:ns:xmpp-sasl' mechanism='PLAIN'>"+u+"</auth></body>";e.post(r.url,a,function(o){var u=e(r.fixBody(o));u.find("success").length?(r.rid++,i="<body rid='"+r.rid+"' xmlns='http://jabber.org/protocol/httpbind' sid='"+r.sid+"' to='"+n+"' xml:lang='en' xmpp:restart='true' xmlns:xmpp='urn:xmpp:xbosh'/>",e.post(s,i,function(n){r.rid++,i="<body rid='"+r.rid+"' xmlns='http://jabber.org/protocol/httpbind' sid='"+r.sid+"'><iq type='set' id='_bind_auth_2' xmlns='jabber:client'><bind xmlns='urn:ietf:params:xml:ns:xmpp-bind'><resource>"+r.resource+"</resource></bind></iq></body>",e.post(s,i,function(n){r.rid++,i="<body rid='"+r.rid+"' xmlns='http://jabber.org/protocol/httpbind' sid='"+r.sid+"'><iq type='set' id='_session_auth_2' xmlns='jabber:client'><session xmlns='urn:ietf:params:xml:ns:xmpp-session'/></iq></body>",e.post(s,i,function(e){t.onConnect!=null&&(r.connected=!0),t.onConnect(e),r.listen()},"text")},"text")},"text")):t.onError!=null&&t.onError({error:"Invalid credentials",data:o})},"text")},"text")},loginPlain:function(t){if(this.jid!=null&&e.trim(this.jid)!=""&&t.password!=undefined&&e.trim(t.password)!=""){this.rid++;var n=t.username,r=t.domain,i=this,s="<body rid='"+this.rid+"' xmlns='http://jabber.org/protocol/httpbind' sid='"+this.sid+"'><auth xmlns='urn:ietf:params:xml:ns:xmpp-sasl' mechanism='PLAIN'>"+t.password+"</auth></body>",o=this.url;e.post(this.url,s,function(n){var u=e(i.fixBody(n));u.find("success").length?(i.rid++,s="<body rid='"+i.rid+"' xmlns='http://jabber.org/protocol/httpbind' sid='"+i.sid+"' to='"+r+"' xml:lang='en' xmpp:restart='true' xmlns:xmpp='urn:xmpp:xbosh'/>",e.post(o,s,function(n){i.rid++,s="<body rid='"+i.rid+"' xmlns='http://jabber.org/protocol/httpbind' sid='"+i.sid+"'><iq type='set' id='_bind_auth_2' xmlns='jabber:client'><bind xmlns='urn:ietf:params:xml:ns:xmpp-bind'><resource>"+i.resource+"</resource></bind></iq></body>",e.post(o,s,function(n){i.rid++,s="<body rid='"+i.rid+"' xmlns='http://jabber.org/protocol/httpbind' sid='"+i.sid+"'><iq type='set' id='_session_auth_2' xmlns='jabber:client'><session xmlns='urn:ietf:params:xml:ns:xmpp-session'/></iq></body>",e.post(o,s,function(e){t.onConnect!=null&&(i.connected=!0),t.onConnect(e),i.listen()},"text")},"text")},"text")):t.onError!=null&&t.onError({error:"Invalid credentials",data:n})},"text")}else this.loginPlainPHP(t)},__networkError:function(){e.xmpp.onError!=null&&e.xmpp.onError({error:"Network error"}),e.xmpp.onDisconnect!=null&&e.xmpp.onDisconnect(),t.abortAll(),e.xmpp.connections=e.xmpp.connections-1,e.xmpp.listening=!1,e.xmpp.connected=!1},listen:function(){var n=this;t.length()==0&&n.sid!=null&&n.rid!=null&&this.hasConn&&(n.rid=n.rid+1,n.connections=n.connections+1,t.url(n.url).params("<body rid='"+n.rid+"' xmlns='http://jabber.org/protocol/httpbind' sid='"+n.sid+"'></body>").done(function(t,r,i,s){n.connections=n.connections-1,n.listening=!1;var o=e(n.fixBody(t));o.children().length>0&&n.messageHandler(t),n.listen()}).fail(function(e,t,r){n.__networkError(),n.onError({error:r,data:t})}).execute())},sendCommand:function(e,n){var r=this;this.rid=this.rid+1,this.listening=!0,this.connections=this.connections+1;var i="<body rid='"+this.rid+"' xmlns='http://jabber.org/protocol/httpbind' sid='"+this.sid+"'>"+e+"</body>";t.url(r.url).params(i).done(function(e){r.connections=r.connections-1,r.messageHandler(e),r.listening=!1,r.listen(),n!=null&&n(e)}).fail(function(){r.__networkError(),t.abortAll()}).execute()},sendMessage:function(e,t,n){var r=e.to,i=e.body;e.resource!=null?r=r+"/"+e.resource:this.resource!=""&&(r=r+"/"+this.resource),delete e.to,delete e.body,delete e.resource;var s="<message type='chat' to='"+r+"' xmlns='jabber:client'><body>"+i+"</body></message>";this.sendCommand(s,n)},setPresence:function(e,t){var n="<presence xmlns='jabber:client'>";e!=null&&(e.show&&e.show!=null&&e.show!="available"&&(n+="<show>"+e.show+"</show>"),e.status&&(n+="<status>"+e.status+"</status>")),n+="</presence>",e==null?this.myPresence="available":this.myPresence=e.show==null?"available":e.show,this.sendCommand(n,t)},isConnected:function(){return this.connected},getMyPresence:function(){return this.myPresence},getRoster:function(e){var t="<iq type='get'><query xmlns='jabber:iq:roster'/></iq>";this.sendCommand(t)},getDomain:function(){return this.domainJabber},addContact:function(t){if(e.trim(this.jid)!=e.trim(t.to)){var n="<iq from='"+this.jid+"/"+this.resource+"' type='set' id='set1'>";n+="<query xmlns='jabber:iq:roster'>",n+="<item jid='"+t.to+"' name='"+t.name+"'>",e.trim(t.group)!=""&&t.group!=null&&(n+="<group>"+t.group+"</group>"),n+="</item></query>",n+="</iq>",this.sendCommand(n)}},deleteContact:function(e){var t="<iq from='"+this.jid+"' id='delete' type='set'>"+"<query xmlns='jabber:iq:roster'>"+"<item jid='"+e.to+"' subscription='remove'/>"+"</query>"+"</iq>";this.sendCommand(t)},updateContact:function(e){var t="<iq from='"+this.jid+"' type='set' id='updateContact'>"+"<query xmlns='jabber:iq:roster'>"+"<item jid='"+e.jid+"' name='"+e.name+"' subscription='"+e.subscription+"'>"+"<group>"+e.group+"</group>"+"</item>"+"</query>"+"</iq>";this.sendCommand(t)},subscription:function(t){if(this.jid!=e.trim(t.to)){var n="<presence from='"+this.jid+"' to='"+t.to+"' type='"+t.type+"'></presence>";this.sendCommand(n)}},isWriting:function(e){var t="";switch(e.isWriting){case"active":t="<message type='chat' to='"+e.to+"' from='"+this.jid+"/"+this.resource+"'><active xmlns='http://jabber.org/protocol/chatstates'/></message>";break;case"inactive":t="<message type='chat' to='"+e.to+"' from='"+this.jid+"/"+this.resource+"'><inactive xmlns='http://jabber.org/protocol/chatstates'/></message>";break;case"composing":t="<message type='chat' to='"+e.to+"' from='"+this.jid+"/"+this.resource+"'><composing xmlns='http://jabber.org/protocol/chatstates'/></message>";break;case"gone":t="<message type='chat' to='"+e.to+"' from='"+this.jid+"/"+this.resource+"'><gone xmlns='http://jabber.org/protocol/chatstates'/></message>";break;case"paused":t="<message type='chat' to='"+e.to+"' from='"+this.jid+"/"+this.resource+"'><paused xmlns='http://jabber.org/protocol/chatstates'/></message>";break;case"x":t="<message type='chat' to='"+e.to+"' from='"+this.jid+"/"+this.resource+"'>",t+="<x xmlns='jabber:x:event'><offline/><composing/><delivered/><displayed/></x>",t+="</message>"}this.sendCommand(t)},getPresence:function(){var e="<presence/>",t=this;this.sendCommand(e,function(e){t.messageHandler(e,t)})},messageHandler:function(t,n){var r=this,i=e(r.fixBody(t));e.each(i.find("message"),function(t,n){try{var i=e(n),s=e(n).find("active"),o=e(n).find("composing"),u=e(n).find("inactive"),a=e(n).find("gone"),f=e(n).find("paused"),l=e(n).find("div");if(l.length>0)r.onMessage({from:i.attr("from"),to:i.attr("to"),body:l.html()});else{var c=function(e,t,n,i){r.onComposing({from:t,to:e,state:n,type:i})};s.length>0&&c(i.attr("to"),i.attr("from"),"active",i.attr("type")),o.length>0&&c(i.attr("to"),i.attr("from"),"composing",i.attr("type")),u.length>0&&c(i.attr("to"),i.attr("from"),"inactive",i.attr("type")),f.length>0&&c(i.attr("to"),i.attr("from"),"paused",i.attr("type")),a.length>0&&c(i.attr("to"),i.attr("from"),"gone",i.attr("type"))}}catch(i){}}),e.each(i.find("query").find("item"),function(t,n){try{var s=e(n);if(e.trim(s.attr("subscription"))!="remove"){var o="unavailable";i.find("iq").attr("type")=="set"&&s.attr("subscription")!="none"&&(o="available"),r.onRoster({ask:s.attr("ask"),jid:s.attr("jid"),name:s.attr("name"),subscription:s.attr("subscription"),show:o,group:e.trim(e(this).find("group").html())?e(this).find("group").html():""})}}catch(s){}}),e.each(i.find("iq"),function(t,n){try{var i=e(n);i.find("query")&&e.trim(i.find("query").attr("xmlns"))=="jabber:iq:roster"?i.find("item").each(function(){e.trim(i.attr("subscription"))!="remove"&&r.onRoster({jid:i.attr("jid"),name:i.attr("name"),subscription:i.attr("subscription"),group:e.trim(e(this).find("group").html())?e(this).find("group").html():""})}):r.onIq(i)}catch(i){}}),e.each(i.find("presence"),function(t,n){try{var i=e(n);if(i.attr("type")&&e.trim(i.attr("type"))!="unavailable")r.onRoster({jid:i.attr("from"),name:"",show:i.attr("type"),subscription:e.trim(i.attr("type"))==="subscribed"?"both":i.attr("type"),group:""}),e.trim(i.attr("type"))=="subscribe"&&r.subscription({to:i.attr("from"),type:"subscribed"}),e.trim(i.attr("type"))=="subscribed"&&r.subscription({to:i.attr("from"),type:"subscribe"});else{var s="";i.find("status").length>0&&(s=i.find("status").html(),s=s.replace(")",""),s=s.replace("(","")),r.onPresence({from:i.attr("from"),to:i.attr("to"),show:i.find("show").html()?i.find("show").html():i.attr("type")?i.attr("type"):"available",status:s})}}catch(i){}})},fixBody:function(e){return e=e.replace(/onblur/gi,"EVENT_DENY"),e=e.replace(/onchange/gi,"EVENT_DENY"),e=e.replace(/onclick/gi,"EVENT_DENY"),e=e.replace(/ondblclick/gi,"EVENT_DENY"),e=e.replace(/onerror/gi,"EVENT_DENY"),e=e.replace(/onfocus/gi,"EVENT_DENY"),e=e.replace(/onkeydown/gi,"EVENT_DENY"),e=e.replace(/onkeypress/gi,"EVENT_DENY"),e=e.replace(/onkeyup/gi,"EVENT_DENY"),e=e.replace(/onmousedown/gi,"EVENT_DENY"),e=e.replace(/onmousemove/gi,"EVENT_DENY"),e=e.replace(/onmouseout/gi,"EVENT_DENY"),e=e.replace(/onmouseover/gi,"EVENT_DENY"),e=e.replace(/onmouseup/gi,"EVENT_DENY"),e=e.replace(/onresize/gi,"EVENT_DENY"),e=e.replace(/onselect/gi,"EVENT_DENY"),e=e.replace(/onunload/gi,"EVENT_DENY"),e=e.replace(/style/gi,"EVENT_DENY"),e=e.replace(/img /gi,"IMG_DENY "),e=e.replace(/script /gi,"SCRIPT_DENY "),e=e.replace(/div /gi,"DIV_DENY "),e=e.replace(/span /gi,"SPAN_DENY "),e=e.replace(/iframe /gi,"IFRAME_DENY "),e=e.replace(/<\/body>/ig,"</div>"),e=e.replace(/<body/ig,"<div class='body'"),e},handlePing:function(e){var t=this,n=e.attr("id"),r=e.attr("from"),i=e.attr("to");t.sendCommand("<iq from='"+i+"' to='"+r+"' id='"+n+"' type='result'/>")}}}(jQuery);var Base64=function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t={encode:function(t){var n="",r,i,s,o,u,a,f,l=0;do r=t.charCodeAt(l++),i=t.charCodeAt(l++),s=t.charCodeAt(l++),o=r>>2,u=(r&3)<<4|i>>4,a=(i&15)<<2|s>>6,f=s&63,isNaN(i)?a=f=64:isNaN(s)&&(f=64),n=n+e.charAt(o)+e.charAt(u)+e.charAt(a)+e.charAt(f);while(l<t.length);return n},decode:function(t){var n="",r,i,s,o,u,a,f,l=0;t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");do o=e.indexOf(t.charAt(l++)),u=e.indexOf(t.charAt(l++)),a=e.indexOf(t.charAt(l++)),f=e.indexOf(t.charAt(l++)),r=o<<2|u>>4,i=(u&15)<<4|a>>2,s=(a&3)<<6|f,n+=String.fromCharCode(r),a!=64&&(n+=String.fromCharCode(i)),f!=64&&(n+=String.fromCharCode(s));while(l<t.length);return n}};return t}(),MD5=function(){var e=0,t="",n=8,r=function(e,t){var n=(e&65535)+(t&65535),r=(e>>16)+(t>>16)+(n>>16);return r<<16|n&65535},i=function(e,t){return e<<t|e>>>32-t},s=function(e){var t=[],r=(1<<n)-1;for(var i=0;i<e.length*n;i+=n)t[i>>5]|=(e.charCodeAt(i/n)&r)<<i%32;return t},o=function(e){var t="",r=(1<<n)-1;for(var i=0;i<e.length*32;i+=n)t+=String.fromCharCode(e[i>>5]>>>i%32&r);return t},u=function(t){var n=e?"0123456789ABCDEF":"0123456789abcdef",r="";for(var i=0;i<t.length*4;i++)r+=n.charAt(t[i>>2]>>i%4*8+4&15)+n.charAt(t[i>>2]>>i%4*8&15);return r},a=function(e){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r="",i,s;for(var o=0;o<e.length*4;o+=3){i=(e[o>>2]>>8*(o%4)&255)<<16|(e[o+1>>2]>>8*((o+1)%4)&255)<<8|e[o+2>>2]>>8*((o+2)%4)&255;for(s=0;s<4;s++)o*8+s*6>e.length*32?r+=t:r+=n.charAt(i>>6*(3-s)&63)}return r},f=function(e,t,n,s,o,u){return r(i(r(r(t,e),r(s,u)),o),n)},l=function(e,t,n,r,i,s,o){return f(t&n|~t&r,e,t,i,s,o)},c=function(e,t,n,r,i,s,o){return f(t&r|n&~r,e,t,i,s,o)},h=function(e,t,n,r,i,s,o){return f(t^n^r,e,t,i,s,o)},p=function(e,t,n,r,i,s,o){return f(n^(t|~r),e,t,i,s,o)},d=function(e,t){e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t;var n=1732584193,i=-271733879,s=-1732584194,o=271733878,u,a,f,d;for(var v=0;v<e.length;v+=16)u=n,a=i,f=s,d=o,n=l(n,i,s,o,e[v+0],7,-680876936),o=l(o,n,i,s,e[v+1],12,-389564586),s=l(s,o,n,i,e[v+2],17,606105819),i=l(i,s,o,n,e[v+3],22,-1044525330),n=l(n,i,s,o,e[v+4],7,-176418897),o=l(o,n,i,s,e[v+5],12,1200080426),s=l(s,o,n,i,e[v+6],17,-1473231341),i=l(i,s,o,n,e[v+7],22,-45705983),n=l(n,i,s,o,e[v+8],7,1770035416),o=l(o,n,i,s,e[v+9],12,-1958414417),s=l(s,o,n,i,e[v+10],17,-42063),i=l(i,s,o,n,e[v+11],22,-1990404162),n=l(n,i,s,o,e[v+12],7,1804603682),o=l(o,n,i,s,e[v+13],12,-40341101),s=l(s,o,n,i,e[v+14],17,-1502002290),i=l(i,s,o,n,e[v+15],22,1236535329),n=c(n,i,s,o,e[v+1],5,-165796510),o=c(o,n,i,s,e[v+6],9,-1069501632),s=c(s,o,n,i,e[v+11],14,643717713),i=c(i,s,o,n,e[v+0],20,-373897302),n=c(n,i,s,o,e[v+5],5,-701558691),o=c(o,n,i,s,e[v+10],9,38016083),s=c(s,o,n,i,e[v+15],14,-660478335),i=c(i,s,o,n,e[v+4],20,-405537848),n=c(n,i,s,o,e[v+9],5,568446438),o=c(o,n,i,s,e[v+14],9,-1019803690),s=c(s,o,n,i,e[v+3],14,-187363961),i=c(i,s,o,n,e[v+8],20,1163531501),n=c(n,i,s,o,e[v+13],5,-1444681467),o=c(o,n,i,s,e[v+2],9,-51403784),s=c(s,o,n,i,e[v+7],14,1735328473),i=c(i,s,o,n,e[v+12],20,-1926607734),n=h(n,i,s,o,e[v+5],4,-378558),o=h(o,n,i,s,e[v+8],11,-2022574463),s=h(s,o,n,i,e[v+11],16,1839030562),i=h(i,s,o,n,e[v+14],23,-35309556),n=h(n,i,s,o,e[v+1],4,-1530992060),o=h(o,n,i,s,e[v+4],11,1272893353),s=h(s,o,n,i,e[v+7],16,-155497632),i=h(i,s,o,n,e[v+10],23,-1094730640),n=h(n,i,s,o,e[v+13],4,681279174),o=h(o,n,i,s,e[v+0],11,-358537222),s=h(s,o,n,i,e[v+3],16,-722521979),i=h(i,s,o,n,e[v+6],23,76029189),n=h(n,i,s,o,e[v+9],4,-640364487),o=h(o,n,i,s,e[v+12],11,-421815835),s=h(s,o,n,i,e[v+15],16,530742520),i=h(i,s,o,n,e[v+2],23,-995338651),n=p(n,i,s,o,e[v+0],6,-198630844),o=p(o,n,i,s,e[v+7],10,1126891415),s=p(s,o,n,i,e[v+14],15,-1416354905),i=p(i,s,o,n,e[v+5],21,-57434055),n=p(n,i,s,o,e[v+12],6,1700485571),o=p(o,n,i,s,e[v+3],10,-1894986606),s=p(s,o,n,i,e[v+10],15,-1051523),i=p(i,s,o,n,e[v+1],21,-2054922799),n=p(n,i,s,o,e[v+8],6,1873313359),o=p(o,n,i,s,e[v+15],10,-30611744),s=p(s,o,n,i,e[v+6],15,-1560198380),i=p(i,s,o,n,e[v+13],21,1309151649),n=p(n,i,s,o,e[v+4],6,-145523070),o=p(o,n,i,s,e[v+11],10,-1120210379),s=p(s,o,n,i,e[v+2],15,718787259),i=p(i,s,o,n,e[v+9],21,-343485551),n=r(n,u),i=r(i,a),s=r(s,f),o=r(o,d);return[n,i,s,o]},v=function(e,t){var r=s(e);r.length>16&&(r=d(r,e.length*n));var i=new Array(16),o=new Array(16);for(var u=0;u<16;u++)i[u]=r[u]^909522486,o[u]=r[u]^1549556828;var a=d(i.concat(s(t)),512+t.length*n);return d(o.concat(a),640)},m={hexdigest:function(e){return u(d(s(e),e.length*n))},b64digest:function(e){return a(d(s(e),e.length*n))},hash:function(e){return o(d(s(e),e.length*n))},hmac_hexdigest:function(e,t){return u(v(e,t))},hmac_b64digest:function(e,t){return a(v(e,t))},hmac_hash:function(e,t){return o(v(e,t))},test:function(){return MD5.hexdigest("abc")==="900150983cd24fb0d6963f7d28e17f72"}};return m}();define("jquery_xmpp",function(){}),define("expressoIM",["jquery","underscore","backbone","jquery_xmpp"],function(e,t,n,r){var i=new function(){var t="",n="",r="",i="",s="",o=!1,u={},a=!1,f=[],l=[],c=[],h=[],p=[],d=[],v=[],m=[],g=[],y=[],b=[],w=[],E=0;this.resource=function(e){return e==undefined?t:(t=e,this)},this.url=function(e){return e==undefined?n:(n=e,this)},this.onMessage=function(e){v!=""&&v(e)},this.onComposing=function(e){y.length>1&&y(e)},this.clearListeners=function(){v=[],y=[],b=[],w=[],g=[],m=[]},this.executeListenersFromArray=function(e,t){for(var n in e)e[n](t)},this.addOnMessageListener=function(e){return v.push(e),this},this.addOnIqListener=function(e){return m.push(e),this},this.addOnDisconnectListener=function(e){return g.push(e),this},this.addOnPresenceListener=function(e){return b.push(e),this},this.addOnErrorListener=function(e){return w.push(e),this},this.addOnComposingListener=function(e){return y.push(e),this},this.domain=function(e){return e==undefined?r:(r=e,this)},this.username=function(e){return e==undefined?i:(i=e,this)},this.password=function(e){return e==undefined?s:(s=e,this)},this.inArray=function(e,t){for(var n=0;n<e.length;n++)if(t==e[n])return!0;return!1},this.isConnected=function(){return a},this.pushIfNotExist=function(e,t){return this.inArray(e,t)?e:(e.push(t),e)},this.getContactsByID=function(e){for(var t=0;t<p.length;t++)if(p[t].id==e)return p[t];return!1},this.getBusyContacts=function(){var e=[],t=h;for(var n=0;n<t.length;n++)e.push(this.getContactsByID(t[n]));return e},this.getAllContacts=function(){var e=[];return e.online=this.getOnlineContacts(),e.busy=this.getBusyContacts(),e.away=this.getAwayContacts(),e.offline=this.getOfflineContacts(),e},this.getAwayContacts=function(){var e=[],t=c,n=[];for(var r=0;r<t.length;r++){var i=this.getContactsByID(t[r]);n[r]=i.jid+":"+t[r]}n.sort();for(var r=0;r<n.length;r++){var s=n[r].split(":");e.push(this.getContactsByID(s[1]))}return e},this.getOfflineContacts=function(){var e=[],t=l,n=[];for(var r=0;r<t.length;r++){var i=this.getContactsByID(t[r]);n[r]=i.jid+":"+t[r]}n.sort();for(var r=0;r<n.length;r++){var s=n[r].split(":");e.push(this.getContactsByID(s[1]))}return e},this.getOnlineContacts=function(){var e=[],t=f,n=[];for(var r=0;r<t.length;r++){var i=this.getContactsByID(t[r]);n[r]=i.jid+":"+t[r]}n.sort();for(var r=0;r<n.length;r++){var s=n[r].split(":");e.push(this.getContactsByID(s[1]))}return e},this.getMessagesFromID=function(e){return u[e]},this.removeFromArray=function(e,t){var n=[];for(var r in e)e[r]!=t&&n.push(e[r]);return n},this.setContactStatus=function(e,t){f=this.removeFromArray(f,e),l=this.removeFromArray(l,e),h=this.removeFromArray(h,e),c=this.removeFromArray(c,e),t=="online"&&(f=this.pushIfNotExist(f,e)),t=="offline"&&(l=this.pushIfNotExist(l,e)),t=="away"&&(c=this.pushIfNotExist(c,e)),t=="busy"&&(h=this.pushIfNotExist(h,e))},this.addContact=function(e,t,n,r){var i={id:e,jid:t,name:n,group:r,qtdUnread:0};p.push(i),u[e]=[]},this.addMessage=function(e,t,n,r){var i={id:e,jid:t,body:n,date:r,seen:!1};return u[e].push(i),i},this.getQtdUnreadMessagesFromContact=function(e){return p[e].qtdUnread},this.setAsSeenAllMessagesFromContact=function(e){var t=0;for(var n in u[e])u[e][n].seen=!0;for(var r=0;r<p.length;r++)p[r].id==e&&(p[r].qtdUnread=0)},this.updateQtdUnreadMessagesToContact=function(e){var t=0;if(u[e]!=null)for(var n in u[e])u[e][n].seen==0&&(t+=1);for(var r=0;r<p.length;r++)p[r].id==e&&(p[r].qtdUnread=t);return t},this.debug=function(e){return e==undefined?o:(o=e,this)},this.qtdUnreadMessages=function(e){var t=0;for(var n=0;n<p.length;n++)t+=p[n].qtdUnread;return this._qtdUnreadMessages=t,t},this.sendMessage=function(t,n){if(e.trim(n)!=""){e.xmpp.sendMessage({body:n,to:t,resource:"Chat",otherAttr:"value"},"<error>An error has ocurred</error>"),t=t.match(/^[\w\W][^\/]+[^\/]/g)[0];var r=MD5.hexdigest(t),i=this.addMessage(r,"me",n,new Date);this.executeListenersFromArray(v,i)}},this.disconnect=function(){var t=function(){};e.xmpp&&e.xmpp.disconnect(t)},this.connect=function(o){var u={};if(e.xmpp){var f=this;u={resource:t,username:i,password:s,url:n,domain:r,onDisconnect:function(){a=!1,f.executeListenersFromArray(g,[])},onConnect:function(t){a=!0,e.xmpp.getRoster(),e.xmpp.setPresence(null),o!=null&&o()},onIq:function(e){},onMessage:function(e){e.from=e.from.match(/^[\w\W][^\/]+[^\/]/g)[0];var t=e.from.split("/"),n=MD5.hexdigest(e.from),r=f.addMessage(n,t[0],e.body,new Date);f.updateQtdUnreadMessagesToContact(n),f.executeListenersFromArray(v,r)},onPresence:function(e){e.from=e.from.match(/^[\w\W][^\/]+[^\/]/g)[0];var t=MD5.hexdigest(e.from),n=e.show!=="available"?e.show==="unavailable"?"offline":e.show==="dnd"?"busy":e.show==="away"?"away":"online":"online",e={id:t,status:n};f.setContactStatus(t,n),f.executeListenersFromArray(b,e)},onError:function(t){a=!1,e.xmpp.listening=!1,e.xmpp.connected=!1,f.executeListenersFromArray(w,t)},onComposing:function(e){e.from=e.from.match(/^[\w\W][^\/]+[^\/]/g)[0];var t=e.from.split("/");e.from=t[0],f.executeListenersFromArray(y,e)},onRoster:function(e){var t=e.jid;t=t.match(/^[\w\W][^\/]+[^\/]/g)[0];var n=MD5.hexdigest(t);f.addContact(n,e.jid,e.name,e.group),f.setContactStatus(n,"offline")}},e.xmpp.connect(u)}}};return i}),function(){var e=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],t=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,n=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,r=typeof location!="undefined"&&location.href,i=r&&location.protocol&&location.protocol.replace(/\:/,""),s=r&&location.hostname,o=r&&(location.port||void 0),u=[];define("text",[],function(){var a,f,l;return typeof window!="undefined"&&window.navigator&&window.document?f=function(e,t){var n=a.createXhr();n.open("GET",e,!0),n.onreadystatechange=function(){n.readyState===4&&t(n.responseText)},n.send(null)}:typeof process!="undefined"&&process.versions&&process.versions.node?(l=require.nodeRequire("fs"),f=function(e,t){t(l.readFileSync(e,"utf8"))}):typeof Packages!="undefined"&&(f=function(e,t){var n=new java.io.File(e),r=java.lang.System.getProperty("line.separator"),n=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(n),"utf-8")),i,s,o="";try{i=new java.lang.StringBuffer,(s=n.readLine())&&s.length()&&s.charAt(0)===65279&&(s=s.substring(1));for(i.append(s);(s=n.readLine())!==null;)i.append(r),i.append(s);o=String(i.toString())}finally{n.close()}t(o)}),a={version:"0.27.0",strip:function(e){if(e){var e=e.replace(t,""),r=e.match(n);r&&(e=r[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")},createXhr:function(){var t,n,r;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;for(n=0;n<3;n++){r=e[n];try{t=new ActiveXObject(r)}catch(i){}if(t){e=[r];break}}if(!t)throw Error("createXhr(): XMLHttpRequest not available");return t},get:f,parseName:function(e){var t=!1,n=e.indexOf("."),r=e.substring(0,n),e=e.substring(n+1,e.length),n=e.indexOf("!");return n!==-1&&(t=e.substring(n+1,e.length),t=t==="strip",e=e.substring(0,n)),{moduleName:r,ext:e,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,n,r){var i=a.xdRegExp.exec(e),s;return i?(e=i[2],i=i[3],i=i.split(":"),s=i[1],i=i[0],(!e||e===t)&&(!i||i===n)&&(!s&&!i||s===r)):!0},finishLoad:function(e,t,n,r,i){n=t?a.strip(n):n,i.isBuild&&i.inlineText&&(u[e]=n),r(n)},load:function(e,t,n,u){var f=a.parseName(e),l=f.moduleName+"."+f.ext,c=t.toUrl(l),h=u&&u.text&&u.text.useXhr||a.useXhr;!r||h(c,i,s,o)?a.get(c,function(t){a.finishLoad(e,f.strip,t,n,u)}):t([l],function(e){a.finishLoad(f.moduleName+"."+f.ext,f.strip,e,n,u)})},write:function(e,t,n){if(t in u){var r=a.jsEscape(u[t]);n.asModule(e+"!"+t,"define(function () { return '"+r+"';});\n")}},writeFile:function(e,t,n,r,i){var t=a.parseName(t),s=t.moduleName+"."+t.ext,o=n.toUrl(t.moduleName+"."+t.ext)+".js";a.load(s,n,function(){var t=function(e){return r(o,e)};t.asModule=function(e,t){return r.asModule(e,o,t)},a.write(e,s,t,i)},i)}}})}(),define("text!templates/home/userMessageTemplate.html",[],function(){return'<% if (route != "") { %>\n<a href="<%=route%>" class="routeMessage" style="text-decoration: none;">\n<% } %>\n	<div class="<%=type%> message">\n		<% if (icon != "") { %>\n			<div class="message-icon <%=icon%>"></div>\n		<% } %>\n		<% if (description != \'\') { %>\n			<h3><%=title%></h3>\n			<p><%=description%></p>\n		<% } else { %>\n			<h4><%=title%></h4>\n		<% } %>\n	</div>\n<% if (route != "") { %>\n	</a>\n<% } %>'}),define("views/home/UserMessageView",["jquery","underscore","backbone","text!templates/home/userMessageTemplate.html"],function(e,t,n,r){var i=n.View.extend({msgType:"",msgTitle:"",msgDescription:"",msgRoute:"",msgIcon:"",elementID:"",animate:!0,timeout:3e3,render:function(){this.timeout==undefined&&(this.timeout=3e3),this.msgRoute==undefined&&(this.msgRoute="");var n={_:t,type:this.msgType,title:this.msgTitle,description:this.msgDescription,icon:this.msgIcon,route:this.msgRoute},i=t.template(r,n);this.$el.html(i),e(this.elementID).empty().append(this.$el);if(this.animate){e(this.elementID).attr("style","position: absolute; top: -"+e(this.elementID).outerHeight()+"px; width: 100%;");var s=e("#mainAppPageContent").css("margin-top");s=s.split("px"),e(this.elementID).animate({top:parseInt(s[0],0)*-1},500)}else e(this.elementID).attr("style","top: 0px");var o=this;o.timeout>0&&setTimeout(function(){e(o.elementID).empty()},o.timeout)},events:{"click .routeMessage":"clickMessage"},clickMessage:function(t){t.preventDefault();var r=new n.Router;r.navigate(t.currentTarget.getAttribute("href"),{trigger:!0}),e(this.elementID).empty()}});return i}),define("expressoService",["jquery","underscore","backbone"],function(e,t,n){var r=new function(){var e;this.startService=function(){var e=this;this.service!=undefined?this.service.startService(function(t){e.handleSuccess(t)},function(t){e.handleError(t)}):console.log("SERVICE - UNDEFINED")},this.stopService=function(){var e=this;this.service!=undefined?this.service.stopService(function(t){e.handleSuccess(t)},function(t){e.handleError(t)}):console.log("SERVICE - UNDEFINED")},this.enableTimer=function(){var e=this;this.service!=undefined?this.service.enableTimer(12e4,function(t){e.handleSuccess(t)},function(t){e.handleError(t)}):console.log("SERVICE - UNDEFINED")},this.disableTimer=function(){var e=this;this.service!=undefined?this.service.disableTimer(function(t){e.handleSuccess(t)},function(t){e.handleError(t)}):console.log("SERVICE - UNDEFINED")},this.registerForBootStart=function(){var e=this;this.service!=undefined?this.service.registerForBootStart(function(t){e.handleSuccess(t)},function(t){e.handleError(t)}):console.log("SERVICE - UNDEFINED")},this.deregisterForBootStart=function(){var e=this;this.service!=undefined?this.service.deregisterForBootStart(function(t){e.handleSuccess(t)},function(t){e.handleError(t)}):console.log("SERVICE - UNDEFINED")},this.registerForUpdates=function(){var e=this;this.service!=undefined?this.service.registerForUpdates(function(t){e.handleSuccess(t)},function(t){e.handleError(t)}):console.log("SERVICE - UNDEFINED")},this.deregisterForUpdates=function(){var e=this;this.service!=undefined?this.service.deregisterForUpdates(function(t){e.handleSuccess(t)},function(t){e.handleError(t)}):console.log("SERVICE - UNDEFINED")},this.handleSuccess=function(e){},this.handleError=function(e){},this.setConfig=function(e,t,n,r){var i=this,s={auth:t,apiURL:e,username:n,password:r};this.service!=undefined&&this.service.setConfiguration(s,function(e){i.handleSuccess(e)},function(e){i.handleError(e)})}};return r}),define("shared",["underscore","jquery","backbone","expressoAPI","expressoIM","views/home/UserMessageView","expressoService"],function(e,t,n,r,i,s,o){var u={};return u.betaVersion=!1,u.betaTesters=[],u.versionIsActive=!0,u.betaVersion?u.appVersion="BETA":u.appVersion="1.2",u.apiVersion="",u.expressoVersion="",u.context="/api/",u.ComunityServerURL="http://api.expressolivre.org/",u.settings={},u.settings.resultsPerPage=25,u.settings.mailSignature="Mensagem enviada pelo Expresso Mobile.",u.timeoutDelay=500,u.scrollDetail=null,u.scroll=null,u.scrollMenu=null,u.lastCheckDate=null,u.forceSmartPhoneResolution=!1,u.forceLogout=!1,u.im=i,u.api=r,u.service=o,u.contentView=null,u.detailView=null,u.gotoRoute=!1,u.newMessageIntent=!1,u.newMessageFiles=!1,u.max_upload_file_size=10240,u.max_upload_file_qtd=20,u.currentDraftMessage="",u.automaticLoginAccounts={accounts:[]},u.forceAutomaticLoginInAccountName=!1,u.disabledModules=[],u.menuOpen=!1,u.isBuiltInExpresso=function(){return!1},u.isTabletResolution=function(){var e=t(window).width()>=720;return u.forceSmartPhoneResolution&&(e=!1),e},u.isSmartPhoneResolution=function(){return!u.isTabletResolution()},u.isDesktop=function(){var e=!0;if(u.isPhonegap()||u.isAndroid()||u.isIDevice())e=!1;return e},u.isPhonegap=function(){return u.api.phoneGap()},u.isAndroid=function(){return/android/gi.test(navigator.appVersion)},u.isIDevice=function(){return/iphone|ipad/gi.test(navigator.appVersion)},u.scrollerRefresh=function(){u.scrollDetail&&u.scrollDetail.refresh(),u.scroll&&u.scroll.refresh(),u.scrollMenu&&u.scrollMenu.refresh()},u.bytesToSize=function(e,t){var n=1024,r=n*1024,i=r*1024,s=i*1024;return e>=0&&e<n?e+" B":e>=n&&e<r?(e/n).toFixed(t)+" KB":e>=r&&e<i?(e/r).toFixed(t)+" MB":e>=i&&e<s?(e/i).toFixed(t)+" GB":e>=s?(e/s).toFixed(t)+" TB":e+" B"},u.setCurrentView=function(e,t){e==1?(u.contentView!=null&&u.contentView.undelegateEvents(),u.contentView=t):u.isSmartPhoneResolution()?(u.contentView!=null&&u.contentView.undelegateEvents(),u.contentView=t):(u.detailView!=null&&u.detailView.undelegateEvents(),u.detailView=t)},u.refreshSettings=function(){u.api.resource("ExpressoVersion").params({}).done(function(e){u.apiVersion=e.apiVersion,u.expressoVersion=e.expressoVersion,u.apiVersion!="1.0"&&u.api.resource("Preferences/UserPreferences").params({module:"mail"}).done(function(e){var t=25,n="Mensagem enviada pelo Expresso Mobile.",r="html";e.mail!=undefined&&(t=e.mail.max_email_per_page,n=e.mail.signature,r=e.mail.type_signature),u.settings.resultsPerPage=t,u.settings.mailSignature=n,u.settings.typeSignature=r,u.saveSettingsToLocalStorage()}).fail(function(e){}).execute()}).fail(function(e){}).execute()},u.showMessage=function(e){var t=new s;t.msgType=e.type,t.msgTitle=e.title,t.msgDescription=e.description,t.elementID=e.elementID,t.msgRoute=e.route,t.msgIcon=e.icon,t.timeout=e.timeout,e.animate==0&&(t.animate=!1),t.render()},u.deviceType=function(e){e?t("body").addClass("smartphone"):t("body").removeAttr("class")},u.saveSettingsToLocalStorage=function(){u.api.getLocalStorageValue("expresso",function(e){if(e==undefined)var e={};e.settings=u.settings,u.api.setLocalStorageValue("expresso",e)})},u.handleErrors=function(e,t){e.code==100&&(t!=undefined,u.showMessage({type:"error",icon:"icon-expresso",title:"Verifique sua conexão com a Internet...",description:"",timeout:3e3,elementID:"#pageMessage"}));if(e.code==7||e.code==3){var n={auth:"",profile:"",username:"",password:"",phoneGap:"",serverAPI:"",settings:{resultsPerPage:30,automaticLogin:!1,mailSignature:""}};u.api.setLocalStorageValue("expresso",n),u.showMessage({type:"error",icon:"icon-expresso",title:"Sua sessão expirou...",description:"",timeout:0,elementID:"#pageMessage"}),setTimeout(function(){u.router.navigate("Login",{trigger:!0})},2e3)}},u.scheduleCheckForNewMessages=function(){u.checkForNewMessages(),setInterval(u.checkForNewMessages,7e4),setInterval(u.refreshFolders,18e4)},u.refreshFolders=function(){u.userHasModule("mail")&&u.menuView.refreshFolders()},u.checkForNewMessages=function(){u.userHasModule("mail")&&u.api.resource("/Mail/Messages").params({folderID:"INBOX",search:"",page:1,resultsPerPage:"25",msgID:""}).ignoreCache(!0).done(function(t){var n=0,r="",i=[];e.each(t.messages,function(e){var t=moment(e.msgDate+":59","DD/MM/YYYY HH:mm:ss").unix();u.lastCheckDate!=null&&t>u.lastCheckDate/1e3&&(n+=1,r=e,i.push(e))});if(n>0){var s="",o="",a="";n==1?(s="/Mail/Messages/1/"+r.msgID+"/INBOX",o=r.msgSubject,a=r.msgFrom.mailAddress):(s="/Mail/Messages/1/0/INBOX",o="Você tem "+n+" novas mensagens.",a=""),u.showMessage({type:"chat-message",icon:"icon-expresso",title:o,description:a,route:s,timeout:5e3,elementID:"#pageMessage"}),u.menuView.setMailBadge(n)}u.lastCheckDate=Date.now()}).fail(function(e){}).execute()},u.windowTitle="Expresso",u.BlinkWindowTitle=function(e){u.isDesktop()&&(u.stopBlinkWindowTitle(),u.blinkTitleInterval=window.setInterval(function(){var e="",n=0;u.userHasModule("chat")&&(n=u.im.qtdUnreadMessages());var r=0;u.userHasModule("mail")&&(r=t("#badge_inbox").html(),r!=undefined&&r.trim()==""&&(r=0));var i=n+r,s="";if(r!=0)var s=r+" Emails";r==1&&(s=r+" Email");var o="";n!=0&&(o=n+" Msgs"),n==1&&(o=n+" Msg"),s!=""&&(e=s),o!=""&&(s!=""?e=s+" - "+o:e=o),i==0&&(e=u.windowTitle),document.title=document.title===u.windowTitle?e:u.windowTitle},1e3))},u.stopBlinkWindowTitle=function(){window.clearInterval(u.blinkTitleInterval),document.title=u.windowTitle},u.setDefaultIMListeners=function(){u.im.clearListeners();var e=function(e){u.menuView.setChatBadge(u.im.qtdUnreadMessages());var e={type:"chat-message",icon:"icon-jabber",title:e.body,description:e.jid,route:"/Chat/"+e.id,timeout:3e3,elementID:"#pageMessage"},t=u.im.qtdUnreadMessages();u.showMessage(e)},t=function(e){};u.im.addOnMessageListener(e),u.im.addOnErrorListener(u.onIMErrorFunction),u.im.addOnDisconnectListener(u.onIMDisconnectFunction)},u.onIMErrorFunction=function(e){var t={type:"error",icon:"icon-jabber",title:"Você não está conectado ao CHAT.",description:"Verifique sua conexão com a Internet...",route:"/Chat",elementID:"#pageMessage"};u.showMessage(t)},u.onIMDisconnectFunction=function(e){},u.chatReconnect=function(){u.lastReconectionTime=new Date,u.api.resource("Services/Chat").params({}).done(function(e){u.im=i,u.im_resource=e.A,u.im_url=e.B,u.im_domain=e.C;var t=e.D,n=e.E+"==";u.im.resource("EXPRESSO_MOBILE").url(u.im_url).domain(u.im_domain);var r=function(){u.router.navigate("Chat",{trigger:!0})};u.im.username(t).password(n).connect(r)}).execute()},u.api.id(0),u.api.debug(!1),u.userHasModule=function(e){var t=!1,n=e;if(u.profile!=undefined){var r=u.profile.contactApps;r==undefined&&(r=[]),r.push("settings"),u.profile.contactServices!=undefined&&u.profile.contactServices.chat!=undefined&&r.push("chat");for(var i=0;i<r.length;i++)r[i]===e&&(t=!0);u.apiVersion=="1.0"&&(n=="calendar"||n=="chat")&&(t=!1);for(var i=0;i<u.disabledModules.length;i++)n==u.disabledModules[i]&&(t=!1)}else e=="settings"&&(t=!0);return t},u.userHasAuth=function(){u.api.getLocalStorageValue("expresso",function(e){var t=e.auth;if(t!=null&&t!=""){var n=e.profile;u.profile=n,u.api.auth(t),u.isAndroid()&&u.service.setConfig("http://api.expresso.pr.gov.br/",t)}})},u.userHasAuth(),document.addEventListener("touchmove",function(e){e.preventDefault()},!1),u.deviceReady=function(){u.api.phoneGap(!0),u.api.android(u.isAndroid());if(u.isAndroid()){document.addEventListener("backbutton",function(e){var n=["file:///Mail/Messages/1/0/INBOX#","file:///Mail/Messages/1/0/INBOX","file:///Mail/Messages/0/0/INBOX","file:///Home","file:///Login"];t.inArray(window.location.href,n)>=0?(e.preventDefault(),navigator.app.exitApp()):(e.preventDefault(),window.history.back())},!1);var e="com.celepar.expresso.ExpressoService",n=cordova.require("com.phonegap.plugins.backgroundservice.BackgroundService");u.service.service=n.create(e),window.plugins={},window.plugins.webintent=cordova.require("com.phonegap.plugins.webintent.WebIntent"),window.plugins.expresso=cordova.require("com.phonegap.plugins.expresso.ExpressoPlugin"),u.api.createPhoneGapDatabase(),window.plugins!=undefined&&(window.plugins.expresso!=undefined&&window.plugins.expresso.getAccounts("",function(e){u.automaticLoginAccounts=JSON.parse(e);var t=u.automaticLoginAccounts;if(u.automaticLoginAccounts.accounts.length>=1){if(u.forceAutomaticLoginInAccountName==0||u.automaticLoginAccounts.accounts.length==1)u.forceAutomaticLoginInAccountName=t.accounts[0].accountName;for(var n=0;n<t.accounts.length;n++)if(t.accounts[n]!=undefined&&u.forceAutomaticLoginInAccountName==t.accounts[n].accountName){var r=t.accounts[n];u.service.setConfig(r.accountAPIURL,u.api.auth(),r.accountName,r.accountPassword),u.service.startService(),setTimeout(function(){u.service.setConfig(r.accountAPIURL,u.api.auth(),r.accountName,r.accountPassword),u.service.enableTimer()},1e4)}}},function(){}),window.plugins.webintent!=undefined&&(window.plugins.webintent.hasExtra("android.intent.extra.STREAM",function(e){window.plugins.webintent.getExtra("android.intent.extra.STREAM",function(e){var t=[];e.indexOf("[")!=-1?(e=e.replace("[","").replace("]",""),t=e.split(",")):t.push(e);for(var n=0;n<t.length;n++)t[n]=decodeURI(t[n].replace("file://","").trim());u.newMessageIntent=!0,u.newMessageFiles=t},function(e){})},function(e){}),window.plugins.webintent.onNewIntent(function(e){e!=null&&u.router.navigate(e,{trigger:!0})}),window.plugins.webintent.hasExtra("ROUTE",function(e){window.plugins.webintent.getExtra("ROUTE",function(e){u.isTabletResolution()?e=e.replace("{:TABLET}","1"):e=e.replace("{:TABLET}","0"),u.gotoRoute=e},function(e){})},function(e){})))}},document.addEventListener("deviceready",function(){u.deviceReady()}),u}),!function(e){function t(e,t){return function(n){return a(e.call(this,n),t)}}function n(e,t){return function(n){return this.lang().ordinal(e.call(this,n),t)}}function r(){}function i(e){o(this,e)}function s(e){var t=e.years||e.year||e.y||0,n=e.months||e.month||e.M||0,r=e.weeks||e.week||e.w||0,i=e.days||e.day||e.d||0,s=e.hours||e.hour||e.h||0,o=e.minutes||e.minute||e.m||0,u=e.seconds||e.second||e.s||0,a=e.milliseconds||e.millisecond||e.ms||0;this._input=e,this._milliseconds=a+1e3*u+6e4*o+36e5*s,this._days=i+7*r,this._months=n+12*t,this._data={},this._bubble()}function o(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function u(e){return 0>e?Math.ceil(e):Math.floor(e)}function a(e,t){for(var n=e+"";n.length<t;)n="0"+n;return n}function f(e,t,n,r){var i,s,o=t._milliseconds,u=t._days,a=t._months;o&&e._d.setTime(+e._d+o*n),(u||a)&&(i=e.minute(),s=e.hour()),u&&e.date(e.date()+u*n),a&&e.month(e.month()+a*n),o&&!r&&D.updateOffset(e),(u||a)&&(e.minute(i),e.hour(s))}function l(e){return"[object Array]"===Object.prototype.toString.call(e)}function c(e,t){var n,r=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),s=0;for(n=0;r>n;n++)~~e[n]!==~~t[n]&&s++;return s+i}function h(e){return e?it[e]||e.toLowerCase().replace(/(.)s$/,"$1"):e}function p(e,t){return t.abbr=e,j[e]||(j[e]=new r),j[e].set(t),j[e]}function d(e){if(!e)return D.fn._lang;if(!j[e]&&F)try{require("./lang/"+e)}catch(t){return D.fn._lang}return j[e]}function v(e){return e.match(/\[.*\]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function m(e){var t,n,r=e.match(R);for(t=0,n=r.length;n>t;t++)r[t]=at[r[t]]?at[r[t]]:v(r[t]);return function(i){var s="";for(t=0;n>t;t++)s+=r[t]instanceof Function?r[t].call(i,e):r[t];return s}}function g(e,t){function n(t){return e.lang().longDateFormat(t)||t}for(var r=5;r--&&U.test(t);)t=t.replace(U,n);return st[t]||(st[t]=m(t)),st[t](e)}function y(e,t){switch(e){case"DDDD":return X;case"YYYY":return V;case"YYYYY":return $;case"S":case"SS":case"SSS":case"DDD":return W;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return J;case"a":case"A":return d(t._l)._meridiemParse;case"X":return G;case"Z":case"ZZ":return K;case"T":return Q;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return z;default:return new RegExp(e.replace("\\",""))}}function b(e){var t=(K.exec(e)||[])[0],n=(t+"").match(tt)||["-",0,0],r=+(60*n[1])+~~n[2];return"+"===n[0]?-r:r}function w(e,t,n){var r,i=n._a;switch(e){case"M":case"MM":i[1]=null==t?0:~~t-1;break;case"MMM":case"MMMM":r=d(n._l).monthsParse(t),null!=r?i[1]=r:n._isValid=!1;break;case"D":case"DD":case"DDD":case"DDDD":null!=t&&(i[2]=~~t);break;case"YY":i[0]=~~t+(~~t>68?1900:2e3);break;case"YYYY":case"YYYYY":i[0]=~~t;break;case"a":case"A":n._isPm=d(n._l).isPM(t);break;case"H":case"HH":case"h":case"hh":i[3]=~~t;break;case"m":case"mm":i[4]=~~t;break;case"s":case"ss":i[5]=~~t;break;case"S":case"SS":case"SSS":i[6]=~~(1e3*("0."+t));break;case"X":n._d=new Date(1e3*parseFloat(t));break;case"Z":case"ZZ":n._useUTC=!0,n._tzm=b(t)}null==t&&(n._isValid=!1)}function E(e){var t,n,r=[];if(!e._d){for(t=0;7>t;t++)e._a[t]=r[t]=null==e._a[t]?2===t?1:0:e._a[t];r[3]+=~~((e._tzm||0)/60),r[4]+=~~((e._tzm||0)%60),n=new Date(0),e._useUTC?(n.setUTCFullYear(r[0],r[1],r[2]),n.setUTCHours(r[3],r[4],r[5],r[6])):(n.setFullYear(r[0],r[1],r[2]),n.setHours(r[3],r[4],r[5],r[6])),e._d=n}}function S(e){var t,n,r=e._f.match(R),i=e._i;for(e._a=[],t=0;t<r.length;t++)n=(y(r[t],e).exec(i)||[])[0],n&&(i=i.slice(i.indexOf(n)+n.length)),at[r[t]]&&w(r[t],n,e);i&&(e._il=i),e._isPm&&e._a[3]<12&&(e._a[3]+=12),e._isPm===!1&&12===e._a[3]&&(e._a[3]=0),E(e)}function x(e){var t,n,r,s,u,a=99;for(s=0;s<e._f.length;s++)t=o({},e),t._f=e._f[s],S(t),n=new i(t),u=c(t._a,n.toArray()),n._il&&(u+=n._il.length),a>u&&(a=u,r=n);o(e,r)}function T(e){var t,n=e._i,r=Y.exec(n);if(r){for(e._f="YYYY-MM-DD"+(r[2]||" "),t=0;4>t;t++)if(et[t][1].exec(n)){e._f+=et[t][0];break}K.exec(n)&&(e._f+=" Z"),S(e)}else e._d=new Date(n)}function N(t){var n=t._i,r=I.exec(n);n===e?t._d=new Date:r?t._d=new Date(+r[1]):"string"==typeof n?T(t):l(n)?(t._a=n.slice(0),E(t)):t._d=n instanceof Date?new Date(+n):new Date(n)}function C(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}function k(e,t,n){var r=B(Math.abs(e)/1e3),i=B(r/60),s=B(i/60),o=B(s/24),u=B(o/365),a=45>r&&["s",r]||1===i&&["m"]||45>i&&["mm",i]||1===s&&["h"]||22>s&&["hh",s]||1===o&&["d"]||25>=o&&["dd",o]||45>=o&&["M"]||345>o&&["MM",B(o/30)]||1===u&&["y"]||["yy",u];return a[2]=t,a[3]=e>0,a[4]=n,C.apply({},a)}function L(e,t,n){var r,i=n-t,s=n-e.day();return s>i&&(s-=7),i-7>s&&(s+=7),r=D(e).add("d",s),{week:Math.ceil(r.dayOfYear()/7),year:r.year()}}function A(e){var t=e._i,n=e._f;return null===t||""===t?null:("string"==typeof t&&(e._i=t=d().preparse(t)),D.isMoment(t)?(e=o({},t),e._d=new Date(+t._d)):n?l(n)?x(e):S(e):N(e),new i(e))}function O(e,t){D.fn[e]=D.fn[e+"s"]=function(e){var n=this._isUTC?"UTC":"";return null!=e?(this._d["set"+n+t](e),D.updateOffset(this),this):this._d["get"+n+t]()}}function M(e){D.duration.fn[e]=function(){return this._data[e]}}function _(e,t){D.duration.fn["as"+e]=function(){return+this/t}}for(var D,P,H="2.1.0",B=Math.round,j={},F="undefined"!=typeof module&&module.exports,I=/^\/?Date\((\-?\d+)/i,q=/(\-)?(\d*)?\.?(\d+)\:(\d+)\:(\d+)\.?(\d{3})?/,R=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|SS?S?|X|zz?|ZZ?|.)/g,U=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,z=/\d\d?/,W=/\d{1,3}/,X=/\d{3}/,V=/\d{1,4}/,$=/[+\-]?\d{1,6}/,J=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,K=/Z|[\+\-]\d\d:?\d\d/i,Q=/T/i,G=/[\+\-]?\d+(\.\d{1,3})?/,Y=/^\s*\d{4}-\d\d-\d\d((T| )(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,Z="YYYY-MM-DDTHH:mm:ssZ",et=[["HH:mm:ss.S",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],tt=/([\+\-]|\d\d)/gi,nt="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),rt={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},it={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",w:"week",M:"month",y:"year"},st={},ot="DDD w W M D d".split(" "),ut="M D H h m s w W".split(" "),at={M:function(){return this.month()+1},MMM:function(e){return this.lang().monthsShort(this,e)},MMMM:function(e){return this.lang().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.lang().weekdaysMin(this,e)},ddd:function(e){return this.lang().weekdaysShort(this,e)},dddd:function(e){return this.lang().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return a(this.year()%100,2)},YYYY:function(){return a(this.year(),4)},YYYYY:function(){return a(this.year(),5)},gg:function(){return a(this.weekYear()%100,2)},gggg:function(){return this.weekYear()},ggggg:function(){return a(this.weekYear(),5)},GG:function(){return a(this.isoWeekYear()%100,2)},GGGG:function(){return this.isoWeekYear()},GGGGG:function(){return a(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return~~(this.milliseconds()/100)},SS:function(){return a(~~(this.milliseconds()/10),2)},SSS:function(){return a(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+a(~~(e/60),2)+":"+a(~~e%60,2)},ZZ:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+a(~~(10*e/6),4)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()}};ot.length;)P=ot.pop(),at[P+"o"]=n(at[P],P);for(;ut.length;)P=ut.pop(),at[P+P]=t(at[P],2);for(at.DDDD=t(at.DDD,3),r.prototype={set:function(e){var t,n;for(n in e)t=e[n],"function"==typeof t?this[n]=t:this["_"+n]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var t,n,r;for(this._monthsParse||(this._monthsParse=[]),t=0;12>t;t++)if(this._monthsParse[t]||(n=D([2e3,t]),r="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[t]=new RegExp(r.replace(".",""),"i")),this._monthsParse[t].test(e))return t},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},weekdaysParse:function(e){var t,n,r;for(this._weekdaysParse||(this._weekdaysParse=[]),t=0;7>t;t++)if(this._weekdaysParse[t]||(n=D([2e3,1]).day(t),r="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[t]=new RegExp(r.replace(".",""),"i")),this._weekdaysParse[t].test(e))return t},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},isPM:function(e){return"p"===(e+"").toLowerCase()[0]},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){var n=this._calendar[e];return"function"==typeof n?n.apply(t):n},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,n,r){var i=this._relativeTime[n];return"function"==typeof i?i(e,t,n,r):i.replace(/%d/i,e)},pastFuture:function(e,t){var n=this._relativeTime[e>0?"future":"past"];return"function"==typeof n?n(t):n.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return L(e,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6}},D=function(e,t,n){return A({_i:e,_f:t,_l:n,_isUTC:!1})},D.utc=function(e,t,n){return A({_useUTC:!0,_isUTC:!0,_l:n,_i:e,_f:t})},D.unix=function(e){return D(1e3*e)},D.duration=function(e,t){var n,r,i=D.isDuration(e),o="number"==typeof e,u=i?e._input:o?{}:e,a=q.exec(e);return o?t?u[t]=e:u.milliseconds=e:a&&(n="-"===a[1]?-1:1,u={y:0,d:~~a[2]*n,h:~~a[3]*n,m:~~a[4]*n,s:~~a[5]*n,ms:~~a[6]*n}),r=new s(u),i&&e.hasOwnProperty("_lang")&&(r._lang=e._lang),r},D.version=H,D.defaultFormat=Z,D.updateOffset=function(){},D.lang=function(e,t){return e?(t?p(e,t):j[e]||d(e),D.duration.fn._lang=D.fn._lang=d(e),void 0):D.fn._lang._abbr},D.langData=function(e){return e&&e._lang&&e._lang._abbr&&(e=e._lang._abbr),d(e)},D.isMoment=function(e){return e instanceof i},D.isDuration=function(e){return e instanceof s},D.fn=i.prototype={clone:function(){return D(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){return g(D(this).utc(),"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return null==this._isValid&&(this._isValid=this._a?!c(this._a,(this._isUTC?D.utc(this._a):D(this._a)).toArray()):!isNaN(this._d.getTime())),!!this._isValid},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(e){var t=g(this,e||D.defaultFormat);return this.lang().postformat(t)},add:function(e,t){var n;return n="string"==typeof e?D.duration(+t,e):D.duration(e,t),f(this,n,1),this},subtract:function(e,t){var n;return n="string"==typeof e?D.duration(+t,e):D.duration(e,t),f(this,n,-1),this},diff:function(e,t,n){var r,i,s=this._isUTC?D(e).zone(this._offset||0):D(e).local(),o=6e4*(this.zone()-s.zone());return t=h(t),"year"===t||"month"===t?(r=432e5*(this.daysInMonth()+s.daysInMonth()),i=12*(this.year()-s.year())+(this.month()-s.month()),i+=(this-D(this).startOf("month")-(s-D(s).startOf("month")))/r,i-=6e4*(this.zone()-D(this).startOf("month").zone()-(s.zone()-D(s).startOf("month").zone()))/r,"year"===t&&(i/=12)):(r=this-s,i="second"===t?r/1e3:"minute"===t?r/6e4:"hour"===t?r/36e5:"day"===t?(r-o)/864e5:"week"===t?(r-o)/6048e5:r),n?i:u(i)},from:function(e,t){return D.duration(this.diff(e)).lang(this.lang()._abbr).humanize(!t)},fromNow:function(e){return this.from(D(),e)},calendar:function(){var e=this.diff(D().startOf("day"),"days",!0),t=-6>e?"sameElse":-1>e?"lastWeek":0>e?"lastDay":1>e?"sameDay":2>e?"nextDay":7>e?"nextWeek":"sameElse";return this.format(this.lang().calendar(t,this))},isLeapYear:function(){var e=this.year();return 0===e%4&&0!==e%100||0===e%400},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?"string"==typeof e&&(e=this.lang().weekdaysParse(e),"number"!=typeof e)?this:this.add({d:e-t}):t},month:function(e){var t,n=this._isUTC?"UTC":"";return null!=e?"string"==typeof e&&(e=this.lang().monthsParse(e),"number"!=typeof e)?this:(t=this.date(),this.date(1),this._d["set"+n+"Month"](e),this.date(Math.min(t,this.daysInMonth())),D.updateOffset(this),this):this._d["get"+n+"Month"]()},startOf:function(e){switch(e=h(e)){case"year":this.month(0);case"month":this.date(1);case"week":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),this},endOf:function(e){return this.startOf(e).add(e,1).subtract("ms",1)},isAfter:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)>+D(e).startOf(t)},isBefore:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)<+D(e).startOf(t)},isSame:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)===+D(e).startOf(t)},min:function(e){return e=D.apply(null,arguments),this>e?this:e},max:function(e){return e=D.apply(null,arguments),e>this?this:e},zone:function(e){var t=this._offset||0;return null==e?this._isUTC?t:this._d.getTimezoneOffset():("string"==typeof e&&(e=b(e)),Math.abs(e)<16&&(e=60*e),this._offset=e,this._isUTC=!0,t!==e&&f(this,D.duration(t-e,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},daysInMonth:function(){return D.utc([this.year(),this.month()+1,0]).date()},dayOfYear:function(e){var t=B((D(this).startOf("day")-D(this).startOf("year"))/864e5)+1;return null==e?t:this.add("d",e-t)},weekYear:function(e){var t=L(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==e?t:this.add("y",e-t)},isoWeekYear:function(e){var t=L(this,1,4).year;return null==e?t:this.add("y",e-t)},week:function(e){var t=this.lang().week(this);return null==e?t:this.add("d",7*(e-t))},isoWeek:function(e){var t=L(this,1,4).week;return null==e?t:this.add("d",7*(e-t))},weekday:function(e){var t=(this._d.getDay()+7-this.lang()._week.dow)%7;return null==e?t:this.add("d",e-t)},isoWeekday:function(e){return null==e?this.day()||7:this.day(this.day()%7?e:e-7)},lang:function(t){return t===e?this._lang:(this._lang=d(t),this)}},P=0;P<nt.length;P++)O(nt[P].toLowerCase().replace(/s$/,""),nt[P]);O("year","FullYear"),D.fn.days=D.fn.day,D.fn.months=D.fn.month,D.fn.weeks=D.fn.week,D.fn.isoWeeks=D.fn.isoWeek,D.fn.toJSON=D.fn.toISOString,D.duration.fn=s.prototype={_bubble:function(){var e,t,n,r,i=this._milliseconds,s=this._days,o=this._months,a=this._data;a.milliseconds=i%1e3,e=u(i/1e3),a.seconds=e%60,t=u(e/60),a.minutes=t%60,n=u(t/60),a.hours=n%24,s+=u(n/24),a.days=s%30,o+=u(s/30),a.months=o%12,r=u(o/12),a.years=r},weeks:function(){return u(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+2592e6*(this._months%12)+31536e6*~~(this._months/12)},humanize:function(e){var t=+this,n=k(t,!e,this.lang());return e&&(n=this.lang().pastFuture(t,n)),this.lang().postformat(n)},add:function(e,t){var n=D.duration(e,t);return this._milliseconds+=n._milliseconds,this._days+=n._days,this._months+=n._months,this._bubble(),this},subtract:function(e,t){var n=D.duration(e,t);return this._milliseconds-=n._milliseconds,this._days-=n._days,this._months-=n._months,this._bubble(),this},get:function(e){return e=h(e),this[e.toLowerCase()+"s"]()},as:function(e){return e=h(e),this["as"+e.charAt(0).toUpperCase()+e.slice(1)+"s"]()},lang:D.fn.lang};for(P in rt)rt.hasOwnProperty(P)&&(_(P,rt[P]),M(P.toLowerCase()));_("Weeks",6048e5),D.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},D.lang("en",{ordinal:function(e){var t=e%10,n=1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+n}}),F&&(module.exports=D),"undefined"==typeof ender&&(this.moment=D),"function"==typeof define&&define.amd&&define("moment",[],function(){return D})}.call(this),moment.lang("pt-br",{months:"Janeiro_Fevereiro_Março_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingo_Segunda-feira_Terça-feira_Quarta-feira_Quinta-feira_Sexta-feira_Sábado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sáb".split("_"),weekdaysMin:"Dom_2ª_3ª_4ª_5ª_6ª_Sáb".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY LT",LLLL:"dddd, D [de] MMMM [de] YYYY LT"},calendar:{sameDay:"[Hoje às] LT",nextDay:"[Amanhã às] LT",nextWeek:"dddd [às] LT",lastDay:"[Ontem às] LT",lastWeek:function(){return this.day()===0||this.day()===6?"[Último] dddd [às] LT":"[Última] dddd [às] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"%s atrás",s:"segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um mês",MM:"%d meses",y:"um ano",yy:"%d anos"},ordinal:"%dº"}),define("models/mail/MessagesModel",["underscore","backbone","shared","moment"],function(e,t,n,r){var i=t.Model.extend({defaults:{msgID:"",folderID:"",msgDate:"",msgFrom:{fullName:"",mailAddress:""},msgTo:[],msgReplyTo:[],msgCc:[],msgCC:[],msgBcc:[],msgSubject:"",msgHasAttachments:"",msgFlagged:"",msgForwarded:"",msgAnswered:"",msgDraft:"",msgSeen:"",msgSize:"",msgBodyResume:"",msgType:"",files:[]},initialize:function(){this.api=n.api,this.readResource="/Mail/Messages",this.updateResource="",this.createResource="/Mail/Send",this.deleteResource="/Mail/DelMessage"},checkAttachments:function(e){var t=n.max_upload_file_size,r=n.max_upload_file_qtd,i=this.get("files"),s=0,o=!0;for(var u in i)s+=i[u].fileSize;if(s/1024>t){var a=n.bytesToSize(t*1024,0);o="Sua mensagem está com mais de "+a+"!"}return i.length>r&&(o="Sua mensagem está com mais de "+r+" anexos!"),o!=1&&e&&e&&n.showMessage({type:"warning",icon:"icon-email",title:o,description:"",elementID:"#pageMessage"}),o},clearFiles:function(){this.set("files",[])},addFile:function(e,t,n,r,i){var s=this.get("files"),o={fileID:e,filename:decodeURI(n),fileSize:i,src:t,dataType:r};s.push(o),this.set("files",s),this.checkAttachments(!0)},removeFileByID:function(e){var t=this.get("files"),n=[];for(var r in t)t[r].fileID!=e&&n.push(t[r]);this.set("files",n)},route:function(){return"/Mail/Messages/0/"+this.get("msgID")+"/"+this.get("folderID")},listItemID:function(){return"Mail_Message_ListItem_"+this.get("folderID").split("/").join("_").split(" ").join("_")+"_"+this.get("msgID")},getEmailsRecipientsInArray:function(e){var t="",n=this.get(e);for(var r in n)t+=this.getEmailStringForMessageRecipient(n[r])+", ";return t},getAttachmentSize:function(t){var r="",i=this;return e.each(this.get("msgAttachments"),function(e){e.attachmentID==t&&(r=n.bytesToSize(e.attachmentSize,0))}),""+r+""},getMessageBody:function(e,t,n){var r="";n!=undefined?r=n.get("msgBody"):r=this.get("msgBody");var i="";return e==1?(i="<br><br>"+this.getUserSignature()+"<br><br>",t=="forward"?(i+=n.getForwardMessageString(n),i=this.nl2br(i,"<br>"),i+=r):t=="reply"&&(i+=this.getReplyMessageString(n),i=this.nl2br(i,"<br>"),i=i+'<blockquote style="margin: 0pt 0pt 0pt 0.8ex; padding-left: 1ex; border-left-color: rgb(204, 204, 204); border-left-width: 1px; border-left-style: solid;">'+r+"</blockquote>")):i=r,i},getReplyMessageString:function(e){var t=e.get("msgDate"),n="Em "+t+", "+e.getEmailStringForMessageRecipient(e.get("msgFrom"),!0)+" escreveu: \n\n";return n},getForwardMessageString:function(t){var n="---------- Mensagem encaminhada ----------\n";return n=n+"Remetente: "+t.get("msgFrom").mailAddress+"\n",n=n+"Data: "+t.get("msgDate")+"\n",n=n+"Assunto: "+t.get("msgSubject")+"\n",n+="Para: ",e.each(t.get("msgTo"),function(e){n=n+t.getEmailStringForMessageRecipient(e,!0)+", "}),t.get("msgCc").length&&(n+="\nCc: ",e.each(t.get("msgCc"),function(e){n=n+t.getEmailStringForMessageRecipient(e,!0)+", "})),n+="\n",n},getUserSignature:function(){return n.settings.mailSignature==undefined&&(n.settings.mailSignature="Mensagem enviada pelo Expresso Mobile."),n.settings.typeSignature!="html"?this.nl2br(n.settings.mailSignature,"<br>"):n.settings.mailSignature},nl2br:function(e,t){return t==undefined&&(t="<br>"),(e+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+t+"")},getEmailStringForMessageRecipient:function(e,t){var n="";return $.trim(e.fullName)!=""&&$.trim(e.fullName)!="undefined"?t==undefined?n+='"'+$.trim(e.fullName)+'" <'+e.mailAddress+">":n+='"'+$.trim(e.fullName)+'" &lt;'+e.mailAddress+"&gt;":n+=e.mailAddress+"",n},htmlDecode:function(e){var t=$("<div/>").html(e).text();return t},htmlEncode:function(e){return $("<div/>").text(e).html()},removeRecipient:function(e,t){var n=this.get(e),r=[];for(var i=0,s;recipient=n[i];i++)recipient.mailAddress!=t&&r.push(recipient);this.set(e,r)},addRecipient:function(e,t,n){var r=this.get(e),i={fullName:n,mailAddress:t};r.push(i),this.set(e,r)},getTimeAgo:function(){var e=this.get("msgDate");return r(e,"DD/MM/YYYY hh:mm").fromNow()},getQtdFiles:function(){var e=this.get("files");return e.length},addBinaryFile:function(e,t,n,r){var i=new FileReader,s=this;i.fileName=t,i.fileID=e,i.fileSize=n.size,i.onerror=function(e){},i.onprogress=function(e){},i.onabort=function(e){},i.onloadstart=function(e){},i.onload=function(e){blobBinaryString=i.result,s.addFile(i.fileID,blobBinaryString,escape(i.fileName),"binary",i.fileSize),r!=undefined&&r(s)},i.readAsBinaryString(n)},addNewMessageFiles:function(e){var t=this,r=1,i=function(n){alert("Não foi possível anexar um arquivo!\n"),e(t)},s=function(n){var i=function(t){e(t)};r+=1,t.addBinaryFile(r,n.name,n,i)},o=function(e){e.file(s,i)},u=function(e){var t=n.newMessageFiles;for(var r=0,s;s=t[r];r++){var u=t[r];e.root.getFile(u,null,o,i)}};n.newMessageFiles!=0?window.requestFileSystem(LocalFileSystem.PERSISTENT,0,u,i):e(t)},send:function(e,t){var n=this,r={msgTo:this.get("msgToString"),msgCcTo:this.get("msgCcString"),msgBccTo:this.get("msgBccString"),msgSubject:this.get("msgSubject"),msgBody:this.get("msgBody"),msgType:this.get("msgType")},i=this.get("files");this.api.resource(this.createResource).params(r),this.api.clearFiles();for(var s in i)this.api.addFile(i[s].src,i[s].filename,i[s].dataType,i[s].size);this.api.dataType("fileupload").done(function(t){e(t)}).fail(function(e){t(e)}).execute()},getMessageSize:function(){return n.bytesToSize(this.get("msgSize"),0)},"delete":function(e,t){var n=this;this.api.resource(this.deleteResource).params({folderID:this.get("folderID"),msgID:this.get("msgID")}).done(function(t){e(t)}).fail(function(e){t(e)}).execute()}});return i}),define("collections/mail/MessagesCollection",["underscore","backbone","shared","models/mail/MessagesModel"],function(e,t,n,r){var i=t.Collection.extend({model:r,_data:{},done:function(e){return this._data.done=e,this},fail:function(e){return this._data.fail=e,this},currentPage:1,currentFolder:"",currentSearch:"",_ignoreCache:!1,ignoreCache:function(e){return this._ignoreCache=e,this},initialize:function(e,t){this.api=n.api,this.model=r},getMessagesInFolder:function(e,t,i,s){var o=this;o._data={};var u=r,a=this._data;this.currentFolder=e,this.currentSearch=i;var f=null;return s?(f=s,this.currentPage=1):f=o.currentPage,this.api.resource("/Mail/Messages").params({folderID:e,msgID:t,search:i,resultsPerPage:n.settings.resultsPerPage,page:f}).done(function(t){for(var r in t.messages){var i=new u(t.messages[r]);o.add(i)}o._data.done&&o._data.done(o),e=="INBOX"&&(n.lastCheckDate=Date.now())}).fail(function(e){o._data.fail&&o._data.fail(e)}),this._ignoreCache&&(console.log("ignoreCache"),this.api.ignoreCache(!0)),o},getMessageByID:function(e,t){return this.getMessagesInFolder(e,t,"",1)},execute:function(){return this.api.execute()},getNextPage:function(){return this.currentPage=this.currentPage+1,this.getMessagesInFolder(this.currentFolder,this.currentSearch,this.currentPage)}});return i}),define("text!templates/login/loginTemplate.html",[],function(){return'<div id="pageMessage"></div>\n<div class="login-center" style="width: 245px; margin-top: 0px;">\n      <div class="product-logo"></div>\n</div>\n<form method="POST" action="#/Home" class="login-box" onsubmit="">\n      <div id="beta" class="hidden"></div>\n      <div id="loadingLogin" style="width: 100%; min-height: 140px;">\n            <% if (servers.length > 1) { %>\n            <select id="serverURL" name="serverURL" class="login-input" >\n                  <% _.each(servers, function(server){ %>\n                        <option value="<%=server.getServerURL()%>"><%=server.get("serverName")%></option>\n                  <% }); %>\n            </select>\n            <% } else { %>\n                  <% _.each(servers, function(server){ %>\n                        <input type="hidden" id="serverURL" name="serverURL" value="<%=server.getServerURL()%>" />\n                  <% }); %>\n            <% } %>\n            <input id="username" type="username" name="username" class="login-input" value="" placeholder="Usu&aacute;rio" autofocus>\n            <input id="password" type="password" name="password" class="login-input" value="" placeholder="Senha">\n\n            <input id="btn-login" type="button" value="Conectar" class="btn btn-primary"  onclick="" style="width: 100%;">\n      </div>\n</form>\n<div class="login-center" style="width: 245px; margin-top: 20px;">\n      <div class="company-logo"></div>\n      <% if (Shared.isPhonegap()) { %>\n            <div id="helpLink" class="help">? Ajuda/Perguntas Frequentes</div>\n      <% } else { %>\n            <% if (showClassicLink) { %>\n            <div id="classicLink" class="help">Vers&atilde;o Cl&aacute;ssica</div> \n            <% } %>\n      <% } %>\n</div>\n'}),define("text!templates/home/loadingTemplate.html",[],function(){return'<div class="spinner">\n  <div class="bounce1"></div>\n  <div class="bounce2"></div>\n  <div class="bounce3"></div>\n</div>'}),define("views/home/LoadingView",["jquery","underscore","backbone","shared","text!templates/home/loadingTemplate.html"],function(e,t,n,r,i){var s=n.View.extend({el:e("#content"),render:function(){r.menuView&&r.menuView.renderContextMenu(0,[]);var e={_:t},n=t.template(i,e);this.$el.html(n)},loaded:function(){}});return s}),function(e,t){function A(e){return i===""?e:(e=e.charAt(0).toUpperCase()+e.substr(1),i+e)}var n=Math,r=t.createElement("div").style,i=function(){var e="t,webkitT,MozT,msT,OT".split(","),t,n=0,i=e.length;for(;n<i;n++){t=e[n]+"ransform";if(t in r)return e[n].substr(0,e[n].length-1)}return!1}(),s=i?"-"+i.toLowerCase()+"-":"",o=A("transform"),u=A("transitionProperty"),a=A("transitionDuration"),f=A("transformOrigin"),l=A("transitionTimingFunction"),c=A("transitionDelay"),h=/android/gi.test(navigator.appVersion),p=/iphone|ipad/gi.test(navigator.appVersion),d=/hp-tablet/gi.test(navigator.appVersion),v=A("perspective")in r,m="ontouchstart"in e&&!d,g=i!==!1,y=A("transition")in r,b="onorientationchange"in e?"orientationchange":"resize",w=m?"touchstart":"mousedown",E=m?"touchmove":"mousemove",S=m?"touchend":"mouseup",x=m?"touchcancel":"mouseup",T=function(){if(i===!1)return!1;var e={"":"transitionend",webkit:"webkitTransitionEnd",Moz:"transitionend",O:"otransitionend",ms:"MSTransitionEnd"};return e[i]}(),N=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(e){return setTimeout(e,1)}}(),C=function(){return e.cancelRequestAnimationFrame||e.webkitCancelAnimationFrame||e.webkitCancelRequestAnimationFrame||e.mozCancelRequestAnimationFrame||e.oCancelRequestAnimationFrame||e.msCancelRequestAnimationFrame||clearTimeout}(),k=v?" translateZ(0)":"",L=function(n,r){var i=this,c;i.wrapper=typeof n=="object"?n:t.getElementById(n),i.wrapper.style.overflow="hidden",i.scroller=i.wrapper.children[0],i.options={hScroll:!0,vScroll:!0,x:0,y:0,bounce:!0,bounceLock:!1,momentum:!0,lockDirection:!0,useTransform:!0,useTransition:!1,topOffset:0,checkDOMChanges:!1,handleClick:!0,hScrollbar:!0,vScrollbar:!0,fixedScrollbar:h,hideScrollbar:p,fadeScrollbar:p&&v,scrollbarClass:"",zoom:!1,zoomMin:1,zoomMax:4,doubleTapZoom:2,wheelAction:"scroll",snap:!1,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(e){!(e.target instanceof HTMLButtonElement)&&!(e.srcElement instanceof HTMLButtonElement)&&!(e.target instanceof HTMLInputElement)&&!(e.srcElement instanceof HTMLInputElement)&&!(e.target instanceof HTMLOptGroupElement)&&!(e.srcElement instanceof HTMLOptGroupElement)&&!(e.target instanceof HTMLOptionElement)&&!(e.srcElement instanceof HTMLOptionElement)&&!(e.target instanceof HTMLSelectElement)&&!(e.srcElement instanceof HTMLSelectElement)&&!(e.target instanceof HTMLDivElement&&$(e.target).attr("contenteditable")=="true")&&!(e.srcElement instanceof HTMLDivElement)&&!(e.target instanceof HTMLTextAreaElement)&&!(e.srcElement instanceof HTMLTextAreaElement)&&e.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null,onZoomStart:null,onZoom:null,onZoomEnd:null};for(c in r)i.options[c]=r[c];i.x=i.options.x,i.y=i.options.y,i.options.useTransform=g&&i.options.useTransform,i.options.hScrollbar=i.options.hScroll&&i.options.hScrollbar,i.options.vScrollbar=i.options.vScroll&&i.options.vScrollbar,i.options.zoom=i.options.useTransform&&i.options.zoom,i.options.useTransition=y&&i.options.useTransition,i.options.zoom&&h&&(k=""),i.scroller.style[u]=i.options.useTransform?s+"transform":"top left",i.scroller.style[a]="0",i.scroller.style[f]="0 0",i.options.useTransition&&(i.scroller.style[l]="cubic-bezier(0.33,0.66,0.66,1)"),i.options.useTransform?i.scroller.style[o]="translate("+i.x+"px,"+i.y+"px)"+k:i.scroller.style.cssText+=";position:absolute;top:"+i.y+"px;left:"+i.x+"px",i.options.useTransition&&(i.options.fixedScrollbar=!0),i.refresh(),i._bind(b,e),i._bind(w),m||i.options.wheelAction!="none"&&(i._bind("DOMMouseScroll"),i._bind("mousewheel")),i.options.checkDOMChanges&&(i.checkDOMTime=setInterval(function(){i._checkDOMChanges()},500))};L.prototype={enabled:!0,x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],aniTime:null,wheelZoomCount:0,handleEvent:function(e){var t=this;switch(e.type){case w:if(!m&&e.button!==0)return;t._start(e);break;case E:t._move(e);break;case S:case x:t._end(e);break;case b:t._resize();break;case"DOMMouseScroll":case"mousewheel":t._wheel(e);break;case T:t._transitionEnd(e)}},_checkDOMChanges:function(){if(this.moved||this.zoomed||this.animating||this.scrollerW==this.scroller.offsetWidth*this.scale&&this.scrollerH==this.scroller.offsetHeight*this.scale)return;this.refresh()},_scrollbar:function(e){var r=this,i;if(!r[e+"Scrollbar"]){r[e+"ScrollbarWrapper"]&&(g&&(r[e+"ScrollbarIndicator"].style[o]=""),r[e+"ScrollbarWrapper"].parentNode.removeChild(r[e+"ScrollbarWrapper"]),r[e+"ScrollbarWrapper"]=null,r[e+"ScrollbarIndicator"]=null);return}r[e+"ScrollbarWrapper"]||(i=t.createElement("div"),r.options.scrollbarClass?i.className=r.options.scrollbarClass+e.toUpperCase():i.style.cssText="position:absolute;z-index:100;"+(e=="h"?"height:7px;bottom:1px;left:2px;right:"+(r.vScrollbar?"7":"2")+"px":"width:7px;bottom:"+(r.hScrollbar?"7":"2")+"px;top:2px;right:1px"),i.style.cssText+=";pointer-events:none;"+s+"transition-property:opacity;"+s+"transition-duration:"+(r.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(r.options.hideScrollbar?"0":"1"),r.wrapper.appendChild(i),r[e+"ScrollbarWrapper"]=i,i=t.createElement("div"),r.options.scrollbarClass||(i.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);"+s+"background-clip:padding-box;"+s+"box-sizing:border-box;"+(e=="h"?"height:100%":"width:100%")+";"+s+"border-radius:3px;border-radius:3px"),i.style.cssText+=";pointer-events:none;"+s+"transition-property:"+s+"transform;"+s+"transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);"+s+"transition-duration:0;"+s+"transform: translate(0,0)"+k,r.options.useTransition&&(i.style.cssText+=";"+s+"transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)"),r[e+"ScrollbarWrapper"].appendChild(i),r[e+"ScrollbarIndicator"]=i),e=="h"?(r.hScrollbarSize=r.hScrollbarWrapper.clientWidth,r.hScrollbarIndicatorSize=n.max(n.round(r.hScrollbarSize*r.hScrollbarSize/r.scrollerW),8),r.hScrollbarIndicator.style.width=r.hScrollbarIndicatorSize+"px",r.hScrollbarMaxScroll=r.hScrollbarSize-r.hScrollbarIndicatorSize,r.hScrollbarProp=r.hScrollbarMaxScroll/r.maxScrollX):(r.vScrollbarSize=r.vScrollbarWrapper.clientHeight,r.vScrollbarIndicatorSize=n.max(n.round(r.vScrollbarSize*r.vScrollbarSize/r.scrollerH),8),r.vScrollbarIndicator.style.height=r.vScrollbarIndicatorSize+"px",r.vScrollbarMaxScroll=r.vScrollbarSize-r.vScrollbarIndicatorSize,r.vScrollbarProp=r.vScrollbarMaxScroll/r.maxScrollY),r._scrollbarPos(e,!0)},_resize:function(){var e=this;setTimeout(function(){e.refresh()},h?200:0)},_pos:function(e,t){if(this.zoomed)return;e=this.hScroll?e:0,t=this.vScroll?t:0,this.options.useTransform?this.scroller.style[o]="translate("+e+"px,"+t+"px) scale("+this.scale+")"+k:(e=n.round(e),t=n.round(t),this.scroller.style.left=e+"px",this.scroller.style.top=t+"px"),this.x=e,this.y=t,this._scrollbarPos("h"),this._scrollbarPos("v")},_scrollbarPos:function(e,t){var r=this,i=e=="h"?r.x:r.y,s;if(!r[e+"Scrollbar"])return;i=r[e+"ScrollbarProp"]*i,i<0?(r.options.fixedScrollbar||(s=r[e+"ScrollbarIndicatorSize"]+n.round(i*3),s<8&&(s=8),r[e+"ScrollbarIndicator"].style[e=="h"?"width":"height"]=s+"px"),i=0):i>r[e+"ScrollbarMaxScroll"]&&(r.options.fixedScrollbar?i=r[e+"ScrollbarMaxScroll"]:(s=r[e+"ScrollbarIndicatorSize"]-n.round((i-r[e+"ScrollbarMaxScroll"])*3),s<8&&(s=8),r[e+"ScrollbarIndicator"].style[e=="h"?"width":"height"]=s+"px",i=r[e+"ScrollbarMaxScroll"]+(r[e+"ScrollbarIndicatorSize"]-s))),r[e+"ScrollbarWrapper"].style[c]="0",r[e+"ScrollbarWrapper"].style.opacity=t&&r.options.hideScrollbar?"0":"1",r[e+"ScrollbarIndicator"].style[o]="translate("+(e=="h"?i+"px,0)":"0,"+i+"px)")+k},_start:function(t){var r=this,i=m?t.touches[0]:t,s,u,a,f,l;if(!r.enabled)return;r.options.onBeforeScrollStart&&r.options.onBeforeScrollStart.call(r,t),(r.options.useTransition||r.options.zoom)&&r._transitionTime(0),r.moved=!1,r.animating=!1,r.zoomed=!1,r.distX=0,r.distY=0,r.absDistX=0,r.absDistY=0,r.dirX=0,r.dirY=0,r.options.zoom&&m&&t.touches.length>1&&(f=n.abs(t.touches[0].pageX-t.touches[1].pageX),l=n.abs(t.touches[0].pageY-t.touches[1].pageY),r.touchesDistStart=n.sqrt(f*f+l*l),r.originX=n.abs(t.touches[0].pageX+t.touches[1].pageX-r.wrapperOffsetLeft*2)/2-r.x,r.originY=n.abs(t.touches[0].pageY+t.touches[1].pageY-r.wrapperOffsetTop*2)/2-r.y,r.options.onZoomStart&&r.options.onZoomStart.call(r,t));if(r.options.momentum){r.options.useTransform?(s=getComputedStyle(r.scroller,null)[o].replace(/[^0-9\-.,]/g,"").split(","),u=+(s[12]||s[4]),a=+(s[13]||s[5])):(u=+getComputedStyle(r.scroller,null).left.replace(/[^0-9-]/g,""),a=+getComputedStyle(r.scroller,null).top.replace(/[^0-9-]/g,""));if(u!=r.x||a!=r.y)r.options.useTransition?r._unbind(T):C(r.aniTime),r.steps=[],r._pos(u,a),r.options.onScrollEnd&&r.options.onScrollEnd.call(r)}r.absStartX=r.x,r.absStartY=r.y,r.startX=r.x,r.startY=r.y,r.pointX=i.pageX,r.pointY=i.pageY,r.startTime=t.timeStamp||Date.now(),r.options.onScrollStart&&r.options.onScrollStart.call(r,t),r.refresh(),r._bind(E,e),r._bind(S,e),r._bind(x,e)},_move:function(e){var t=this,r=m?e.touches[0]:e,i=r.pageX-t.pointX,s=r.pageY-t.pointY,u=t.x+i,a=t.y+s,f,l,c,h=e.timeStamp||Date.now();t.options.onBeforeScrollMove&&t.options.onBeforeScrollMove.call(t,e);if(t.options.zoom&&m&&e.touches.length>1){f=n.abs(e.touches[0].pageX-e.touches[1].pageX),l=n.abs(e.touches[0].pageY-e.touches[1].pageY),t.touchesDist=n.sqrt(f*f+l*l),t.zoomed=!0,c=1/t.touchesDistStart*t.touchesDist*this.scale,c<t.options.zoomMin?c=.5*t.options.zoomMin*Math.pow(2,c/t.options.zoomMin):c>t.options.zoomMax&&(c=2*t.options.zoomMax*Math.pow(.5,t.options.zoomMax/c)),t.lastScale=c/this.scale,u=this.originX-this.originX*t.lastScale+this.x,a=this.originY-this.originY*t.lastScale+this.y,this.scroller.style[o]="translate("+u+"px,"+a+"px) scale("+c+")"+k,t.options.onZoom&&t.options.onZoom.call(t,e);return}t.pointX=r.pageX,t.pointY=r.pageY;if(u>0||u<t.maxScrollX)u=t.options.bounce?t.x+i/2:u>=0||t.maxScrollX>=0?0:t.maxScrollX;if(a>t.minScrollY||a<t.maxScrollY)a=t.options.bounce?t.y+s/2:a>=t.minScrollY||t.maxScrollY>=0?t.minScrollY:t.maxScrollY;t.distX+=i,t.distY+=s,t.absDistX=n.abs(t.distX),t.absDistY=n.abs(t.distY);if(t.absDistX<6&&t.absDistY<6)return;t.options.lockDirection&&(t.absDistX>t.absDistY+5?(a=t.y,s=0):t.absDistY>t.absDistX+5&&(u=t.x,i=0)),t.moved=!0,t._pos(u,a),t.dirX=i>0?-1:i<0?1:0,t.dirY=s>0?-1:s<0?1:0,h-t.startTime>300&&(t.startTime=h,t.startX=t.x,t.startY=t.y),t.options.onScrollMove&&t.options.onScrollMove.call(t,e)},_end:function(r){if(m&&r.touches.length!==0)return;var i=this,s=m?r.changedTouches[0]:r,u,f,l={dist:0,time:0},c={dist:0,time:0},h=(r.timeStamp||Date.now())-i.startTime,p=i.x,d=i.y,v,g,y,b,w;i._unbind(E,e),i._unbind(S,e),i._unbind(x,e),i.options.onBeforeScrollEnd&&i.options.onBeforeScrollEnd.call(i,r);if(i.zoomed){w=i.scale*i.lastScale,w=Math.max(i.options.zoomMin,w),w=Math.min(i.options.zoomMax,w),i.lastScale=w/i.scale,i.scale=w,i.x=i.originX-i.originX*i.lastScale+i.x,i.y=i.originY-i.originY*i.lastScale+i.y,i.scroller.style[a]="200ms",i.scroller.style[o]="translate("+i.x+"px,"+i.y+"px) scale("+i.scale+")"+k,i.zoomed=!1,i.refresh(),i.options.onZoomEnd&&i.options.onZoomEnd.call(i,r);return}if(!i.moved){m&&(i.doubleTapTimer&&i.options.zoom?(clearTimeout(i.doubleTapTimer),i.doubleTapTimer=null,i.options.onZoomStart&&i.options.onZoomStart.call(i,r),i.zoom(i.pointX,i.pointY,i.scale==1?i.options.doubleTapZoom:1),i.options.onZoomEnd&&setTimeout(function(){i.options.onZoomEnd.call(i,r)},200)):this.options.handleClick&&(i.doubleTapTimer=setTimeout(function(){i.doubleTapTimer=null,u=s.target;while(u.nodeType!=1)u=u.parentNode;u.tagName!="SELECT"&&u.tagName!="INPUT"&&u.tagName!="TEXTAREA"&&(f=t.createEvent("MouseEvents"),f.initMouseEvent("click",!0,!0,r.view,1,s.screenX,s.screenY,s.clientX,s.clientY,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,0,null),f._fake=!0,u.dispatchEvent(f))},i.options.zoom?250:0))),i._resetPos(400),i.options.onTouchEnd&&i.options.onTouchEnd.call(i,r);return}if(h<300&&i.options.momentum){l=p?i._momentum(p-i.startX,h,-i.x,i.scrollerW-i.wrapperW+i.x,i.options.bounce?i.wrapperW:0):l,c=d?i._momentum(d-i.startY,h,-i.y,i.maxScrollY<0?i.scrollerH-i.wrapperH+i.y-i.minScrollY:0,i.options.bounce?i.wrapperH:0):c,p=i.x+l.dist,d=i.y+c.dist;if(i.x>0&&p>0||i.x<i.maxScrollX&&p<i.maxScrollX)l={dist:0,time:0};if(i.y>i.minScrollY&&d>i.minScrollY||i.y<i.maxScrollY&&d<i.maxScrollY)c={dist:0,time:0}}if(l.dist||c.dist){y=n.max(n.max(l.time,c.time),10),i.options.snap&&(v=p-i.absStartX,g=d-i.absStartY,n.abs(v)<i.options.snapThreshold&&n.abs(g)<i.options.snapThreshold?i.scrollTo(i.absStartX,i.absStartY,200):(b=i._snap(p,d),p=b.x,d=b.y,y=n.max(b.time,y))),i.scrollTo(n.round(p),n.round(d),y),i.options.onTouchEnd&&i.options.onTouchEnd.call(i,r);return}if(i.options.snap){v=p-i.absStartX,g=d-i.absStartY,n.abs(v)<i.options.snapThreshold&&n.abs(g)<i.options.snapThreshold?i.scrollTo(i.absStartX,i.absStartY,200):(b=i._snap(i.x,i.y),(b.x!=i.x||b.y!=i.y)&&i.scrollTo(b.x,b.y,b.time)),i.options.onTouchEnd&&i.options.onTouchEnd.call(i,r);return}i._resetPos(200),i.options.onTouchEnd&&i.options.onTouchEnd.call(i,r)},_resetPos:function(e){var t=this,n=t.x>=0?0:t.x<t.maxScrollX?t.maxScrollX:t.x,r=t.y>=t.minScrollY||t.maxScrollY>0?t.minScrollY:t.y<t.maxScrollY?t.maxScrollY:t.y;if(n==t.x&&r==t.y){t.moved&&(t.moved=!1,t.options.onScrollEnd&&t.options.onScrollEnd.call(t)),t.hScrollbar&&t.options.hideScrollbar&&(i=="webkit"&&(t.hScrollbarWrapper.style[c]="300ms"),t.hScrollbarWrapper.style.opacity="0"),t.vScrollbar&&t.options.hideScrollbar&&(i=="webkit"&&(t.vScrollbarWrapper.style[c]="300ms"),t.vScrollbarWrapper.style.opacity="0");return}t.scrollTo(n,r,e||0)},_wheel:function(e){var t=this,n,r,i,s,o;if("wheelDeltaX"in e)n=e.wheelDeltaX/12,r=e.wheelDeltaY/12;else if("wheelDelta"in e)n=r=e.wheelDelta/12;else{if(!("detail"in e))return;n=r=-e.detail*3}if(t.options.wheelAction=="zoom"){o=t.scale*Math.pow(2,1/3*(r?r/Math.abs(r):0)),o<t.options.zoomMin&&(o=t.options.zoomMin),o>t.options.zoomMax&&(o=t.options.zoomMax),o!=t.scale&&(!t.wheelZoomCount&&t.options.onZoomStart&&t.options.onZoomStart.call(t,e),t.wheelZoomCount++,t.zoom(e.pageX,e.pageY,o,400),setTimeout(function(){t.wheelZoomCount--,!t.wheelZoomCount&&t.options.onZoomEnd&&t.options.onZoomEnd.call(t,e)},400));return}i=t.x+n,s=t.y+r,i>0?i=0:i<t.maxScrollX&&(i=t.maxScrollX),s>t.minScrollY?s=t.minScrollY:s<t.maxScrollY&&(s=t.maxScrollY),t.maxScrollY<0&&t.scrollTo(i,s,0)},_transitionEnd:function(e){var t=this;if(e.target!=t.scroller)return;t._unbind(T),t._startAni()},_startAni:function(){var e=this,t=e.x,r=e.y,i=Date.now(),s,o,u;if(e.animating)return;if(!e.steps.length){e._resetPos(400);return}s=e.steps.shift(),s.x==t&&s.y==r&&(s.time=0),e.animating=!0,e.moved=!0;if(e.options.useTransition){e._transitionTime(s.time),e._pos(s.x,s.y),e.animating=!1,s.time?e._bind(T):e._resetPos(0);return}u=function(){var a=Date.now(),f,l;if(a>=i+s.time){e._pos(s.x,s.y),e.animating=!1,e.options.onAnimationEnd&&e.options.onAnimationEnd.call(e),e._startAni();return}a=(a-i)/s.time-1,o=n.sqrt(1-a*a),f=(s.x-t)*o+t,l=(s.y-r)*o+r,e._pos(f,l),e.animating&&(e.aniTime=N(u))},u()},_transitionTime:function(e){e+="ms",this.scroller.style[a]=e,this.hScrollbar&&(this.hScrollbarIndicator.style[a]=e),this.vScrollbar&&(this.vScrollbarIndicator.style[a]=e)},_momentum:function(e,t,r,i,s){var o=6e-4,u=n.abs(e)/t,a=u*u/(2*o),f=0,l=0;return e>0&&a>r?(l=s/(6/(a/u*o)),r+=l,u=u*r/a,a=r):e<0&&a>i&&(l=s/(6/(a/u*o)),i+=l,u=u*i/a,a=i),a*=e<0?-1:1,f=u/o,{dist:a,time:n.round(f)}},_offset:function(e){var t=-e.offsetLeft,n=-e.offsetTop;while(e=e.offsetParent)t-=e.offsetLeft,n-=e.offsetTop;return e!=this.wrapper&&(t*=this.scale,n*=this.scale),{left:t,top:n}},_snap:function(e,t){var r=this,i,s,o,u,a,f;o=r.pagesX.length-1;for(i=0,s=r.pagesX.length;i<s;i++)if(e>=r.pagesX[i]){o=i;break}o==r.currPageX&&o>0&&r.dirX<0&&o--,e=r.pagesX[o],a=n.abs(e-r.pagesX[r.currPageX]),a=a?n.abs(r.x-e)/a*500:0,r.currPageX=o,o=r.pagesY.length-1;for(i=0;i<o;i++)if(t>=r.pagesY[i]){o=i;break}return o==r.currPageY&&o>0&&r.dirY<0&&o--,t=r.pagesY[o],f=n.abs(t-r.pagesY[r.currPageY]),f=f?n.abs(r.y-t)/f*500:0,r.currPageY=o,u=n.round(n.max(a,f))||200,{x:e,y:t,time:u}},_bind:function(e,t,n){(t||this.scroller).addEventListener(e,this,!!n)},_unbind:function(e,t,n){(t||this.scroller).removeEventListener(e,this,!!n)},destroy:function(){var t=this;t.scroller.style[o]="",t.hScrollbar=!1,t.vScrollbar=!1,t._scrollbar("h"),t._scrollbar("v"),t._unbind(b,e),t._unbind(w),t._unbind(E,e),t._unbind(S,e),t._unbind(x,e),t.options.hasTouch||(t._unbind("DOMMouseScroll"),t._unbind("mousewheel")),t.options.useTransition&&t._unbind(T),t.options.checkDOMChanges&&clearInterval(t.checkDOMTime),t.options.onDestroy&&t.options.onDestroy.call(t)},refresh:function(){var e=this,t,r,i,s,o=0,u=0;e.scale<e.options.zoomMin&&(e.scale=e.options.zoomMin),e.wrapperW=e.wrapper.clientWidth||1,e.wrapperH=e.wrapper.clientHeight||1,e.minScrollY=-e.options.topOffset||0,e.scrollerW=n.round(e.scroller.offsetWidth*e.scale),e.scrollerH=n.round((e.scroller.offsetHeight+e.minScrollY)*e.scale),e.maxScrollX=e.wrapperW-e.scrollerW,e.maxScrollY=e.wrapperH-e.scrollerH+e.minScrollY,e.dirX=0,e.dirY=0,e.options.onRefresh&&e.options.onRefresh.call(e),e.hScroll=e.options.hScroll&&e.maxScrollX<0,e.vScroll=e.options.vScroll&&(!e.options.bounceLock&&!e.hScroll||e.scrollerH>e.wrapperH),e.hScrollbar=e.hScroll&&e.options.hScrollbar,e.vScrollbar=e.vScroll&&e.options.vScrollbar&&e.scrollerH>e.wrapperH,t=e._offset(e.wrapper),e.wrapperOffsetLeft=-t.left,e.wrapperOffsetTop=-t.top;if(typeof e.options.snap=="string"){e.pagesX=[],e.pagesY=[],s=e.scroller.querySelectorAll(e.options.snap);for(r=0,i=s.length;r<i;r++)o=e._offset(s[r]),o.left+=e.wrapperOffsetLeft,o.top+=e.wrapperOffsetTop,e.pagesX[r]=o.left<e.maxScrollX?e.maxScrollX:o.left*e.scale,e.pagesY[r]=o.top<e.maxScrollY?e.maxScrollY:o.top*e.scale}else if(e.options.snap){e.pagesX=[];while(o>=e.maxScrollX)e.pagesX[u]=o,o-=e.wrapperW,u++;e.maxScrollX%e.wrapperW&&(e.pagesX[e.pagesX.length]=e.maxScrollX-e.pagesX[e.pagesX.length-1]+e.pagesX[e.pagesX.length-1]),o=0,u=0,e.pagesY=[];while(o>=e.maxScrollY)e.pagesY[u]=o,o-=e.wrapperH,u++;e.maxScrollY%e.wrapperH&&(e.pagesY[e.pagesY.length]=e.maxScrollY-e.pagesY[e.pagesY.length-1]+e.pagesY[e.pagesY.length-1])}e._scrollbar("h"),e._scrollbar("v"),e.zoomed||(e.scroller.style[a]="0",e._resetPos(400))},scrollTo:function(e,t,n,r){var i=this,s=e,o,u;i.stop(),s.length||(s=[{x:e,y:t,time:n,relative:r}]);for(o=0,u=s.length;o<u;o++)s[o].relative&&(s[o].x=i.x-s[o].x,s[o].y=i.y-s[o].y),i.steps.push({x:s[o].x,y:s[o].y,time:s[o].time||0});i._startAni()},scrollToElement:function(e,t){var r=this,i;e=e.nodeType?e:r.scroller.querySelector(e);if(!e)return;i=r._offset(e),i.left+=r.wrapperOffsetLeft,i.top+=r.wrapperOffsetTop,i.left=i.left>0?0:i.left<r.maxScrollX?r.maxScrollX:i.left,i.top=i.top>r.minScrollY?r.minScrollY:i.top<r.maxScrollY?r.maxScrollY:i.top,t=t===undefined?n.max(n.abs(i.left)*2,n.abs(i.top)*2):t,r.scrollTo(i.left,i.top,t)},scrollToPage:function(e,t,n){var r=this,i,s;n=n===undefined?400:n,r.options.onScrollStart&&r.options.onScrollStart.call(r),r.refresh(),r.options.snap?(e=e=="next"?r.currPageX+1:e=="prev"?r.currPageX-1:e,t=t=="next"?r.currPageY+1:t=="prev"?r.currPageY-1:t,e=e<0?0:e>r.pagesX.length-1?r.pagesX.length-1:e,t=t<0?0:t>r.pagesY.length-1?r.pagesY.length-1:t,r.currPageX=e,r.currPageY=t,i=r.pagesX[e],s=r.pagesY[t]):(i=-r.wrapperW*e,s=-r.wrapperH*t,i<r.maxScrollX&&(i=r.maxScrollX),s<r.maxScrollY&&(s=r.maxScrollY)),r.scrollTo(i,s,n)},disable:function(){this.stop(),this._resetPos(0),this.enabled=!1,this._unbind(E,e),this._unbind(S,e),this._unbind(x,e)},enable:function(){this.enabled=!0},stop:function(){this.options.useTransition?this._unbind(T):C(this.aniTime),this.steps=[],this.moved=!1,this.animating=!1},zoom:function(e,t,n,r){var i=this,s=n/i.scale;if(!i.options.useTransform)return;i.zoomed=!0,r=r===undefined?200:r,e=e-i.wrapperOffsetLeft-i.x,t=t-i.wrapperOffsetTop-i.y,i.x=e-e*s+i.x,i.y=t-t*s+i.y,i.scale=n,i.refresh(),i.x=i.x>0?0:i.x<i.maxScrollX?i.maxScrollX:i.x,i.y=i.y>i.minScrollY?i.minScrollY:i.y<i.maxScrollY?i.maxScrollY:i.y,i.scroller.style[a]=r+"ms",i.scroller.style[o]="translate("+i.x+"px,"+i.y+"px) scale("+n+")"+k,i.zoomed=!1},isReady:function(){return!this.moved&&!this.zoomed&&!this.animating}},r=null,typeof exports!="undefined"?exports.iScroll=L:e.iScroll=L}(window,document),define("iscroll",function(){}),function(e){e.fn.touchwipe=function(t){var n={min_move_x:20,min_move_y:20,wipeLeft:function(){},wipeRight:function(){},wipeUp:function(){},wipeDown:function(){},preventDefaultEvents:!0};return t&&e.extend(n,t),this.each(function(){function i(){this.removeEventListener("touchmove",s),e=null,r=!1}function s(s){n.preventDefaultEvents&&s.preventDefault();if(r){var o=s.touches[0].pageX,u=s.touches[0].pageY,a=e-o,f=t-u;Math.abs(a)>=n.min_move_x?(i(),a>0?n.wipeLeft():n.wipeRight()):Math.abs(f)>=n.min_move_y&&(i(),f>0?n.wipeDown():n.wipeUp())}}function o(n){n.touches.length==1&&(e=n.touches[0].pageX,t=n.touches[0].pageY,r=!0,this.addEventListener("touchmove",s,!1))}var e,t,r=!1;"ontouchstart"in document.documentElement&&this.addEventListener("touchstart",o,!1)}),this}}(jQuery),define("jquery_touchwipe",["jquery"],function(){}),define("models/home/ServerModel",["underscore","backbone","shared"],function(e,t,n){var r=t.Model.extend({defaults:{serverID:"",serverName:"",serverDescription:"",serverUrl:"",serverContext:"",serverStatus:"1"},initialize:function(){},getServerURL:function(){return this.get("serverUrl").concat(this.get("serverContext"))}});return r}),define("collections/home/ServersCollection",["underscore","backbone","shared","models/home/ServerModel","expressoAPI"],function(e,t,n,r,i){var s=t.Collection.extend({model:r,_data:{},done:function(e){return this._data.done=e,this},fail:function(e){return this._data.fail=e,this},initialize:function(e,t){this.api=n.api,this.model=r},getServersFromExpressoLivre:function(){var e=this,t=this._data,i=n.api.phoneGap(),s=n.ComunityServerURL;i?n.api.context(s).crossdomain(s):n.api.context(n.context).crossdomain(s),n.api.resource("AvailableServers").params({}).done(function(t){for(var n in t.servers){var i=new r(t.servers[n]);e.add(i)}return e._data.done&&e._data.done(e),!1}).fail(function(t){return e._data.fail&&e._data.fail(t),!1}).execute()},getServers:function(){var e=this,t=this._data,i=n.api.phoneGap();if(!i)var s=$.ajax("servers.json").done(function(t){try{var n=jQuery.parseJSON(t).result;for(var i in n.servers){var s=new r(n.servers[i]);e.add(s)}e._data.done&&e._data.done(e)}catch(o){e.getServersFromExpressoLivre()}});else e.getServersFromExpressoLivre();return e}});return s}),define("text!templates/mail/messagesListTemplate.html",[],function(){return'<%\n\nvar folderClass = "folder-blue";\n\nif (currentFolder.get("folderType") == 0) {\n	folderClass = "folder-inbox";\n}\n\nif (currentFolder.get("folderType") == 4) {\n	folderClass = "folder-drafts";\n}\n\nif (currentFolder.get("folderType") == 1) {\n	folderClass = "folder-sent";\n}\n\nif (currentFolder.get("folderType") == 2) {\n	folderClass = "folder-spam";\n}\n\nif (currentFolder.get("folderType") == 3) {\n	if (currentFolder.get("qtdMessages") == "0") { \n		folderClass = "folder-trash";\n	} else {\n		folderClass = "folder-trash-full";\n	}	\n}\n\nif (currentFolder.get("folderType") == 5) {\n	folderClass = "folder-blue";\n}\n\nif (currentFolder.get("folderType") == 6) {\n	folderClass = "folder-shared";\n}\n\n%>\n<h2 class="ellipsis50 <%=folderClass%>" style="padding-left: 50px; background-position: 10px;"><%=currentFolder.get("folderName")%></h2>\n<div class="searchArea">\n  <input id="searchField" type="text" value="" placeholder="Procurar Por:" />\n</div>\n\n<div id="wrapper" class="container">\n  <div id="scroller">\n  	<div id="pullDown">\n	  	<span class="pullDownIcon"></span><span class="pullDownLabel"><% if (collection.length) { %>Puxe para baixo para atualizar<% } %></span>\n	</div>\n	<ul id="scrollerList">\n\n	</ul>\n	<div id="pullUp">\n	  <span class="pullUpIcon"></span><span class="pullUpLabel">\n	  <% if (!collection.length) { %>Esta pasta não contém mensagens.<% } else { %>Puxe para cima para carregar mais...<% } %></span>\n	</div>\n	\n  </div>\n</div>'}),define("text!templates/mail/messagesListItemsTemplate.html",[],function(){return'<% _.each(parentFolders, function(folder){ %>\n  <li>\n    <a href="<%=folder.route()%>" name="<%=folder.route()%>" data-toggle="collapse" data-target="#menu" class="listFolderItemLink">\n      <% if (folder.get("folderType") == 0) { %>\n        <div class="folder-icon  folder-inbox"></div>\n      <% } %>\n      <% if (folder.get("folderType") == 4) { %>\n        <div class="folder-icon folder-drafts"></div>\n      <% } %>\n      <% if (folder.get("folderType") == 1) { %>\n        <div class="folder-icon  folder-sent"></div>\n      <% } %>\n      <% if (folder.get("folderType") == 2) { %>\n        <div class="folder-icon  folder-blue"></div>\n      <% } %>\n      <% if (folder.get("folderType") == 3) { %>\n        <div class="folder-icon  folder-trash-full"></div>\n      <% } %>\n      <% if (folder.get("folderType") == 5) { %>\n        <div class="folder-icon  folder-blue"></div>\n      <% } %>\n      <% if (folder.get("folderType") == 6) { %>\n        <div class="folder-icon  folder-shared"></div>\n      <% } %>\n      <% if (folder.get("qtdUnreadMessages") != 0) { %><strong class="badge badge-info" style="float: right; margin-top: 20px; margin-right: 10px;"><%=folder.get("qtdUnreadMessages")%></strong><% } %>\n      <h3 class="ellipsis20" style="margin-left: 40px;"><%=folder.get("folderName")%></h3>\n    </a>\n  </li>\n<% }); %>\n<% \n\n  _.each(messages, function(message){ \n   %>\n  <li id="<%=message.listItemID()%>" <% if (message.get("msgID") == msgIDSelected) { %>class="selected"<%} %>> \n    <a href="<%=message.route()%>" class="listItemLink">\n      <div class="msg-list-images">\n        <span class="ellipsis14" style="text-align: right; margin: 5px; font-size: 10px;"><%=message.getTimeAgo()%></span>\n        <% if (message.get("msgHasAttachments") == \'1\') { %>\n        <div class="msg-attachments"></div>\n        <% } %>\n        <% if (message.get("msgFlagged") == \'1\') { %>\n        <div class="msg-flagged"></div>\n        <% } %>\n        <% if (message.get("msgForwarded") == \'1\') { %>\n        <div class="msg-forwarded"></div>\n        <% } %>\n        <div class="clear"></div>\n      </div>\n      <% if ((message.get("msgSeen") == \'0\') && (message.get("msgID") != msgIDSelected)) { %>\n        <div id="<%=message.listItemID()%>_unread" class="msg-unread"></div>\n      <% } %>\n      <h3 class="ellipsis20"><%= message.get("msgSubject") %></h3>\n      <span class="ellipsis14"><%= message.get("msgFrom").mailAddress %></span>\n    </a>\n  </li>\n<% }); %>'}),define("views/mail/MessagesListItemsView",["jquery","underscore","backbone","shared","text!templates/mail/messagesListItemsTemplate.html"],function(e,t,n,r,i){var s=n.View.extend({parentFolders:[],msgIDSelected:"",render:function(n){var r=this,s={parentFolders:this.parentFolders,messages:this.collection.models,msgIDSelected:this.msgIDSelected,_:t},o=t.template(i,s);n?e("#scrollerList").append(o):e("#scrollerList").html(o)},events:{"click a.listItemLink":"selectListItem"},selectListItem:function(t){t.preventDefault(),e("#scrollerList li").each(function(){e(this).hasClass("listDivision").toString()=="false"&&e(this).removeClass("selected")});var n=e(t.target).parent();n.hasClass("listItemLink")&&(n=n.parent()),n.addClass("selected");var i=e(n).attr("id");e("#"+i+"_unread").removeClass("msg-unread"),r.router.navigate(t.currentTarget.getAttribute("href"),{trigger:!0})}});return s}),define("models/mail/FoldersModel",["underscore","backbone","shared"],function(e,t,n){var r=t.Model.extend({defaults:{folderName:"",folderParentID:"",folderHasChildren:0,qtdUnreadMessages:0,qtdMessages:0,folderID:"INBOX",folderType:0,diskSizeUsed:"",diskSizePercent:0},initialize:function(){this.api=n.api},route:function(){return"/Mail/Messages/1/0/"+this.get("folderID")+"#"}});return r}),define("collections/mail/FoldersCollection",["underscore","backbone","shared","models/mail/FoldersModel"],function(e,t,n,r){var i=t.Collection.extend({model:r,diskSizeUsed:0,diskSizeLimit:0,diskSizePercent:0,_data:{},done:function(e){return this._data.done=e,this},fail:function(e){return this._data.fail=e,this},currentFolder:"",currentSearch:"",initialize:function(e,t){this.api=n.api,this.model=r,this.diskSizeUsed=0,this.diskSizeLimit=0,this.diskSizePercent=0},getSubFoldersFromFolderID:function(t){var n=[];return e.each(this.models,function(e){e.get("folderParentID")==t&&n.push(e)}),n},getFolderByID:function(t){var n=[];return e.each(this.models,function(e){e.get("folderID")==t&&(n=e)}),n},renameFolder:function(e,t){var n=this;n._data={};var i=r,s=this._data;return this.api.resource("/Mail/RenameFolder").params({folderName:e,folderID:t}).done(function(e){n._data.done&&n._data.done(e)}).fail(function(e){n._data.fail&&n._data.fail(e)}),n},addFolder:function(e,t){var n=this;n._data={};var i=r,s=this._data;return this.api.resource("/Mail/AddFolder").params({folderName:e,parentFolderID:t}).done(function(e){n._data.done&&n._data.done(e)}).fail(function(e){n._data.fail&&n._data.fail(e)}),n},cleanTrash:function(){var e=this;e._data={};var t=r,n=this._data;return this.api.resource("/Mail/CleanTrash").params({}).done(function(t){e._data.done&&e._data.done(t)}).fail(function(t){e._data.fail&&e._data.fail(t)}),e},deleteFolder:function(e){var t=this;t._data={};var n=r,i=this._data;return this.api.resource("/Mail/DelFolder").params({folderID:e}).done(function(e){t._data.done&&t._data.done(e)}).fail(function(e){t._data.fail&&t._data.fail(e)}),t},getFolders:function(e,t){var i=this;i._data={};var s=r,o=this._data;return this.currentFolder=e,this.currentSearch=t,this.api.resource("/Mail/Folders").params({folderID:e,search:t}).done(function(e){for(var t in e.folders){var r=new s(e.folders[t]);i.add(r)}i.diskSizeUsed=e.diskSizeUsed,i.diskSizeLimit=e.diskSizeLimit,i.diskSizePercent=e.diskSizePercent,n.folders=i,i._data.done&&i._data.done(i)}).fail(function(e){i._data.fail&&i._data.fail(e)}),i},execute:function(){return this.api.execute()}});return i}),define("text!templates/mail/detailMessageTemplate.html",[],function(){return'<% if (messages.length != 0) { %>\n<% _.each(messages, function(message){ %>\n<h2 class="ellipsis50"><span class="subtitle-detail-text"><%=message.getTimeAgo()%> (<%=message.getMessageSize()%>)</span><%= message.get("msgSubject") %></h2>\n<article id="wrapperDetail" class="container" style="overflow: auto;">\n  <div id="scrollerDetail">\n    <table id="messageDetails"> \n      <tr class="detailRow">\n        <td class="item detailCol">\n          De:\n        </td>\n        <td class="description detailCol">\n          <span class="badge badge-write-message">\n             <%= message.get("msgFrom").mailAddress %>\n          </span>\n        </td>\n        <td class="detailCol">\n          <div class="msg-list-images" style="width: 150px;">\n            <% if (message.get("msgHasAttachments") == \'1\') { %>\n            <div class="msg-attachments"></div>\n            <% } %>\n            <% if (message.get("msgFlagged") == \'1\') { %>\n            <div class="msg-flagged"></div>\n            <% } %>\n            <% if (message.get("msgForwarded") == \'1\') { %>\n            <div class="msg-forwarded"></div>\n            <% } %>\n            <div class="clear"></div>\n          </div>\n        </td>\n      </tr> \n      <div id="msgDetails" class="hidden">\n        <tr class="detailRow">\n          <td class="item detailCol">\n            Para:\n          </td>\n          <td class="description detailCol" colspan="2">\n            <% if (message.get("msgTo")) {  %>\n              <% if (message.get("msgTo").length > 3) { %>\n                <div style="float: right;">\n                  <a href="#" class="showMoreMsgTo">e mais <%=(message.get("msgTo").length - 3)%> pessoas...</a>\n                </div>\n              <% } %>\n                <% var qtdMsgTo = 1; %>\n                <% _.each(message.get("msgTo"), function(msgRecipient){ %>\n                    <span class="detailMsgTo badge badge-write-message <% if (qtdMsgTo >= 4) { %>hidden<% } %>" data-mail="<%=msgRecipient.mailAddress%>">\n                      \n                    <% if ($.trim(msgRecipient.fullName) != \'\') { %> \n                      <%=$.trim(msgRecipient.fullName)%>\n                    <% } else { %>\n                      <%=msgRecipient.mailAddress%>\n                    <% } %>\n                    \n                    </span>\n                    <% qtdMsgTo = qtdMsgTo + 1; %>\n                <% }); %>\n            <% } %>\n          </td>\n        </tr> \n      \n        <% if (message.get("msgCC").length) {  %>\n        <tr class="detailRow">\n          <td class="item detailCol">\n            Cc:\n          </td>\n          <td class="description detailCol" colspan="2">\n              <% if (message.get("msgCC").length > 3) { %>\n                <div style="float: right;">\n                  <a href="#" class="showMoreMsgCc">e mais <%=(message.get("msgCC").length - 3)%> pessoas...</a>\n                </div>\n              <% } %>\n              <% var qtdMsgCc = 1; %>\n              <% _.each(message.get("msgCC"), function(msgRecipientCc){ %>\n                <span class="detailMsgCc badge badge-write-message <% if (qtdMsgCc >= 4) { %>hidden<% } %>">\n                <% if ($.trim(msgRecipientCc.fullName) != \'\') { %> \n                  <%=$.trim(msgRecipientCc.fullName)%>\n                <% } else { %>\n                  <%=msgRecipientCc.mailAddress%>\n                <% } %>\n                </span>\n                <% qtdMsgCc = qtdMsgCc + 1; %>\n              <% }); %>\n            \n          </td>\n        </tr> \n        <% } %>\n        <% if (message.get("msgBcc").length) {  %>\n        <tr class="detailRow">\n          <td class="item detailCol">\n            Bcc:\n          </td>\n          <td class="description detailCol" colspan="2">\n              <% _.each(message.get("msgBcc"), function(msgRecipientBcc){ %>\n                <span class="badge badge-write-message">\n                <% if ($.trim(msgRecipientBcc.fullName) != \'\') { %> \n                  <%=$.trim(msgRecipientBcc.fullName)%>\n                <% } else { %>\n                  <%=msgRecipientBcc.mailAddress%>\n                <% } %>\n                </span>\n              <% }); %>\n          </td>\n        </tr> \n        <% } %>\n      </div>\n      <tr class="detailRow">\n        <td class="item detailCol">\n          Data:\n        </td>\n        <td class="description detailCol" colspan="2">\n          <%=message.get("msgDate")%>&nbsp;(<%=message.getTimeAgo()%>)\n        </td>\n      </tr> \n      <tr class="detailRow">\n        <td class="item detailCol">\n          Assunto:\n        </td>\n        <td class="description detailCol" colspan="2">\n          <%= message.get("msgSubject") %>\n        </td>\n      </tr>\n      <% if (message.get("msgAttachments")) {  %>\n      <tr class="detailRow">\n        <td class="item detailCol">\n          Anexos:\n        </td>\n        <td class="description detailCol" colspan="2">\n            <div id="msgAttachmentsRecipients">\n\n            </div>\n\n        </td>\n      </tr> \n      <% } %>\n      <tr class="detailRow">\n        <td id="contentMessageBody" class="itemBody detailCol" colspan="3">\n          <%=message.getMessageBody(false)%>\n        </td>\n      </tr> \n    </table>\n  </div>\n</article>\n<% }); %>\n<% } else { %>\n<h2 class="ellipsis50"><span class="subtitle-detail-text"></span>&nbsp;</h2>\n<article id="wrapperDetail" class="container">\n  <div id="scrollerDetail">\n    <br><br>\n    <center>\n      <span>\n        Nenhuma mensagem foi selecionada...\n      </span>\n    </center>\n  </div>\n</article>\n<% } %>'}),define("models/home/ContextMenuModel",["underscore","backbone","shared"],function(e,t,n){var r=t.Model.extend({defaults:{route:"",id:"",title:"",iconClass:"",callBack:"",parentCallBack:"",primary:!1},initialize:function(){}});return r}),define("collections/home/ContextMenuCollection",["underscore","backbone","shared","models/home/ContextMenuModel"],function(e,t,n,r){var i=t.Collection.extend({model:r,initialize:function(e,t){this.api=n.api,this.model=r},createModelsFromArray:function(e){for(var t in e){var n=new r(e[t]);this.add(n)}},getMessagesListMenu:function(e,t,n,r){var i=[],s={route:"/Mail/Message/New",id:"1",title:"Nova Mensagem",iconClass:"btn-compose",primary:!0},o={route:"/Mail/AddFolder/"+e+"",id:"2",iconClass:"context-add-folder",title:"Adicionar Pasta"},u={route:"/Mail/RenameFolder/"+e+"",id:"3",iconClass:"context-rename-folder",title:"Renomear Pasta"},a={route:"/Mail/DeleteFolder/"+e+"",id:"4",iconClass:"context-del-folder",title:"Apagar Pasta"},f={route:"/Mail/CleanTrash/"+e+"",id:"5",iconClass:"context-delete-message",title:"Limpar Lixeira"};return i.push(s),n==5&&(i.push(o),i.push(u),r==0&&i.push(a)),n==0&&i.push(o),n==3&&i.push(f),this.createModelsFromArray(i),this},getMailSignatureMenu:function(){var e=[{route:"/Settings/SaveMailSignature",title:"Salvar",primary:!0}];return this.createModelsFromArray(e),this},getChangePasswordMenu:function(e){var t=[{route:"#",id:"0",callBack:e.saveCallBack,parentCallBack:e.parentCallBack,title:"Salvar",primary:!0}];return this.createModelsFromArray(t),this},getSupportMenu:function(e){var t=[{route:"#",id:"0",callBack:e.saveCallBack,parentCallBack:e.parentCallBack,title:"Enviar",primary:!0}];return this.createModelsFromArray(t),this},getEditFolderMenu:function(e){var t=[{route:"#",id:"0",callBack:e.saveCallBack,parentCallBack:e.parentCallBack,title:"Salvar",primary:!0}];return this.createModelsFromArray(t),this},getDetailMessageMenu:function(e,t,n,r){var i=[],s={route:"/Mail/Message/New",id:"0",title:"Nova Mensagem",iconClass:"btn-compose",primary:!0},o={route:"/Mail/Message/ReplyMessage/"+t+"/"+e,id:"1",iconClass:"context-reply",title:"Responder"},u={route:"/Mail/Message/ReplyToAll/"+t+"/"+e,id:"2",iconClass:"context-reply-all",title:"Responder p/ Todos"},a={route:"/Mail/Message/Forward/"+t+"/"+e,id:"3",iconClass:"context-forward",title:"Encaminhar"},f={route:"/Mail/Message/DelMessage/"+t+"/"+e,id:"4",iconClass:"context-delete-message",title:"Apagar Mensagem"},l={route:"/Mail/AddFolder/"+e+"",id:"5",iconClass:"context-add-folder",title:"Adicionar Pasta"},c={route:"/Mail/RenameFolder/"+e+"",id:"6",iconClass:"context-rename-folder",title:"Renomear Pasta"},h={route:"/Mail/DeleteFolder/"+e+"",id:"7",iconClass:"context-del-folder",title:"Apagar Pasta"},p={route:"/Mail/CleanTrash/"+e+"",id:"5",iconClass:"context-delete-message",title:"Limpar Lixeira"};return i.push(s),t!=0&&(i.push(o),i.push(u),i.push(a),i.push(f)),n==5&&(i.push(l),i.push(c),r==0&&i.push(h)),n==0&&i.push(l),n==3&&i.push(p),this.createModelsFromArray(i),this},getSendMessageMenu:function(e){var t=[{route:"#",id:"0",callBack:e.sendCallBack,parentCallBack:e.parentCallBack,title:"Enviar",iconClass:"",primary:!0},{route:"#",id:"1",callBack:e.addCcBccCallBack,parentCallBack:e.parentCallBack,title:"Adicionar CC/BCC",iconClass:"icon-add-ccbcc",primary:!1}],r={route:"#",id:"3",callBack:e.takePictureCallBack,parentCallBack:e.parentCallBack,title:"Tirar Foto",iconClass:"icon-take-picture",primary:!1},i={route:"#",id:"4",callBack:e.selectPictureCallBack,parentCallBack:e.parentCallBack,title:"Escolher Foto",iconClass:"icon-select-picture",primary:!1},s={route:"#",id:"5",callBack:e.selectAttachmentFileCallBack,parentCallBack:e.parentCallBack,title:"Adicionar Anexo",iconClass:"icon-select-picture",primary:!1};return n.isPhonegap()?(t.push(r),t.push(i)):t.push(s),this.createModelsFromArray(t),this},getSendMessageMenuWithCC:function(e){var t=[{route:"#",id:"0",callBack:e.sendCallBack,parentCallBack:e.parentCallBack,title:"Enviar",iconClass:"",primary:!0},{route:"#",id:"2",callBack:e.removeCcBccCallBack,parentCallBack:e.parentCallBack,title:"Remover CC/BCC",iconClass:"icon-remove-ccbcc",primary:!1}],r={route:"#",id:"3",callBack:e.takePictureCallBack,parentCallBack:e.parentCallBack,title:"Tirar Foto",iconClass:"icon-take-picture",primary:!1},i={route:"#",id:"4",callBack:e.selectPictureCallBack,parentCallBack:e.parentCallBack,title:"Escolher Foto",iconClass:"icon-select-picture",primary:!1},s={route:"#",id:"5",callBack:e.selectAttachmentFileCallBack,parentCallBack:e.parentCallBack,title:"Adicionar Anexo",iconClass:"icon-select-picture",primary:!1};return n.api.phoneGap()?(t.push(r),t.push(i)):t.push(s),this.createModelsFromArray(t),this},getPrimaryAction:function(){var e=!1;for(var t in this.models)this.models[t].get("primary")==1&&(e=this.models[t]);return e},getActionById:function(e){var t=!1;for(var n in this.models)this.models[n].get("id")==e&&(t=this.models[n]);return t},getGeneralContactsMenu:function(){var e=[{route:"/Contacts/Personal",iconClass:"btn-catalogo-pessoal",title:"Contatos Pessoais",primary:!0}];return this.createModelsFromArray(e),this},getPersonalContactsMenu:function(){var e=[{route:"/Contacts/General",iconClass:"btn-catalogo-geral",title:"Catálogo Geral",primary:!0}];return this.createModelsFromArray(e),this},getDetailsContactMenu:function(e,t,r){var i={route:"/Mail/Message/New/"+e,id:"0",title:"Nova Mensagem",iconClass:"btn-compose",primary:!0},s={route:"/Contacts/Personal",iconClass:"context-catalogo-pessoal",id:"1",title:"Contatos Pessoais"},o={route:"/Contacts/General",iconClass:"context-catalogo-geral",id:"2",title:"Catálogo Geral"},u={route:"/Contacts/Add/"+t,id:"3",title:"Adicionar nos contatos pessoais",iconClass:"icon-add-contact-personal"},a={route:"/Contacts/Delete/"+t,id:"3",title:"Remover dos contatos pessoais",iconClass:"icon-delete-contact-personal"},f=[];return n.userHasModule("mail")?f.push(i):(u.primary=!0,u.iconClass="btn-add-contact-personal",a.primary=!0,a.iconClass="btn-delete-contact-personal"),r=="General"?(f.push(s),f.push(u)):n.apiVersion!="1.0"&&(f.push(o),f.push(a)),this.createModelsFromArray(f),this},getCalendarMenu:function(e,t,n){var r=new Date,i="00";if(e==""||e==undefined)e=r.getFullYear();if(t==""||t==undefined)t=r.getMonth()+1,t=i.substring(0,i.length-(""+t).length)+(""+t);if(n==""||n==undefined)n=r.getDate();var s=[{route:"/Calendar/Events/Add/"+e+"/"+t+"/"+n,title:"Adicionar evento",iconClass:"btn-add-event",primary:!0}];return this.createModelsFromArray(s),this},getCalendarAddEventMenu:function(e){var t=[{route:"#",id:"0",callBack:e.saveCallBack,parentCallBack:e.parentCallBack,title:"Salvar",iconClass:"btn-save-event",primary:!0},{route:"#",id:"1",callBack:e.addParticipantsCallBack,parentCallBack:e.parentCallBack,title:"Adicionar participantes",iconClass:"icon-add-contact-agenda",primary:!1,action:"addParticipants"}];return this.createModelsFromArray(t),this},getCalendarDetailsEventMenu:function(e,t,n,r,i){var s=new Date,o="00";if(n==""||n==undefined)n=s.getFullYear();if(r==""||r==undefined)r=s.getMonth()+1,r=o.substring(0,o.length-(""+r).length)+(""+r);if(i==""||i==undefined)i=s.getDate();var u=[];return e?(u.push({route:"/Calendar/Events/Edit/"+t,id:"1",title:"Editar evento",iconClass:"btn-edit-event",primary:!0}),u.push({route:"/Calendar/Events/Add/"+n+"/"+r+"/"+i,id:"0",title:"Adicionar evento",iconClass:"",primary:!1,action:"add",iconClass:"icon-add-event"}),u.push({route:"/Calendar/Events/Delete/"+t+"/"+n+"/"+r+"/"+i,id:"2",title:"Excluir evento",iconClass:"",primary:!1,action:"delete",iconClass:"icon-delete-event"})):u.push({route:"/Calendar/Events/Add/"+n+"/"+r+"/"+i,id:"0",title:"Adicionar evento",iconClass:"",primary:!0,action:"add",iconClass:"btn-add-event"}),this.createModelsFromArray(u),this},getCalendarAddEventParticipantMenu:function(e){var t=[{route:"#",id:"0",callBack:e.saveCallBack,parentCallBack:e.parentCallBack,title:"Salvar",iconClass:"btn-add-contact-agenda",primary:!0}];return this.createModelsFromArray(t),this},getChatOfflineMenu:function(e){var t=[{id:"0",route:"/ChatReconnect",title:"Reconectar",iconClass:"",primary:!0},{id:"1",route:"/Settings/Support",title:"Suporte / Sugestões",iconClass:""}];return this.createModelsFromArray(t),this}});return i}),define("text!templates/mail/previewAttachmentMessageTemplate.html",[],function(){return'<div id="attach_<%=fileID%>" class="attachment<% if (fileType != \'base64\') { %> attachment-arquivo-background <% } %>">\n    <div id="preview_<%=fileID%>" class="attachmentPreview">&nbsp;</div>\n    <div class="attachmentTitle">\n      <% if (!( (Shared.isIDevice()) && (!Shared.isPhonegap()) &&  (previewType != \'compose\')) ) { %>\n      <a id="attachLink_<%=fileID%>" href="#" class="<% if (previewType == \'compose\') { %>deleteAttachmentLink<% } else { if (Shared.isDesktop()) { %>downloadAttachmentLink<% } else { %>touchDownloadAttachmentLink<% } } %>">\n        <div class="<% if (previewType == \'compose\') { %>deleteAttachment<% } else { %>downloadAttachment<% } %>"></div>\n        <div class="fileSize"><%=Shared.bytesToSize(fileSize,0)%></div>\n        <div class="fileName"><%=fileName%></div>\n      </a>\n      <% } else { %>\n        <div class="fileSize"><%=Shared.bytesToSize(fileSize,0)%></div>\n        <div class="fileName"><%=fileName%></div>\n      <% } %>\n    </div>\n    <% if (fileType == "base64") { %>\n      <div style="position: relative; overflow: hidden;">\n        <img class="attachmentImage" style="position: relative; left: 0px; height: 150px;" src="data:image/jpeg;base64,<%=fileData%>">\n      </div>\n    <% } %>\n</div>'}),define("views/mail/PreviewAttachmentMessageView",["jquery","underscore","backbone","shared","views/home/LoadingView","text!templates/mail/previewAttachmentMessageTemplate.html"],function(e,t,n,r,i,s){var o=n.View.extend({previewType:"compose",fileID:"",fileName:"",fileEncoding:"",fileIndex:"",fileType:"",fileSize:"",fileData:"",msgID:"",folderID:"",hasPreview:!1,forceDownloadFile:!1,render:function(){var n="#msgAttachmentsRecipients",i={fileID:this.fileID,fileName:this.fileName,fileType:this.fileType,fileSize:this.fileSize,fileData:this.fileData,previewType:this.previewType,_:t,Shared:r},o=t.template(s,i);this.$el.html(o),e(n).prepend(this.$el),this.canShowPreview()&&this.preview();if(this.forceDownloadFile!=0){var u=this;this.getFileData(function(e,t){var n=u.base64ArrayBuffer(t);u.fileData=n,u.forceDownloadFile(u.fileID,n,u.fileName,"base64")})}},events:{"touchend .touchDownloadAttachmentLink":"download","click .downloadAttachmentLink":"download","click .deleteAttachmentLink":"deleteAttachment"},startLoading:function(){var t="attachment_image_"+this.fileID;e("#attachment_image_"+this.fileID).addClass("hidden"),e("#attach_"+this.fileID).removeClass("attachment-arquivo-background");var n=e("<div />").addClass("spinner").attr("style","position: absolute; margin-top: 20px; margin-left: 40px; ");e("#preview_"+this.fileID).empty().prepend(n)},stopLoading:function(){e("#attachment_image_"+this.fileID).removeClass("hidden"),e("#attach_"+this.fileID).addClass("attachment-arquivo-background"),e("#preview_"+this.fileID).empty()},deleteAttachment:function(t){r.currentDraftMessage.removeFileByID(this.fileID),e("#attach_"+this.fileID).remove()},canShowPreview:function(){var e=this.fileName.toLowerCase().substr(this.fileName.length-3,3),t=!1;if(this.previewType=="compose"&&this.fileType=="binary"||this.fileData=="")switch(e){case"png":t=!0;break;case"jpg":t=!0}return t},showImage:function(t){if(!this.hasPreview){var n="attachment_image_"+this.fileID,r=e("<div />").attr("style","position: relative; overflow: hidden; height: 100%;").addClass("grow"),i=e("<img />").attr("style","position: relative; left: 0px; height: 150px;").addClass("attachmentImage");i.attr("id",n),i.attr("src","data:image/jpeg;base64,"+t),i.appendTo(r),e("#attach_"+this.fileID).append(r),e("#attach_"+this.fileID).removeClass("attachment-arquivo-background");var s=e("#"+n).width(),o=0;s<160?o=(160-s)/2:s>160&&(o=(160-s)/2),s==0&&(o=0),e("#"+n).attr("style","margin-left: "+o+"px;"),this.hasPreview=!0}},base64ArrayBuffer:function(e){var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=new Uint8Array(e),i=r.byteLength,s=i%3,o=i-s,u,a,f,l,c;for(var h=0;h<o;h+=3)c=r[h]<<16|r[h+1]<<8|r[h+2],u=(c&16515072)>>18,a=(c&258048)>>12,f=(c&4032)>>6,l=c&63,t+=n[u]+n[a]+n[f]+n[l];return s==1?(c=r[o],u=(c&252)>>2,a=(c&3)<<4,t+=n[u]+n[a]+"=="):s==2&&(c=r[o]<<8|r[o+1],u=(c&64512)>>10,a=(c&1008)>>4,f=(c&15)<<2,t+=n[u]+n[a]+n[f]+"="),t},downloadBrowser:function(t,n){window.URL=window.URL||window.webkitURL;var r=this.base64ArrayBuffer(n);this.showImage(r);var i=t.attachmentName.toLowerCase().substr(t.attachmentName.length-3,3),s="application/*";switch(i){case"png":s="image/png";break;case"jpg":s="image/jpeg";break;case"jpge":s="image/jpge";break;case"pdf":s="application/pdf"}var o=new Blob([n],{type:s}),u=document.createElement("a"),a=t.attachmentName;u.href=window.URL.createObjectURL(o),u.setAttribute("download",a),e("body").append(u);var f=document.createEvent("MouseEvents");f.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),u.dispatchEvent(f),e(u).trigger("click")},downloadPhonegap:function(e,t){var n=this.base64ArrayBuffer(t);this.showImage(n),window.plugins.expresso.saveImage(n,{filename:e.attachmentName,overwrite:!0},function(t){var n=e.attachmentName.toLowerCase().substr(e.attachmentName.length-3,3),r="application/*";switch(n){case"jpg":r="image/*";break;case"png":r="image/*";break;case"pdf":r="application/pdf"}window.plugins.webintent.startActivity({action:window.plugins.webintent.ACTION_VIEW,type:r,url:"file://"+t},function(){},function(){alert("Não foi possível abrir o Arquivo.")})},function(e){alert(e)})},downloadPhonegapIOS:function(e,t){var n=e.attachmentName,r=this.base64ArrayBuffer(t);this.showImage(r),ExternalFileUtil.openWith(n,"",r,function(e){},function(e){alert(e)})},getFileData:function(e){var t=this;this.startLoading();var n={attachmentID:this.fileID,attachmentName:this.fileName,attachmentEncoding:this.fileEncoding,attachmentIndex:this.fileIndex,msgID:this.msgID,folderID:this.folderID};r.api.resource("/Mail/Attachment").dataType("arraybuffer").params(n).done(function(r){t.stopLoading(),e(n,r)}).execute()},download:function(){var e=this;this.getFileData(function(t,n){r.isPhonegap()&&r.isAndroid()?e.downloadPhonegap(t,n):r.isPhonegap()&&r.isIDevice()?e.downloadPhonegapIOS(t,n):e.downloadBrowser(t,n)})},preview:function(e){var t=this;if(this.previewType!="compose"||this.forceDownloadFile!=0)this.getFileData(function(e,n){var r=t.base64ArrayBuffer(n);t.showImage(r)});else{var n=new FileReader;n.fileName=t.fileName,n.fileID=t.fileID,n.onerror=function(e){},n.onprogress=function(e){},n.onabort=function(e){},n.onloadstart=function(e){},n.onload=function(e){var n=e.target.result,r=t.base64ArrayBuffer(n);t.showImage(r)},n.readAsArrayBuffer(t.fileData)}}});return o}),define("views/mail/DetailMessageView",["jquery","underscore","backbone","shared","collections/mail/MessagesCollection","text!templates/mail/detailMessageTemplate.html","views/home/LoadingView","collections/home/ContextMenuCollection","views/mail/PreviewAttachmentMessageView"],function(e,t,n,r,i,s,o,u,a){var f=n.View.extend({folderID:"INBOX",msgID:"",search:"",page:1,scrollRefresh:!1,scrollDetail:"",render:function(){var n="#contentDetail";r.isSmartPhoneResolution()&&(n="#content"),this.$el.html("");var u=this;if(this.msgID){var a=new o({el:e(n)});a.render();var f=new i;f.getMessagesInFolder(this.folderID,this.msgID,this.search,this.page).done(function(i){var o=i.models[0],a=i.models.length,i={messages:i.models,_:t,Shared:r,$:e},f=t.template(s,i);u.$el.html(f),e(n).empty().append(u.$el),u.renderAttachments(o);var l=5;if(r.folders!=undefined){var c=r.folders.getFolderByID(u.folderID);c.get!=undefined&&(l=c.get("folderType"))}r.menuView.renderContextMenu("detailMessage",{folderID:u.folderID,msgID:u.msgID,folderType:l,qtdMessages:a}),setTimeout(function(){e.each(e("#contentMessageBody img"),function(){var t=e("#wrapperDetail").width();t-=40;var n=e(this).height(),r=e(this).width();if(r>t){var i=t,s=t*(n/r);e("#contentMessageBody").width(t),e(this).css("max-width",t),e(this).css("max-height",n),e(this).css("height",s),e(this).css("width",i)}}),u.loaded()},500)}).fail(function(t){return r.handleErrors(t.error),e(n).empty(),!1}).execute()}},renderAttachments:function(e){if(e!=undefined){var t=e.get("msgAttachments");for(var n in t){var r=t[n],i=new a;i.fileID=r.attachmentID,i.fileName=r.attachmentName,i.fileSize=r.attachmentSize,i.fileEncoding=r.attachmentEncoding,i.fileIndex=r.attachmentIndex,i.msgID=e.get("msgID"),i.folderID=e.get("folderID"),i.fileData="",i.previewType="detailmessage",i.render()}}},events:{"click .attachmentLink":"openAttachment","click .showMoreMsgTo":"showMoreMsgTo","click .showMoreMsgCc":"showMoreMsgCc","click #scrollerDetail":"refreshScroll","touch #scrollerDetail":"refreshScroll"},showMoreMsgTo:function(t){e(".detailMsgTo").removeClass("hidden"),e(".showMoreMsgTo").addClass("hidden"),this.loaded()},showMoreMsgCc:function(t){e(".detailMsgCc").removeClass("hidden"),e(".showMoreMsgCc").addClass("hidden"),this.loaded()},openAttachment:function(e){e.preventDefault(),r.router.navigate(e.currentTarget.getAttribute("href"),{trigger:!0})},refreshScroll:function(e){r.scrollDetail!=null&&r.scrollDetail.refresh()},loaded:function(){r.scrollDetail!=null&&(r.scrollDetail.destroy(),r.scrollDetail=null);var t=e(".topHeader").outerHeight(!0),n=e(".searchArea").outerHeight(true)==null?0:e(".searchArea").outerHeight(!0);e("body").height(e(window).height()-t),e("#wrapper").css("top",t+n);var i=e("#contentMessageBody").width(),s=e("#contentDetail").width();i+15>=s&&e("#scrollerDetail").width(i+2),r.scrollDetail=new iScroll("wrapperDetail",{vScroll:!0,hScroll:!0,hScrollBar:!0,vScrollBar:!0,zoom:!0}),r.scrollerRefresh()}});return f}),define("views/mail/MessagesListView",["jquery","underscore","backbone","shared","text!templates/mail/messagesListTemplate.html","views/mail/MessagesListItemsView","collections/mail/FoldersCollection","collections/mail/MessagesCollection","views/home/LoadingView","views/mail/DetailMessageView"],function(e,t,n,r,i,s,o,u,a,f){var l=n.View.extend({currentFolder:[],parentFolders:[],elementID:"#content",detailElementID:"#contentDetail",folderID:"INBOX",msgID:"",forceReload:"0",search:"",page:1,doneRoute:"",render:function(){this.elementID="#content";var n=this,s=function(s){var o={folderID:n.folderID,msgID:n.msgID,currentFolder:n.currentFolder,collection:s,_:t};s.length||r.isTabletResolution()&&(r.newMessageIntent?(r.newMessageIntent=!1,r.router.navigate("/Mail/Message/New",{trigger:!0})):r.router.navigate("/Mail/Messages/0/0/"+n.folderID+"#",{trigger:!0}));var u=t.template(i,o);n.$el.html(u),e(n.elementID).empty().append(n.$el)},o=function(){r.newMessageIntent==0&&r.menuView.renderContextMenu("messageList",{folderID:n.folderID,folderName:n.currentFolder.folderName,folderType:n.currentFolder.get("folderType"),qtdMessages:0});if(r.isTabletResolution()&&n.forceReload=="1"||!r.isTabletResolution()&&r.gotoRoute!=0)if(r.newMessageIntent==1)r.newMessageIntent=!1,r.router.navigate("/Mail/Message/New",{trigger:!0});else if(n.msgID!=undefined){var e=new f;e.folderID=n.folderID,e.msgID=n.msgID,r.menuView.renderContextMenu("messageList",{folderID:n.folderID,folderName:n.currentFolder.folderName,folderType:n.currentFolder.get("folderType"),qtdMessages:0}),e.render()}r.setDefaultIMListeners(),n.loaded()};if(this.forceReload=="1"){var u=new a({el:e(this.elementID)});u.render();var u=new a({el:e(this.detailElementID)});u.render(),n.getMessages(n.folderID,n.search,n.page,!1,!1,s,o)}else{var u=new a({el:e(this.detailElementID)});u.render();var l=new f;l.folderID=n.folderID,l.msgID=n.msgID,l.render()}},events:{"keydown #searchField":"searchMessage"},searchMessage:function(t){t.which==13&&!t.shiftKey&&(this.search=e("#searchField").val(),pullDownEl=document.getElementById("pullDown"),pullDownEl.className="loading",pullDownEl.querySelector(".pullDownLabel").innerHTML="Carregando...",this.pullDownAction())},selectFirstMessage:function(){var t=this.collection[0];t&&(e("#"+t.listItemID()).addClass("selected"),r.router.navigate(t.route(),{trigger:!0}))},getMessages:function(t,n,i,a,f,l,c){var h=new u,p=new o,d=this;p.getFolders(this.folderID,this.search).done(function(o){var u=o.getFolderByID(d.folderID),p=o.getSubFoldersFromFolderID(d.folderID);d.currentFolder=u,d.parentFolders=p,f==1&&h.ignoreCache(!0),h.getMessagesInFolder(t,"",n,i).done(function(t){a==1,d.collection=t.models,l&&l(d.collection);var n=new s({el:e("#scrollerList"),collection:t,parentFolders:d.parentFolders});a?n.parentFolders=[]:n.parentFolders=d.parentFolders,(d.msgID==""||d.msgID=="0")&&t.length&&r.isTabletResolution()&&(d.msgID=t.models[0].get("msgID")),n.msgIDSelected=d.msgID,n.render(a),c&&c();var i=e(".topHeader").outerHeight(!0),o=e(".searchArea").outerHeight(true)==null?0:e(".searchArea").outerHeight(!0);e("body").height(e(window).height()-i),e("#wrapper").css("top",i+o),r.scrollerRefresh()}).fail(function(t){return r.handleErrors(t.error),e(d.elementID).empty(),e(d.detailElementID).empty(),!1}).execute()}).fail(function(t){return r.handleErrors(t.error),e(d.elementID).empty(),e(d.detailElementID).empty(),!1}).execute()},pullDownAction:function(){this.page=1,this.getMessages(this.folderID,this.search,this.page,!1,!0)},pullUpAction:function(){this.page=this.page+1,this.getMessages(this.folderID,this.search,this.page,!0,!1)},loaded:function(){pullDownEl=document.getElementById("pullDown"),pullDownOffset=pullDownEl.offsetHeight,pullUpEl=document.getElementById("pullUp"),pullUpOffset=pullUpEl.offsetHeight;var e=this;r.scroll=new iScroll("wrapper",{useTransition:!0,topOffset:pullDownOffset,onRefresh:function(){pullDownEl.className.match("loading")?(pullDownEl.className="",pullDownEl.querySelector(".pullDownLabel").innerHTML="Puxe para baixo para atualizar..."):pullUpEl.className.match("loading")&&(pullUpEl.className="",pullUpEl.querySelector(".pullUpLabel").innerHTML="Puxe para cima para carregar mais...")},onScrollMove:function(){this.y>5&&!pullDownEl.className.match("flip")?(pullDownEl.className="flip",pullDownEl.querySelector(".pullDownLabel").innerHTML="Solte para atualizar...",this.minScrollY=0):this.y<5&&pullDownEl.className.match("flip")?(pullDownEl.className="",pullDownEl.querySelector(".pullDownLabel").innerHTML="Puxe para baixo para atualizar...",this.minScrollY=-pullDownOffset):this.y<this.maxScrollY-5&&!pullUpEl.className.match("flip")?(pullUpEl.className="flip",pullUpEl.querySelector(".pullUpLabel").innerHTML="Solte para carregar mais...",this.maxScrollY=this.maxScrollY):this.y>this.maxScrollY+5&&pullUpEl.className.match("flip")&&(pullUpEl.className="",pullUpEl.querySelector(".pullUpLabel").innerHTML="Puxe para cima para carregar mais...",this.maxScrollY=pullUpOffset)},onScrollEnd:function(){pullDownEl.className.match("flip")?(pullDownEl.className="loading",pullDownEl.querySelector(".pullDownLabel").innerHTML="Carregando...",e.pullDownAction()):pullUpEl.className.match("flip")&&(pullUpEl.className="loading",pullUpEl.querySelector(".pullUpLabel").innerHTML="Carregando...",e.pullUpAction())}})}});return l}),define("text!templates/mail/foldersMenuListTemplate.html",[],function(){return'<% _.each(folders, function(folder){ %>\n	<% if ((folder.get("folderParentID") == "") || (folder.get("folderParentID") == "user")) { %>\n	<li>\n		<a href="<%=folder.route()%>" name="<%=folder.route()%>" data-toggle="collapse" data-target="#menu" class="listFolderMenuItemLink">\n			<span><%=folder.get("folderName")%><% if (folder.get("folderHasChildren") == 1) { %><strong class="badge badge-subfolders"> > </strong><% } %><% if (folder.get("qtdUnreadMessages") != 0) { %><strong class="badge badge-info"><%=folder.get("qtdUnreadMessages")%></strong><% } %>\n				</span>\n		<% if (folder.get("folderType") == 0) { %>\n			<div class="icon folder-inbox"></div>\n		<% } %>\n		<% if (folder.get("folderType") == 4) { %>\n			<div class="icon folder-drafts"></div>\n		<% } %>\n		<% if (folder.get("folderType") == 1) { %>\n			<div class="icon folder-sent"></div>\n		<% } %>\n		<% if (folder.get("folderType") == 2) { %>\n			<div class="icon folder-spam"></div>\n		<% } %>\n		<% if (folder.get("folderType") == 3) { %>\n			<% if (folder.get("qtdMessages") == "0") { %>\n				<div class="icon folder-trash"></div>\n			<% } else { %>\n				<div class="icon folder-trash-full"></div>\n			<% } %>\n		<% } %>\n		<% if (folder.get("folderType") == 5) { %>\n			<div class="icon folder-blue"></div>\n		<% } %>\n		<% if (folder.get("folderType") == 6) { %>\n			<div class="icon folder-shared"></div>\n		<% } %>\n		\n		</a>\n	</li>\n	<% } %> \n<% }); %>'}),define("views/mail/FoldersMenuListView",["jquery","underscore","backbone","shared","collections/mail/FoldersCollection","text!templates/mail/foldersMenuListTemplate.html","views/home/LoadingView"],function(e,t,n,r,i,s,o){var u=n.View.extend({folderID:"INBOX",search:"",render:function(){this.getFolders(this.folderID,this.search)},events:{"click .listFolderMenuItemLink":"selectFolderMenuItem"},selectFolderMenuItem:function(t){t.preventDefault(),e("#myFolders li").each(function(){e(this).hasClass("selected")&&e(this).removeClass("selected")});var n=e(t.target).parent();n.hasClass("listFolderMenuItemLink")&&(n=n.parent()),n.addClass("selected"),r.router.navigate(t.currentTarget.getAttribute("href"),{trigger:!0})},getFolders:function(n,o){var u=this,a=new i;a.getFolders(n,o).done(function(n){u.collection=n.models;var i={folders:n.models,_:t},o=t.template(s,i);u.$el.html(o),e("#myFolders").empty().append(u.$el),r.menuView.setQuota(n.diskSizeUsed,n.diskSizeLimit),r.scrollerRefresh()}).fail(function(e){r.handleErrors(e)}).execute()}});return u}),define("text!templates/home/menuTemplate.html",[],function(){return'<div  class="container">\n  <% if (!Shared.isBuiltInExpresso()) { %><div class="product-logo-menu"></div><% } %>\n\n  <div id="personalInfo">\n    <div id="userPicture" class="userPicture shadow"></div>\n    <div class="personalData">\n      <span id="userName" class="name ellipsis14" style="margin-bottom: 8px;"><% if (!_.isNull(user.contactFullName)) { %><%=user.contactFullName%><% } %></span>\n      <% if (Shared.userHasModule("mail")) { %>\n      <span id="userEmail" class="email ellipsis14" style="margin-bottom: 8px;"><% if (!_.isNull(user.contactMails[0])) { %><%=user.contactMails[0]%><% } %></span>\n      <div id="quota">\n        \n        <div class="bar"> \n          <div id="usedQuota" class="usedQuota" style="width: 0%;"></div>\n          <span id="textQuota">Sem Quota</span>\n        </div>\n\n      </div>\n      <% } %>\n    </div>\n  </div>\n\n  <dl>\n\n    <% if (Shared.automaticLoginAccounts.accounts.length >= 2) { %>\n\n    <dt>Alterar Conta</dt>\n    <dd>\n      <ul id="mainMenu">\n      <% _.each(Shared.automaticLoginAccounts.accounts, function(account){ %>\n      <% if (Shared.forceAutomaticLoginInAccountName != account.accountName) { %>\n        <li class="account">\n          <a class="menuLink" href="/Switch/<%=account.accountName%>">\n            <span><%=account.accountName%></span>\n            <div class="userPicture icon"></div>\n          </a>\n        </li>\n      <% } %>\n      <% }); %>\n      </ul>\n    </dd>\n    <% } %>\n\n    \n    <dt<% if (Shared.isBuiltInExpresso()) { %> style="display: none;"<% } %>>Menu</dt>\n    <dd <% if (Shared.isBuiltInExpresso()) { %> style="display: none;"<% } %>>\n      <ul id="mainMenu">\n        <% _.each(menuItems, function(menuItem){ %>\n          <li class="<%=menuItem.get("menuClass")%>">\n            <a href="<%=menuItem.get("menuRoute")%>" class="menuLink">\n              <span><% if (menuItem.get("menuHasBadge")) { %><div id="badge_<%=menuItem.get("menuClass")%>" class="badge badge-chat hidden"></div><% } %><%=menuItem.get("menuTitle")%></span>\n              <div class="icon <%=menuItem.get("menuIconClass")%>"></div>\n            </a>\n          </li>\n        <% }); %>\n      </ul>\n    </dd>\n\n    <% if (Shared.userHasModule("mail")) { %>\n    <dt>Minhas Pastas</dt>\n    <dd>\n      <ul id="mainMenu">\n      \n          <li class="add-folder">\n            <a href="/Mail/AddFolder/INBOX#" class="menuLink">\n              <span>Adicionar Pasta</span>\n              <div class="icon icon-add-folder"></div>\n            </a>\n          </li>\n      </ul>\n    </dd>\n    <dd>\n      <ul id="myFolders">\n        \n      </ul>\n    </dd>\n    \n    <% } %>\n    <div class="menu-footer">\n      Desenvolvido por:<br><br>\n      <div class="company-logo"></div>\n    </div>\n  </dl>\n\n</div>\n'}),define("text!templates/home/contextMenuTemplate.html",[],function(){return'<ul class="right topButtons">\n  <li>\n    <input id="btn-primary-action" type="button" value="" class="hidden" style=""> \n  </li>\n  <% var menuItemsSecondary = _.filter(menuItems, function (item) { return item.get(\'primary\') == false; }); %>\n  <% if (typeof(menuItems) != \'undefined\' && menuItemsSecondary.length > 0) { %>\n	  <li><a id="contextMenuButton" href="#" class="contextMenu">Menu de contexto</a></li>\n  <% } %>\n</ul>\n<div id="contextMenu" class="hidden shadow">\n	<ul>\n		<% _.each(menuItems, function(menuItem){ %>\n			<% if (!menuItem.get("primary")) { %>\n				<li><a id="<%=menuItem.get("id")%>" href="<%=menuItem.get("route")%>" <% if (menuItem.get(\'action\') != undefined) { %>data-action="<%= menuItem.get(\'action\') %>"<% } %> title="<%=menuItem.get("title")%>"><div class="context-icon <%=menuItem.get("iconClass")%>"></div><%=menuItem.get("title")%></a></li>\n			<% } %>\n		<% }); %>\n	</ul>\n</div>\n\n'}),define("views/home/ContextMenuView",["jquery","underscore","iscroll","jquery_touchwipe","backbone","shared","text!templates/home/contextMenuTemplate.html","collections/home/ContextMenuCollection"],function(e,t,n,r,i,s,o,u){var a=i.View.extend({menuOpen:!1,profile:null,collection:null,primaryAction:"",callBack:"",parentCallBack:"",render:function(){this.collection==null&&(this.collection=new u);var n={menuItems:this.collection.models,_:t},r=t.template(o,n);e("#contextMenuButton").addClass("contextMenu"),this.$el.html(r),e("#rightMenu").empty().append(this.$el),this.setPrimaryAction(),this.collection.models.length==0&&this.hideMenu()},clickMainAppPageContent:function(t){e("#contextMenu").hasClass("hidden")||s.contextMenulastHasHiddenClass||e("#contextMenu").addClass("hidden"),s.contextMenulastHasHiddenClass=e("#contextMenu").hasClass("hidden")},initialize:function(t){e(window).off("click"),e(window).on("click",this.clickMainAppPageContent),s.lastHasClass=!0},events:{"click #contextMenuButton":"toggleMenu","click #btn-primary-action":"routeToPrimaryAction","click #contextMenu ul li a":"selectContextMenuItem"},selectContextMenuItem:function(e){e.preventDefault();var t=e.currentTarget.getAttribute("href"),n=e.currentTarget.getAttribute("id");if(t!="#")s.router.navigate(t,{trigger:!0});else{var r=this.collection.getActionById(n);this.callBack=r.get("callBack"),this.parentCallBack=r.get("parentCallBack"),this.callBack(this.parentCallBack)}this.toggleMenu()},routeToPrimaryAction:function(e){e.preventDefault(),this.closeMenu();if(this.primaryAction!="#")s.router.navigate(this.primaryAction,{trigger:!0});else{var t=this.collection.getPrimaryAction();this.callBack(this.parentCallBack)}},setPrimaryAction:function(){var t=this.collection.getPrimaryAction();t?(this.primaryAction=t.get("route"),this.callBack=t.get("callBack"),this.parentCallBack=t.get("parentCallBack"),e("#btn-primary-action").removeAttr("class"),t.get("iconClass")!=""?(e("#btn-primary-action").attr("class","btn btn-context "+t.get("iconClass")),e("#btn-primary-action").val("")):(e("#btn-primary-action").attr("class","btn btn-primary btn-context"),e("#btn-primary-action").val(t.get("title")))):(e("#btn-primary-action").removeAttr("class"),e("#btn-primary-action").attr("class","hidden"))},hideMenu:function(){e("#contextMenuButton").removeClass("contextMenu"),e("#contextMenu").html("")},toggleMenu:function(t){t!=undefined&&t.preventDefault(),e("#contextMenu").hasClass("hidden")?this.openMenu():this.closeMenu()},openMenu:function(){this.menuOpen=!0,e("#contextMenu").removeClass("hidden")},closeMenu:function(){this.menuOpen=!1,e("#contextMenu").addClass("hidden")}});return a}),define("models/home/MenuItemModel",["underscore","backbone","shared"],function(e,t,n){var r=t.Model.extend({defaults:{menuTitle:"",menuRoute:"",menuClass:"",menuIconClass:"",menuHasBadge:!1},initialize:function(){}});return r}),define("collections/home/MenuItemsCollection",["underscore","backbone","shared","models/home/MenuItemModel"],function(e,t,n,r){var i=t.Collection.extend({model:r,_data:{},initialize:function(e,t){},getInboxMenuItem:function(){var e={menuTitle:"Caixa de Entrada",menuRoute:"/Mail/Messages/1/0/INBOX#",menuClass:"inbox",menuIconClass:"icon-email",menuHasBadge:!0},t=new r(e);return t},getCalendarMenuItem:function(){var e={menuTitle:"Agenda",menuRoute:"/Calendar",menuClass:"calendar",menuIconClass:"icon-agenda"},t=new r(e);return t},getContactsMenuItem:function(){var e={menuTitle:"Contatos",menuRoute:"/Contacts/Personal",menuClass:"contacts",menuIconClass:"icon-contacts"},t=new r(e);return t},getChatMenuItem:function(){var e={menuTitle:"Chat",menuRoute:"/Chat",menuClass:"chat",menuIconClass:"icon-jabber",menuHasBadge:!0},t=new r(e);return t},getSettingsMenuItem:function(){var e={menuTitle:"Prefer&ecirc;ncias",menuRoute:"/Settings",menuClass:"settings",menuIconClass:"icon-settings"},t=new r(e);return t},getLogoutMenuItem:function(){var e={menuTitle:"Sair",menuRoute:"/Logout",menuClass:"logout",menuIconClass:"icon-logout"},t=new r(e);return t},getMenuItems:function(e){return n.userHasModule("mail")&&this.add(this.getInboxMenuItem()),n.userHasModule("calendar")&&this.add(this.getCalendarMenuItem()),n.userHasModule("catalog")&&this.add(this.getContactsMenuItem()),n.userHasModule("chat")&&this.add(this.getChatMenuItem()),n.userHasModule("settings")&&this.add(this.getSettingsMenuItem()),this.add(this.getLogoutMenuItem()),this.models}});return i}),define("views/home/MenuView",["jquery","underscore","iscroll","backbone","shared","views/mail/FoldersMenuListView","text!templates/home/menuTemplate.html","views/home/ContextMenuView","collections/home/ContextMenuCollection","collections/home/MenuItemsCollection"],function(e,t,n,r,i,s,o,u,a,f){var l=r.View.extend({el:e("#scrollerMenu"),profile:null,context:null,folderMenuLV:null,initialize:function(){this.context=new u},render:function(){var n=this;i.api.getLocalStorageValue("expresso",function(r){if(r!=null){var a=r.auth;a!=null&&i.api.auth(a),i.profile=r.profile,n.profile=i.profile}var l=new f,c=l.getMenuItems(i.profile.contactApps),h={user:n.profile,menuItems:c,_:t,Shared:i},p=t.template(o,h);n.$el.html(p),i.api.resource("Catalog/ContactPicture").params({contactID:n.profile.contactID,contactType:"2"}).done(function(t){t.contacts[0].contactImagePicture!=""&&(e("#userPicture").css("background-image","url('data:image/gif;base64,"+t.contacts[0].contactImagePicture+"')"),e("#userPicture").css("background-size","46px 61px"))}).fail(function(e){i.handleErrors(e)}).execute(),n.context=new u,i.userHasModule("mail")&&(n.folderMenuLV=new s,n.folderMenuLV.render())})},refreshFolders:function(){this.folderMenuLV=new s,this.folderMenuLV.render()},setQuota:function(t,n){var r=(t*100/n).toFixed(0);e("#usedQuota").width(r+"%"),e("#textQuota").html(r+"% ("+this.bytesToSize(t,0)+" / "+this.bytesToSize(n,0)+")")},bytesToSize:function(e,t){var n=1024,r=n*1024,i=r*1024,s=i*1024;return e>=0&&e<n?e+" B":e>=n&&e<r?(e/n).toFixed(t)+" KB":e>=r&&e<i?(e/r).toFixed(t)+" MB":e>=i&&e<s?(e/i).toFixed(t)+" GB":e>=s?(e/s).toFixed(t)+" TB":e+" B"},selectMenu:function(t){e("#mainMenu li").each(function(){e(this).removeClass("selected")}),t>=1&&t<=6&&e("#myFolders li").each(function(){e(this).hasClass("selected")&&e(this).removeClass("selected")}),t==1&&e("#mainMenu li.inbox").addClass("selected"),t==2&&e("#mainMenu li.calendar").addClass("selected"),t==3&&e("#mainMenu li.contacts").addClass("selected"),t==4&&e("#mainMenu li.chat").addClass("selected"),t==5&&e("#mainMenu li.settings").addClass("selected"),t==6&&e("#mainMenu li.logout").addClass("selected"),this.closeMenu()},toggleMenu:function(){return i.menuOpen?this.closeMenu():this.openMenu(),!1},openMenu:function(){i.menuOpen=!0;var t=e(window).width(),n=e(".top .menu").width(),r=Math.ceil(t*30/100);i.isBuiltInExpresso()&&(r=Math.ceil(t*15/100));var s=280;t-n<s?s=t-n:r>s&&(s=r),e("#menu").addClass("expanded").css("width",s),e("#page").css("margin-left",s),i.isBuiltInExpresso()&&e("#page").css("width",t-s),i.scrollMenu==null&&this.loaded(),i.scrollerRefresh()},closeMenu:function(){i.isBuiltInExpresso()||(i.menuOpen=!1,e("#menu").removeClass("expanded").removeAttr("style"),e("#page").removeAttr("style"),e("#page").css("margin-left","0"))},loaded:function(){i.scrollMenu!=null&&(i.scrollMenu.destroy(),i.scrollMenu=null),i.scrollMenu=new iScroll("menu")},setChatBadge:function(t){t>0?(e("#badge_chat").removeClass("hidden"),e("#badge_chat").html(t)):(e("#badge_chat").addClass("hidden"),e("#badge_chat").html(t))},setMailBadge:function(t){t>0?(e("#badge_inbox").removeClass("hidden"),e("#badge_inbox").html(t)):(e("#badge_inbox").addClass("hidden"),e("#badge_inbox").html(t))},renderContextMenu:function(e,t){this.context=new u;var n=new a;e=="detailMessage"&&(this.context.collection=n.getDetailMessageMenu(t.folderID,t.msgID,t.folderType,t.qtdMessages)),e=="messageList"&&(this.context.collection=n.getMessagesListMenu(t.folderID,t.folderName,t.folderType,t.qtdMessages)),e=="newMessage"&&(this.context.collection=n.getSendMessageMenu(t)),e=="newMessageWithCc"&&(this.context.collection=n.getSendMessageMenuWithCC(t)),e=="personalContacts"&&(this.context.collection=n.getPersonalContactsMenu()),e=="generalContacts"&&(this.context.collection=n.getGeneralContactsMenu()),e=="detailsContact"&&(this.context.collection=n.getDetailsContactMenu(t.email,t.contactID,t.contactType)),e=="calendar"&&(this.context.collection=n.getCalendarMenu(t.year,t.month,t.day)),e=="mailsignature"&&(this.context.collection=n.getMailSignatureMenu()),e=="changePassword"&&(this.context.collection=n.getChangePasswordMenu(t)),e=="calendarAddEvent"&&(this.context.collection=n.getCalendarAddEventMenu(t)),e=="calendarAddEventParticipant"&&(this.context.collection=n.getCalendarAddEventParticipantMenu(t)),e=="calendarDetailsEvent"&&(this.context.collection=n.getCalendarDetailsEventMenu(t.isOwner,t.eventID,t.year,t.month,t.day)),e=="editFolder"&&(this.context.collection=n.getEditFolderMenu(t)),e=="support"&&(this.context.collection=n.getSupportMenu(t)),e=="chatOffline"&&(this.context.collection=n.getChatOfflineMenu(t)),this.context.render()}});return l}),define("text!templates/home/homeTemplate.html",[],function(){return'<div id="menu" class="left expanded">\n  <div id="scrollerMenu">\n  </div>\n</div>\n<!-- fim menu -->\n  <div id="page" class="left">\n    <div id="pageSwipe" style=""></div>\n    <header id="pageHeader" class="topHeader">\n      <div id="isOffline" style="display: none; position: absolute; margin-left: 50px; margin-top: -10px;"><div style="padding-right: 0px; padding-top: 15px; margin: 0px; margin-top: 10px; height: 27px;" class="message error">Voc&ecirc; est&aacute; trabalhando OFF-LINE.</div></div>\n      <div id="pageMessage"></div>\n      <div style="margin-left: -3px; margin-top: 50px; z-index: 5000;" id="beta" class="hidden"></div>\n      <ul class="left topButtons">\n        <li><a id="menuButton" href="#" class="menu">Menu</a></li>\n      </ul> \n      \n      <div id="rightMenu">\n        \n      </div>\n\n    </header>\n\n    <div class="main">\n\n      <div id="content" class="left">\n        \n      </div>\n\n      <div id="contentDetail" class="left">\n        \n      </div>\n    </div>\n  </div>'}),define("views/home/HomeView",["jquery","underscore","iscroll","jquery_touchwipe","backbone","shared","collections/mail/MessagesCollection","collections/home/ServersCollection","views/mail/MessagesListView","views/mail/DetailMessageView","views/home/MenuView","text!templates/home/homeTemplate.html"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h=i.View.extend({folderID:"INBOX",msgID:"0",search:"",page:"1",profile:null,menuView:null,menuOpen:!1,initialize:function(){e(window).on("resize",this.refreshWindow);var t=new l;this.menuView=t,s.menuView=t},remove:function(){e(window).off("resize",this.refreshWindow),i.View.prototype.remove.apply(this,arguments)},render:function(){this.$el.html(c),this.$el.css("width","100%"),this.$el.css("height","100%"),e("#mainAppPageContent").empty().append(this.$el);var t=this;s.api.getLocalStorageValue("expresso",function(n){if(n!=null){s.profile=n.profile;var r=n.username,i=s.password;s.api.phoneGap(n.phoneGap),n.phoneGap?s.api.context(n.serverAPI).crossdomain(n.serverAPI):s.api.context(s.context).crossdomain(n.serverAPI)}s.userHasModule("chat")&&s.api.resource("Services/Chat").params({}).done(function(e){s.im_resource=e.A,s.im_url=e.B,s.im_domain=e.C;var t=e.D,n=e.E+"==";s.im.resource("EXPRESSO_MOBILE").url(s.im_url).domain(s.im_domain),s.im.username(t).password(n).connect()}).execute(),s.api.resource("ExpressoVersion").params({}).done(function(n){s.apiVersion=n.apiVersion,s.expressoVersion=n.expressoVersion,s.refreshSettings(),t.menuView=new l({el:e("#scrollerMenu")}),t.menuView.profile=t.profile,t.menuView.render(),s.isBuiltInExpresso()&&(e("#menuButton").hide(),t.menuView.openMenu()),s.setDefaultIMListeners(),s.BlinkWindowTitle(),s.gotoRoute==0?s.userHasModule("mail")?s.isSmartPhoneResolution()&&s.newMessageIntent==1?(s.newMessageIntent=!1,s.router.navigate("/Mail/Message/New",{trigger:!0})):(t.menuView.selectMenu(1),t.loadMessagesInFolder(t.folderID,t.search,"","1"),t.loaded()):s.userHasModule("calendar")?(t.menuView.selectMenu(2),s.router.navigate("/Calendar",{trigger:!0})):s.userHasModule("catalog")?(t.menuView.selectMenu(3),s.router.navigate("/Contacts/Personal",{trigger:!0})):s.userHasModule("chat")?(t.menuView.selectMenu(4),s.router.navigate("/Chat",{trigger:!0})):(t.menuView.selectMenu(5),s.router.navigate("/Settings",{trigger:!0})):t.loaded(),s.scheduleCheckForNewMessages(),e("#pageHeader").touchwipe({wipeLeft:function(){t.menuView.closeMenu(),s.scrollerRefresh()},wipeRight:function(){t.menuView.openMenu(),s.scrollerRefresh()},preventDefaultEvents:!0}),e("#pageSwipe").touchwipe({wipeLeft:function(){t.menuView.closeMenu(),s.scrollerRefresh()},wipeRight:function(){t.menuView.openMenu(),s.scrollerRefresh()},preventDefaultEvents:!0}),e("#menu").touchwipe({wipeLeft:function(){t.menuView.closeMenu(),s.scrollerRefresh()},wipeRight:function(){t.menuView.openMenu(),s.scrollerRefresh()},preventDefaultEvents:!0})}).execute()})},loadMessagesInFolder:function(e,t,n,r){this.msgID=n,s.menuView.setMailBadge(0);var i=new a({folderID:e,search:t,page:this.page,msgID:n});i.folderID=e,i.msgID=n,i.forceReload=r,i.render()},events:{"click #menuButton":"toggleMenu","click .listFolderItemLink":"selectFolderItem","click .menuLink":"selectMenuItem","click .listItemLink":"selectListItem","click body":"clickMainAppPageContent"},selectListItem:function(t){t.preventDefault(),e("#scrollerList li").each(function(){e(this).removeClass("selected")});var n=e(t.target).parent();n.hasClass("listItemLink")&&(n=n.parent()),n.addClass("selected"),s.router.navigate(t.currentTarget.getAttribute("href"),{trigger:!0})},selectMenuItem:function(e){e.preventDefault(),s.router.navigate(e.currentTarget.getAttribute("href"),{trigger:!0})},selectFolderItem:function(e){e.preventDefault(),s.router.navigate(e.currentTarget.getAttribute("href"),{trigger:!0})},toggleMenu:function(e){e!=undefined&&e.preventDefault(),this.menuView.toggleMenu()},toggleContextMenu:function(){this.menuView.context.toggleMenu()},refreshWindow:function(){var t=this,n=function(){var t=e(".topHeader").outerHeight(!0),n=e(".chatArea").outerHeight(true)==null?0:e(".chatArea").outerHeight(!0),r=e("#content .searchArea").outerHeight(true)==null?0:e("#content .searchArea").outerHeight(!0),i=e("#contentDetail .searchArea").outerHeight(true)==null?0:e("#contentDetail .searchArea").outerHeight(!0);s.forceSmartPhoneResolution==0&&s.isSmartPhoneResolution()&&(s.forceSmartPhoneResolution=!0),s.deviceType(s.forceSmartPhoneResolution),e("body").height(e(window).height()-t),e("#wrapper").css("top",t+r),e("#wrapperDetail").css("top",t+n+i),e("#scrollerDetail").css("width",e("#wrapperDetail").width()),e.each(e("#contentMessageBody img"),function(){var t=e("#wrapperDetail").width();t-=40;var n=e(this).height(),r=e(this).width(),i=t,s=t*(n/r);e("#contentMessageBody").width(t),e(this).css("height",s),e(this).css("width",i)}),s.scrollerRefresh()};clearTimeout(this.idResize),this.idResize=setTimeout(n,500)},loaded:function(){s.gotoRoute!=0&&(s.router.navigate(s.gotoRoute,{trigger:!0}),s.gotoRoute=!1);var t=e(".topHeader").outerHeight(!0);!s.isAndroid()&&s.isPhonegap()&&(t+=20);var n=e("#content .searchArea").outerHeight(true)==null?0:e("#content .searchArea").outerHeight(!0),r=e(window).width()<720;r&&(s.forceSmartPhoneResolution=!0),s.deviceType(s.forceSmartPhoneResolution),e("body").height(e(window).height()-t),e("#wrapper").css("top",t+n),s.betaVersion&&e("#beta").removeClass("hidden")},fillLocalStorageTest:function(){function g(){var n=e[v];c=n[0],h=n[1],p=n[2],d=n[3];var r=b(c,p)+b(h,d),i=""+r.length;if(!y(r)){t.innerHTML=m+" characters were stored successfully,  but "+i+" weren't.";return}t.innerHTML=i+" characters were stored successfully.",m=i,v++,v<e.length?setTimeout(g,0):t.innerHTML=m+" characters were saved successfully, test is stopped."}function y(e){try{return localStorage.test=e,!0}catch(t){return!1}}function b(e,t){var n=[];while(t--)n.push(e);return n.join("")}var e,t=document.getElementById("textQuota");if(!("localStorage"in window)){t.innerHTML="Your browser has no localStorage support.";return}var n="0123456789",r=b(n,10),i=b(r,10),s=b(i,10),o=b(s,10),u=b(o,10),a=b(u,10),f=[n,r,i,s,o,u,a];e=[];for(var l=1;l<f.length;l++){var c=f[l],h=f[l-1];for(var p=1;p<10;p++)for(var d=0;d<10;d++)e.push([c,h,p,d])}var v=0,m=0;g()}});return h}),define("libs/backbone/localstorage",["underscore","backbone"],function(e,t){function n(){return((1+Math.random())*65536|0).toString(16).substring(1)}function r(){return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()}var i=function(e){this.name=e;var t=localStorage.getItem(this.name);this.data=t&&JSON.parse(t)||{}};return e.extend(i.prototype,{save:function(){localStorage.setItem(this.name,JSON.stringify(this.data))},create:function(e){return e.id||(e.id=e.attributes.id=r()),this.data[e.id]=e,this.save(),e},update:function(e){return this.data[e.id]=e,this.save(),e},find:function(e){return this.data[e.id]},findAll:function(){return e.values(this.data)},destroy:function(e){return delete this.data[e.id],this.save(),e}}),t.sync=function(e,t,n){var r,i=t.localStorage||t.collection.localStorage;switch(e){case"read":r=t.id?i.find(t):i.findAll();break;case"create":r=i.create(t);break;case"update":r=i.update(t);break;case"delete":r=i.destroy(t)}r?n.success(r):n.error("Record not found")},i}),define("models/home/ExpressoModel",["underscore","backbone","shared"],function(e,t,n){var r=t.Model.extend({defaults:{auth:"",profile:{}},initialize:function(){}});return r}),define("collections/home/ExpressoCollection",["underscore","backbone","libs/backbone/localstorage","models/home/ExpressoModel"],function(e,t,n,r){var i=t.Collection.extend({model:r,localStorage:new n("Expresso")});return new i}),define("text!templates/settings/settingsFaqListTemplate.html",[],function(){return'<% if (elementID == "#mainAppPageContent") { %>\n<div id="page" class="left">\n    <div id="pageSwipe" style=""></div>\n    <header id="pageHeader" class="topHeader">\n      <div id="pageMessage"></div>\n      <ul class="left topButtons" style="margin: 10px;">\n      	<li><input id="btn-back" type="button" value="Voltar" class="btn btn-primary" style=""></li>\n      </ul> \n      \n      <div id="rightMenu">\n        \n      </div>\n\n    </header>\n\n    <div class="main">\n\n      <div id="content" class="left" style="width: 100%;">\n        \n\n\n<% } %>\n\n<h2 class="ellipsis50">Perguntas Frequentes</h2>\n<article id="wrapperDetail" class="container">\n	<div id="scrollerDetail">\n\n		<dl id="aboutExpresso">\n\n<!-- 			<div class="login-center" style="width: 245px; margin-top: 50px; margin-bottom: 50px;">\n			      <div class="product-logo"></div>\n			</div> -->\n\n			<!-- <br>- Qual servidor devo escolher?\n			<br>- Posso configurar o Aplicativo com meu usuário de outro serviço de Emails (GMAIL, YAHOO, etc)?\n			<br>- Como faço para criar uma conta do Expresso?\n			<br>- Como posso usar na minha Empresa/Instituição?\n			<br>- Já possuo o Expresso Livre instalado em minha empresa, porque meu servidor não aparece na lista de Servidores?\n			<br>- Em qual versão do Expresso Livre meu servidor deverá estar?\n			<br>- Em qual versão do iOS meu dispositivo deverá estar?\n			<br>- Em qual versão do Android meu dispositivo deverá estar?\n			<br>- Quais são os dispositivos suportados?\n			<br><br> -->\n			<br><br>\n			<dt>Qual servidor devo escolher?</dt>\n			<dd>\n			Você deve escolher o servidor de sua organização/instituição. Somente aparecem nesta lista servidores homologados a utilizar o aplicativo. Caso seu servidor não esteja sendo exibido na lista, entre em contato com o administrador do seu ambiente expresso, para que ele possa solicitar a liberação do seu servidor na lista de servidores homologados.\n			</dd>\n\n			<dt>Posso configurar o aplicativo com meu usuário de outro serviço de Emails (GMAIL, YAHOO, etc)?</dt>\n			<dd>Não, o aplicativo foi desenvolvido para acessar somente servidores homologados do Expresso.</dd>\n\n			<dt>Como faço para criar uma conta do Expresso?</dt>\n			<dd>\n			A criação de contas do expresso é responsabilidade do administrador de cada empresa/instituição que utiliza o Expresso. Caso você pertença a uma empresa que utiliza o Expresso e não tem uma conta, entre em contato com o administrador de sua organização.\n			</dd>\n\n			<dt>Como posso usar na minha Empresa/Instituição?</dt>\n			<dd>\n			Para que sua empresa/instituição possa utilizar o Expresso Mobile, o Expresso Livre deverá ser instalado em um servidor de emails da sua empresa/instituição. Siga o procedimento de instalação no site da comunidade: http://www.expressolivre.org/\n			</dd>\n\n			<dt>Já possuo o Expresso Livre instalado em minha empresa. Porque meu servidor não aparece na lista de Servidores?</dt>\n			<dd>\n			Para que você possa usar este aplicativo em sua empresa/instituição, Foi desenvolvido um módulo para o Expresso Livre que deverá ser adicionado à sua instalação do Expresso. Esse módulo deve ser homologado/autorizado pelos administradores da comunidade Expresso. Somente após essa autorização seu servidor será cadastrado para aparecer na lista de servidores. Caso você já possua este módulo instalado em seu ambiente clique aqui e entre em contato solicitando a liberação do seu servidor.\n			</dd>\n\n			<dt>Em qual versão do iOS meu dispositivo deverá estar?</dt>\n			<dd>\n				O Expresso para iOS é suportado a partir da versão 7.0 do iOS.\n			</dd>\n\n			<dt>Em qual versão do Android meu dispositivo deverá estar?</dt>\n			<dd>\n				O Expresso para Android é homologado para a versão 4.0 ou superior do Android.\n			</dd>\n\n			<dt>O Aplicativo é compatível com o Expresso V3?</dt>\n			<dd>\n				Não, o Expresso V3 não possui a API para dispositivos móveis, portanto não é compatível com este aplicativo.\n			</dd>\n\n			<% if (Shared.isIDevice()) { %>\n			<dt>Porque não recebo notificações de novos emails? (NOTIFICAÇÕES POR PUSH)</dt>\n			<dd>\n				As notificações de email ocorrem por um processo chamado de "Notificações por Push", e devido a algumas restrições da Apple o Expresso ainda não possui notificações por Push.<br>Obs: Nós entendemos que esta é uma funcionalidade essencial, e assim que estas restrições não existirem mais implementaremos essa funcionalidade.\n			</dd>\n			<% } %>\n\n			<dt>Quais são os dispositivos suportados?</dt>\n			<dd>\n				<ul>\n					<li>Smartphones com iOS a partir do iPhone 4S.</li>\n					<li>Smartphones com Android a partir do 4.0</li>\n					<li>Tablets com iOS a partir do iPad 2.</li>\n					<li>Tablets com Android a partir do 4.0</li>\n				</ul>\n				<br><br>\n				<br><br>\n				<br><br>\n				<br><br>\n				<br><br>\n			</dd>\n\n		</dl>\n  	</div>\n</article>\n\n<% if (elementID == "#mainAppPageContent") { %>\n      </div>\n    </div>\n  </div>\n<% } %>'}),define("views/settings/SettingsFaqListView",["jquery","underscore","backbone","shared","text!templates/settings/settingsFaqListTemplate.html"],function(e,t,n,r,i){var s=n.View.extend({elementID:"#content",render:function(){var n=this,s={_:t,elementID:this.elementID,Shared:r},o=t.template(i,s);this.$el.html(o),this.$el.css("width","100%"),this.$el.css("height","100%"),e(this.elementID).empty().append(this.$el),n.loaded()},loaded:function(){r.scrollDetail=new iScroll("wrapperDetail")},events:{"click #btn-back":"backButton"},backButton:function(e){e!=undefined&&e.preventDefault(),r.router.navigate("/",{trigger:!0})}});return s}),define("views/login/LoginView",["jquery","underscore","backbone","shared","models/mail/MessagesModel","collections/mail/MessagesCollection","text!templates/login/loginTemplate.html","views/home/LoadingView","views/home/HomeView","expressoIM","collections/home/ExpressoCollection","collections/home/ServersCollection","views/settings/SettingsFaqListView"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){var p=n.View.extend({errors:!1,render:function(){var n=new c,i=this;n.done(function(n){var s=!1;ORIGIN_SERVER!=undefined&&(s=!0);var u={servers:n.models,Shared:r,_:t,showClassicLink:s},a=t.template(o,u);i.$el.html(a),i.$el.attr("style","top: -53px; position: relative;"),e("#mainAppPageContent").empty().append(i.$el),r.betaVersion&&e("#beta").removeClass("hidden"),r.isAndroid()&&r.isPhonegap()&&r.forceLogout==0&&window.plugins.expresso!=null&&window.plugins.expresso.getAccounts("",function(e){r.automaticLoginAccounts=JSON.parse(e);var t=r.automaticLoginAccounts;if(r.automaticLoginAccounts.accounts.length>=1){if(r.forceAutomaticLoginInAccountName==0||r.automaticLoginAccounts.accounts.length==1)r.forceAutomaticLoginInAccountName=t.accounts[0].accountName;for(var n=0;n<t.accounts.length;n++)t.accounts[n]!=undefined&&r.forceAutomaticLoginInAccountName==t.accounts[n].accountName&&i.automaticLogin(t.accounts[n])}},function(){})}).fail(function(e){r.handleErrors(e)}).getServers()},events:{"click #btn-login":"login","keydown #username":"keydownUserName","keydown #password":"keydownPassword","click #helpLink":"showHelp","click #classicLink":"goBackToClassicVersion"},goBackToClassicVersion:function(e){ORIGIN_SERVER!=undefined&&(window.location.href=ORIGIN_SERVER+"?ignore_mobile=true")},showHelp:function(e){var t=new h({});t.elementID="#mainAppPageContent",t.render()},keydownUserName:function(t){t.which==13&&!t.shiftKey&&e("#password").focus()},keydownPassword:function(e){e.which==13&&!e.shiftKey&&this.login()},automaticLogin:function(e){this.loginUser(e.accountName,e.accountPassword,e.accountAPIURL)},login:function(t){var n=e("#username").val().toLowerCase(),r=e("#password").val(),i=e("#serverURL").val();this.loginUser(n,r,i)},loginUser:function(t,n,i){var s=r.api.phoneGap();s?r.api.context(i).crossdomain(i):r.api.context(r.context).crossdomain(i),this.errors=!1,n==""&&(r.showMessage({type:"error",icon:"icon-expresso",title:"Senha não informada/inválida!",description:"",elementID:"#pageMessage"}),this.errors=!0),t==""&&(r.showMessage({type:"error",icon:"icon-expresso",title:"Usuário não informado/inválido!",description:"",elementID:"#pageMessage"}),this.errors=!0);if(r.betaVersion){var o=!1;if(r.betaTesters.length>0){for(var f in r.betaTesters)t==r.betaTesters[f]&&(o=!0);o||(r.showMessage({type:"error",icon:"icon-expresso",title:"Este usuário não possui acesso a versão BETA!",description:"",elementID:"#pageMessage"}),this.errors=!0)}}var l=this;l.userName=t,l.serverURL=i;if(!l.errors){var c=new u({el:e("#loadingLogin")});c.render(),r.api.resource("Login").params({user:t,password:n}).done(function(e){if(e.profile[0].contactApps.length!=0){var o={auth:r.api.auth(),profile:e.profile[0],username:t,phoneGap:s,serverAPI:i};r.password=n,r.profile=o.profile,r.api.setLocalStorageValue("expresso",o),r.isAndroid()&&r.isPhonegap()&&(r.service!=undefined?(r.service.setConfig(i,r.api.auth(),t,n),r.service.startService(),setTimeout(function(){r.service.setConfig(i,r.api.auth(),t,n),r.service.enableTimer()},1e4)):console.log("undefined service"),window.plugins!=undefined&&window.plugins.expresso.createAccount({accountName:t,accountPassword:n,accountAuthToken:r.api.auth(),accountAPIURL:i},function(e){},function(e){}));var u=new a;return u.profile=e.profile[0],u.render(),r.showMessage({type:"success",icon:"icon-expresso",title:"Bem vindo ao Expresso!",description:"",timeout:2e3,elementID:"#pageMessage"}),!1}r.showMessage({type:"error",icon:"icon-expresso",title:"Este usuário não possui acesso a nenhum módulo neste servidor!",description:"",timeout:0,elementID:"#pageMessage"}),setTimeout(function(){r.router.navigate("",{trigger:!0})},2e3)}).fail(function(e){return e.error.code==5?r.showMessage({type:"error",icon:"icon-expresso",title:"Usuário ou senha inválidos!",description:"",timeout:0,elementID:"#pageMessage"}):r.showMessage({type:"error",icon:"icon-expresso",title:"Não foi possível efetuar o Login!",description:"",timeout:0,elementID:"#pageMessage"}),setTimeout(function(){r.router.navigate("",{trigger:!0})},2e3),!1}),r.api.ignoreCache(!0);var h=function(e){e!=undefined&&e.username!=undefined&&(e.username!=l.userName||e.serverAPI!=l.serverURL)&&r.api.setLocalStorageValue("expressoCache",[]),r.api.execute()};r.api.getLocalStorageValue("expresso",h,h)}return!1},logoutUser:function(t){e("#mainAppPageContent").empty();var n=new u({el:e("#mainAppPageContent")});n.render(),t==undefined&&(t=!0),r.forceLogout=t,r.api.resource("Logout").done(function(e){}).fail(function(e){r.handleErrors(e)}).execute(),r.scrollMenu=null,r.stopBlinkWindowTitle(),r.api.getLocalStorageValue("expresso",function(e){var t=r.api.phoneGap();e.auth="",e.profile="",e.username="",e.password="",e.phoneGap=t,e.serverAPI="",r.isAndroid()&&(r.service.disableTimer(),r.service.stopService()),r.api.setLocalStorageValue("expresso",e)}),r.router.navigate("Login",!0)}});return p}),define("text!templates/home/offlineTemplate.html",[],function(){return'  <div class="login-center" style="width: 245px; margin-top: 70px;">\n      <div class="product-logo"></div>\n      <br>\n      <br><br>\n      <span style="color: #000; font-size: 14px;">\n      A versão mobile está temporariamente indisponível.<br><br>\n    </span>\n  </div>'}),define("views/home/OfflineView",["jquery","underscore","backbone","shared","text!templates/home/offlineTemplate.html"],function(e,t,n,r,i){var s=n.View.extend({el:e("#mainAppPageContent"),render:function(){var e={_:t},n=t.template(i,e);this.$el.html(n)}});return s}),function(e){var t={collection:null,attr:null,noCase:!1,scrollable_ancestor_em:null,onselect:null,ul_class:"autocomplete",ul_css:null,li_class:null,li_css:null,width:null,max_results:null,attrID:"contactID"},n={init:function(r){return r||(r={}),this.each(function(){var i=e(this);i.data("autocomplete")&&n.destroy.apply(i);var s=i.attr("autocomplete");i.attr("autocomplete","off");var o=e("<ul>").addClass(r.ul_class||t.ul_class).hide().insertBefore(i);i.bind("focus.autocomplete",function(e){i.bind("blur.autocomplete",function(e){return i.unbind("blur.autocomplete"),i.unbind("keydown.autocomplete"),i.unbind("keyup.autocomplete"),o.hide(),!0}),i.bind("keydown.autocomplete",function(e){return n._inputKeydown.apply(i,[e])}),i.bind("keyup.autocomplete",function(e){return n._inputKeyup.apply(i,[e])})}),i.data("autocomplete",{target:i,oldAutocomplete:s,oldValue:null,list_em:o,options:e.extend({},t,r)})})},destroy:function(){return this.each(function(){var t=e(this),n=t.data("autocomplete");n.list_em.remove(),t.attr("autocomplete",n.oldAutocomplete),t.removeData("autocomplete")})},show:function(){var n=this,r=n.data("autocomplete"),i=r.options,s=i.collection,o=i.attr,u=r.list_em,a=e.trim(n.val()),f=a.toLowerCase(),l=[];s.each(function(e){var t=e.getSearchString(),n=e.getFirstEmailAddress();(t.indexOf(a)==0||i.noCase&&t.toLowerCase().indexOf(f)==0||n.indexOf(a)==0||i.noCase&&n.toLowerCase().indexOf(f)==0)&&l.push(e)});if(l.length==0)return u.hide(),this;i.max_results&&!isNaN(i.max_results)&&(l=l.slice(0,i.max_results)),u.empty();if(!u.is(":visible")){var c=n.position(),h=0,p=e(i.scrollable_ancestor_em);p.length&&(h=p.scrollTop());var d=c.left,v=c.top+h+n.outerHeight(!0);u.css({left:"10px",top:v}),i.ul_css&&u.css(i.ul_css),i.width?u.width(i.width):u.width(n.outerWidth(!0)+5),u.show()}for(var m=0;m<l.length;m++){var g=l[m],y=g.getSearchString(),b='<span class="emailInfo">&lt;'+g.getFirstEmailAddress()+"&gt;</span>"+g.get("contactFirstName")+" "+g.get("contactLastName"),w=e("<li>"+b+"</li>");w.mouseover(function(){e(this).addClass("selected").siblings(".selected").removeClass("selected")}),w.mouseleave(function(){e(this).removeClass("selected")}),w.mousedown(function(){var t=e(this).attr("model_id");return g=s.getContactByID(t),i.onselect?i.onselect(g):n.val(g.getFirstEmailAddress()),n.blur(),!1}),w.addClass(i.li_class).attr("model_id",g.get(t.attrID)),i.li_class&&w.addClass(li_class),i.li_css&&w.css(i.li_css),u.append(w)}return this},_inputKeydown:function(e){var t=this,n=t.data("autocomplete"),r=n.options,i=r.collection,s=n.list_em;if(e.keyCode==27)return e.preventDefault(),t.blur(),!1;if(e.keyCode==13||e.keyCode==9){var o=s.children("li.selected");o.length==0&&(s.children("li:first").addClass("selected"),o=s.children("li.selected"));if(o.length){var u=o.attr("model_id");model=i.getContactByID(u),r.onselect?(r.onselect(model),s.empty()):(this.val(model.getFirstEmailAddress()),s.empty())}return s.hide(),!0}if(e.keyCode==40){e.preventDefault();var o=s.children("li.selected");return o.length==0?s.children("li:first").addClass("selected"):o==s.children("li:last")?o.removeClass("selected"):o.removeClass("selected").next("li").addClass("selected"),!1}if(e.keyCode==38){e.preventDefault();var o=s.children("li.selected");return o.length==0?s.children("li:last").addClass("selected"):o==s.children("li:first")?o.removeClass("selected"):o.removeClass("selected").prev("li").addClass("selected"),!1}return!0},_inputKeyup:function(e){if(e.keyCode==27||e.keyCode==13||e.keyCode==9)return!0;var t=this,r=t.data("autocomplete"),i=r.list_em;if(r.oldValue==t.val())return!0;r.oldValue=t.val(),t.val().length==0?i.hide():n.show.apply(t);var s=i.children("li.selected");return s.length==0&&i.children("li:first").addClass("selected"),!1}};e.fn.autocomplete=function(t){if(n[t])return n[t].apply(this,Array.prototype.slice.call(arguments,1));if(typeof t=="object"||!t)return n.init.apply(this,arguments);e.error("Method "+t+" does not exist on jQuery.autocomplete")}}(jQuery),define("autocomplete",["jquery"],function(){}),define("models/contacts/ContactModel",["underscore","backbone","shared"],function(e,t,n){var r=t.Model.extend({defaults:{contactID:"",contactMails:[],contactPhones:[],contactAlias:"",contactFirstName:"",contactLastName:"",contactFullName:"",contactBirthDate:"",contactNotes:"",contactHasImagePicture:0,contactImagePicture:""},initialize:function(){this.api=n.api,this.readResource="/Catalog/Contacts",this.updateResource="",this.createResource="",this.deleteResource=""},getSearchString:function(){var e=this.get("contactFirstName")+" "+this.get("contactLastName")+" &lt;"+this.getFirstEmailAddress()+"&gt;";return e},getEmailString:function(){var e='"'+this.get("contactFirstName")+" "+this.get("contactLastName")+'"'+" <"+this.getFirstEmailAddress()+"> ,";return e},route:function(){return"/Contacts"},execute:function(){return this.api.execute()},done:function(e){return this.done=e,this},fail:function(e){return this.fail=e,this},getPersonalContact:function(e){var t=this;return this.api.resource("Catalog/Contacts").params({contactID:e,contactType:"1"}).done(function(e){var n=new r(e.contacts[0]);t.set(n),t.done&&t.done(n)}).fail(function(e){t.fail&&t.fail(e)}).execute(),t},getFirstEmailAddress:function(){return this.get("contactMails")[0]},addContact:function(e){var t=this;return this.api.resource("Catalog/ContactAdd").params(e).done(function(e){t.done&&t.done(e)}).fail(function(e){t.fail&&t.fail(e)}).execute(),t},deleteContact:function(e){var t=this;return this.api.resource("Catalog/ContactDelete").params(e).done(function(e){t.done&&t.done(e)}).fail(function(e){t.fail&&t.fail(e)}).execute(),t}});return r}),define("collections/contacts/DetailsContactCollection",["underscore","backbone","shared","models/contacts/ContactModel"],function(e,t,n,r){var i=t.Collection.extend({model:r,_data:{},_functions:{},done:function(e){return this._functions.done=e,this},fail:function(e){return this._functions.fail=e,this},initialize:function(e,t){this.api=n.api,this.model=r,this._functions={}},getPersonalContactDetails:function(e){var t=this;t._data={};var n=r,i=this._data;return this.api.resource("Catalog/Contacts").params({contactID:e,contactType:"1"}).done(function(e){for(var r in e.contacts){var i=new n(e.contacts[r]);t.add(i)}t._functions.done&&t._functions.done(t)}).fail(function(e){t._functions.fail&&t._functions.fail(e)}).execute(),t},getGeneralContactDetails:function(e){var t=this;t._data={};var n=r,i=this._data;return this.api.resource("Catalog/Contacts").params({search:"",contactID:e,contactType:"2"}).done(function(e){for(var r in e.contacts){var i=new n(e.contacts[r]);t.add(i)}t._functions.done&&t._functions.done(t)}).fail(function(e){t._functions.fail&&t._functions.fail(e)}).execute(),t},execute:function(){return this.api.execute()}});return i}),define("models/calendar/EventModel",["underscore","backbone","shared","models/contacts/ContactModel","collections/contacts/DetailsContactCollection"],function(e,t,n,r,i){var s=t.Model.extend({defaults:{eventID:"",eventDate:"",eventName:"",eventDescription:"",eventLocation:"",eventParticipants:[],eventParticipantsLdap:[],eventStartDate:"",eventEndDate:"",eventAllDay:"0",eventExParticipants:"",eventCategoryID:"",eventDateEnd:"",eventDateStart:"",eventDescription:"",eventOwner:"",eventOwnerIsParticipant:"",eventPriority:"",eventTimeEnd:"",eventTimeStart:"",eventType:""},initialize:function(){this.api=n.api,this.readResource="/Calendar/Events",this.updateResource="",this.createResource="",this.deleteResource=""},route:function(){return"/Calendar"},done:function(e){return this.done=e,this},fail:function(e){return this.fail=e,this},getEvent:function(e){var t=this;return this.api.resource("Calendar/Event").params({eventID:e}).done(function(e){t.set(e.events[0]),t.getEventOwner()}).fail(function(e){t.fail&&t.fail(e)}).execute(),t},getPriority:function(){var e=["-","Baixa","Normal","Alta"];return e[this.get("eventPriority")]},getEventParticipants:function(e){var t=this.get("eventParticipants"),n=[],r=this;for(var s in t)n.push(parseInt(t[s].contactUIDNumber));var o=JSON.stringify(n),u=new i;u.done(function(e){r.set({eventParticipantsLdap:e.models}),r.done&&r.done(r)}).fail(function(e){r.fail&&r.fail(e)}).getGeneralContactDetails(o)},getEventOwner:function(e){var t=this,n=new i;n.done(function(e){t.set({eventOwner:e.models[0]}),t.getEventParticipants()}).fail(function(e){t.fail&&t.fail(e)}).getGeneralContactDetails(this.get("eventOwner"))},saveEvent:function(e){var t=this;return this.api.ignoreCache(!0),this.api.resource("Calendar/AddEvent").params(e).done(function(e){var n=new s(e.events[0]);t.done&&t.done(n)}).fail(function(e){t.fail&&t.fail(e)}).execute(),t},deleteEvent:function(e){var t=this;return this.api.ignoreCache(!0),this.api.resource("Calendar/DelEvent").params({eventID:e}).done(function(e){t.done&&t.done(e)}).fail(function(e){t.fail&&t.fail(e)}).execute(),t},execute:function(){return this.api.execute()}});return s}),define("text!templates/master/detailContentTemplate.html",[],function(){return'<h2 id="contentDetailTitle" class="ellipsis50"></h2>\n\n<div class="searchArea">\n	<input type="text" class="searchField" value="" placeholder="Procurar Por:" />\n</div>\n\n<div id="messageDetail"></div>\n\n<div id="wrapperDetail" class="container">\n	<div id="scrollerDetail"></div>\n</div>'}),define("text!templates/master/primaryContentTemplate.html",[],function(){return'<h2 id="contentTitle" class="ellipsis50"  style="padding-left: 50px; background-position: 10px;"></h2>\n\n<div class="searchArea">\n	<input type="text" class="searchField" value="" placeholder="Procurar Por:" />\n</div>\n\n<div id="message"></div>\n\n<div id="wrapper" class="container">\n	<div id="scroller"></div>\n</div>'}),define("text!templates/calendar/calendarEditEventAddParticipantsTemplate.html",[],function(){return"<% if (typeof(contacts) != 'undefined' && contacts.length > 0) { %>\n\n	<dl id=\"participantsList\">\n\n		<% var summaryLetter = _.first(contacts).get('contactFirstName').charAt(0).toUpperCase(); %>\n\n		<dt><%=summaryLetter%></dt>\n		<dd>\n			<ul>\n				<% _.each(contacts, function(c) { %>\n\n					<% if (!_.isEqual(summaryLetter, c.get('contactFirstName').charAt(0).toUpperCase())) { %>\n					\n						<% summaryLetter = c.get('contactFirstName').charAt(0).toUpperCase(); %>\n						\n						</ul>\n							</dd>\n							<dt><%=summaryLetter%></dt>\n							<dd>\n								<ul>\n\n					<% } %>\n\n					<%\n						var checked = _.contains(listParticipants, c.get('contactUIDNumber')) ? \"checked='checked'\" : '';\n						var selected = _.contains(listParticipants, c.get('contactUIDNumber')) ? \" class='selected'\" : '';\n					%>\n\n					<li<%= checked %>>\n						\n\n						<input type=\"checkbox\" class=\"check css-checkbox\" <%= checked %> name=\"<%= c.get('contactUIDNumber') %>\" id=\"<%= c.get('contactUIDNumber') %>\" data-name=\"<%=c.get('contactFullName')%>\" data-mail=\"<%=c.get('contactMails')[0]%>\" value=\"<%= c.get('contactUIDNumber') %>\" />\n						<label class=\"css-label\" for=\"<%= c.get('contactUIDNumber') %>\"><%=c.get('contactFullName')%><br><%=c.get('contactMails')[0]%></label>\n					</li>					\n\n				<% }); %>\n\n			</ul>\n		</dd>\n	</dl>\n\n<% } else { %>\n\n	<% if (!_.isObject(error)) { %>\n\n		<p class=\"erro\">Nenhum registro encontrado</p>\n		\n	<% } %>\n\n<% } %>"}),define("collections/contacts/ContactsListCollection",["underscore","backbone","shared","models/contacts/ContactModel"],function(e,t,n,r){var i=t.Collection.extend({model:r,_data:{},_functions:{},done:function(e){return this._functions.done=e,this},fail:function(e){return this._functions.fail=e,this},initialize:function(e,t){this.api=n.api,this.model=r,this._functions={}},getContactByID:function(e){var t=!1;for(var n in this.models)this.models[n].get("contactID")==e&&(t=this.models[n]);return t},getContacts:function(e,t,i){var s=this;s._data={};var o=r,u=this._data;return n.api.resource("Catalog/Contacts").params({search:e,contactType:t}),i&&(console.log("ignoreCache"),n.api.ignoreCache(i)),n.api.done(function(e){for(var t in e.contacts){var n=new o(e.contacts[t]);s.add(n)}s._functions.done&&s._functions.done(s)}).fail(function(e){s._functions.fail&&s._functions.fail(e)}).execute(),s},getContactImagePicture:function(t,n){this.api.resource("Catalog/ContactPicture").params({contactID:this.pContactID,contactType:"2"}).done(function(t){n(e.first(t.contacts).contactImagePicture)}).fail(function(e){n("")}).execute()},execute:function(){return this.api.execute()}});return i}),define("views/calendar/CalendarEditEventAddParticipantsView",["jquery","underscore","backbone","shared","models/calendar/EventModel","views/home/LoadingView","text!templates/master/detailContentTemplate.html","text!templates/master/primaryContentTemplate.html","text!templates/calendar/calendarEditEventAddParticipantsTemplate.html","collections/contacts/ContactsListCollection"],function(e,t,n,r,i,s,o,u,a,f){var l=n.View.extend({model:i,listParticipants:[],senderName:"calendar",events:{"keypress .searchField":"searchGeneralContacts","click .css-checkbox":"addParticipant"},render:function(){this.listGeneralContacts("")},listGeneralContacts:function(n){var i=this,f,l,c;r.isSmartPhoneResolution()?(this.$el.html(t.template(u)),e("#content").empty().append(this.$el),f=e("#contentTitle"),l=e("#scroller"),c="#message"):(this.$el.html(t.template(o)),e("#contentDetail").empty().append(this.$el),f=e("#contentDetailTitle"),l=e("#scrollerDetail"),c="#messageDetail");var h=new s({el:l});h.render(),f.text("Adicionar participantes");var p=function(e){e.error==undefined?l.empty().append(t.template(a,e)):(e.error.code=="1001"&&r.showMessage({type:"chat-message",icon:"icon-contacts",title:"Sua busca deve ser específica.",route:"",description:"Procure pelo nome e sobrenome.<br>Nenhum resultado será exibido caso a sua busca retorne mais do que 200 contatos.",timeout:0,animate:!1,elementID:c}),e.error.code=="1019"&&r.showMessage({type:"error",icon:"icon-contacts",title:"Nenhum Resultado Encontrado.",route:"",description:"Procure pelo nome e sobrenome.<br>Nenhum resultado será exibido caso a sua busca retorne mais do que 200 contatos.",timeout:0,animate:!1,elementID:c}),l.empty()),i.setElement(i.$el),i.loaded()};this.listContacts(n,"2",p,p)},listContacts:function(e,n,r,i){var s=this,o=new f;o.done(function(n){r({contacts:n.models,search:e,listParticipants:s.model.get("eventParticipants"),_:t})}).fail(function(e){i({error:e.error,_:t})}).getContacts(e,n)},searchGeneralContacts:function(t){if(t.keyCode==13){var n=e(".searchField").val(),r="";n.length>=3?r=n:r="",(r.length>=3||this.searchLength>=3)&&this.listGeneralContacts(r),this.searchLength=n.length}},loaded:function(){var t=e(".topHeader").outerHeight(!0),n=e(".searchArea").outerHeight(true)==null?0:e(".searchArea").outerHeight(!0);r.isSmartPhoneResolution()?(e("#wrapper").css("top",t+n),r.scroll!=null&&(r.scroll.destroy(),r.scroll=null),r.scroll=new iScroll("wrapper")):(e("#wrapperDetail").css("top",t+n),r.scrollDetail!=null&&(r.scrollDetail.destroy(),r.scrollDetail=null),r.scrollDetail=new iScroll("wrapperDetail")),r.scrollerRefresh();var i={};i.saveCallBack=this.backToEditEvent,i.parentCallBack=this,r.menuView.renderContextMenu("calendarAddEventParticipant",i)},initialize:function(e){this.listParticipants=e.listParticipants,this.model=e.model,this.view=e.view},backToEditEvent:function(e){e.target&&(e.preventDefault(),e=this),e.senderName=="compose"?e.view.addContactToField({model:e.model,listParticipants:e.listParticipants}):e.view.render({model:e.model,listParticipants:e.listParticipants})},addParticipant:function(n){var r=this.model.get("eventParticipants"),i=this.listParticipants,s=e(n.target).val(),o=e(n.target).attr("data-name"),u=e(n.target).attr("data-mail"),a=t.isEmpty(r)?-1:t.indexOf(r,s),f=a;t.each(i,function(e,t){e.participantID==s&&e.participantName==o&&(f=t)}),e(n.target).is(":checked")?a==-1&&(r.push(s),i.push({participantID:s,participantName:o,participantMail:u})):a!=-1&&(r.splice(a,1),i.splice(f,1)),this.model.set({eventParticipants:r}),this.listParticipants=i}});return l}),define("text!templates/mail/composeMessageTemplate.html",[],function(){return'<h2 id="msgSubjectTitle" class="ellipsis50"><% if (message.get("msgSubject") != "") { %><%=message.get("msgSubject")%><% } else { %>Nova Mensagem<% } %></h2>\n<article id="wrapperDetail" class="container">\n	<div id="scrollerDetail">\n		<table id="messageDetails"> \n	        <tr id="msgToRow detailRow">\n		        <td class="item detailCol">\n		          Para:\n		        </td>\n		        <td class="descriptionCompose detailCol">\n		        	<% if (Shared.userHasModule("catalog")) { %>\n		        		<% if (Shared.apiVersion != "1.0") { %>\n		        		<div id="addMsgToField" class=\'icon-add\'></div>\n		        		<% } %>\n		        	<% } %>\n		        	<div id="msgToRecipients">\n						<% if (message.get("msgTo")) {  %>\n		                  	<% _.each(message.get("msgTo"), function(msgRecipient){ %>\n		                  		<div class="recipientmsgTo" data-mail="<%=msgRecipient.mailAddress%>">\n				                    <span class="badge badge-write-message">\n				                    <% if ($.trim(msgRecipient.fullName) != \'\') { %> \n				                      <%=$.trim(msgRecipient.fullName)%>\n				                    <% } else { %>\n				                      <%=msgRecipient.mailAddress%>\n				                    <% } %>\n				                    </span>\n				                    <input type="text" class="msgToInput hidden" value=\'<%=message.getEmailStringForMessageRecipient(msgRecipient)%>\'>\n			                	</div>\n		                  	<% }); %>\n		                <% } %>\n	            	</div>\n	                <input type="text" id="msgToInput" name="msgToInput" class="inputMessage" value="">\n	                <div class="clear"></div>\n		        </td>\n	    	</tr>\n		    <tr id="msgCcRow" class="detailRow <% if (message.get("msgCc").length == 0) {  %>hidden<% } %>">\n		        <td class="item detailCol">\n		          Cc:\n		        </td>\n		        <td class="descriptionCompose detailCol">\n		        	<% if (Shared.userHasModule("catalog")) { %>\n		        		<% if (Shared.apiVersion != "1.0") { %>\n		        			<div id="addMsgCcField" class=\'icon-add\'></div>\n		        		<% } %>\n		        	<% } %>\n		        	<div id="msgCcRecipients">\n						<% if (message.get("msgCc")) {  %>\n		                  	<% _.each(message.get("msgCc"), function(msgRecipient){ %>\n		                  		<div class="recipientmsgCc" data-mail="<%=msgRecipient.mailAddress%>">\n				                    <span class="badge badge-write-message">\n				                    <% if ($.trim(msgRecipient.fullName) != \'\') { %> \n				                      <%=$.trim(msgRecipient.fullName)%>\n				                    <% } else { %>\n				                      <%=msgRecipient.mailAddress%>\n				                    <% } %>\n				                    </span>\n				                    <input type="text" class="msgCcInput hidden" value=\'<%=message.getEmailStringForMessageRecipient(msgRecipient)%>\'>\n			                	</div>\n		                  	<% }); %>\n\n		                <% } %>\n	            	</div>\n	                <input type="text" id="msgCcInput" name="msgCcInput" class="inputMessage">\n	                <div class="clear"></div>\n		        </td>\n	    	</tr>\n	    	<tr id="msgBccRow" <% if (message.get("msgBcc").length == 0) {  %>class="hidden"<% } %>>\n		        <td class="item detailCol">\n		          Bcc:\n		        </td>\n		        <td class="descriptionCompose detailCol">\n		        	<% if (Shared.userHasModule("catalog")) { %>\n		        		<% if (Shared.apiVersion != "1.0") { %>\n		        			<div id="addMsgBccField" class=\'icon-add\'></div>\n		        		<% } %>\n		        	<% } %>\n		        	<div id="msgBccRecipients">\n						<% if (message.get("msgBcc")) {  %>\n		                  	<% _.each(message.get("msgBcc"), function(msgRecipient){ %>\n		                  		<div class="recipientmsgBcc" data-mail="<%=msgRecipient.mailAddress%>">\n				                    <span class="badge badge-write-message">\n				                    <% if ($.trim(msgRecipient.fullName) != \'\') { %> \n				                      <%=$.trim(msgRecipient.fullName)%>\n				                    <% } else { %>\n				                      <%=msgRecipient.mailAddress%>\n				                    <% } %>\n				                    </span>\n				                    <input type="text" class="msgBccInput hidden" value=\'<%=message.getEmailStringForMessageRecipient(msgRecipient)%>\'>\n			                	</div>\n		                  	<% }); %>\n		                <% } %>\n	            	</div>\n\n	                <input type="text" id="msgBccInput" name="msgBccInput" class="inputMessage">\n	                <div class="clear"></div>\n		        </td>\n	    	</tr>\n	    	<tr id="msgSubjectRow">\n		        <td class="item detailCol">\n		          Assunto:\n		        </td>\n		        <td class="descriptionCompose detailCol">\n		        	<input type="text" id="msgSubjectInput" name="msgSubject" class="inputMessage" value="<%=message.get("msgSubject")%>" autocorrect="off" autocapitalize="off" style="width: 70%;">\n		        </td>\n	    	</tr>\n	    	<tr id="msgAttachmentsRow" class="hidden detailRow">\n		        <td class="item detailCol">\n		          Anexos:\n		          <input type="file" id="attachment_input" name="attachment_input_temp" class="hidden">\n		        </td>\n		        <td class="descriptionCompose detailCol">\n		        	\n		        	<div id="msgAttachmentsRecipients">\n		        		\n		        		<% if (isDesktop) { %>\n		        		<div class="clear"></div>\n		        		<div id="add_attachment" class="icon-add-attachment"></div>\n						<div id="drop_zone_text">\n							Arraste e solte os arquivos aqui...\n						</div>\n						<% } %>\n						\n	            	</div>\n		        </td>\n	    	</tr>\n\n	    	\n	    	<tr id="msgBodyRow detailRow">\n	    		<td class="itemBody detailCol" colspan="2">\n	    			<div id="msgBodyInput" class="messageBodyInput" style="width: 100%;" contenteditable="true"><%=message.getMessageBody(withSignature,msgType,msgOriginal)%></div>\n	    		</td>\n	    	</tr>\n	    </table>\n	</div>\n</article>'}),define("views/mail/ComposeMessageView",["jquery","underscore","backbone","shared","autocomplete","views/calendar/CalendarEditEventAddParticipantsView","text!templates/mail/composeMessageTemplate.html","models/mail/MessagesModel","collections/mail/MessagesCollection","collections/home/ContextMenuCollection","views/mail/PreviewAttachmentMessageView","views/home/LoadingView","collections/contacts/ContactsListCollection"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){var p=n.View.extend({secondViewName:"",emailTo:"",msgID:"",folderID:"",currentMessage:"",addContactToField:function(e){for(var t=0,n;participant=e.listParticipants[t];t++)e.model.addRecipient(e.model.get("currentField"),participant.participantMail,participant.participantName);this.renderComposeMessage(e.model,!1)},renderComposeMessage:function(n,i,s,u){var a="#contentDetail";r.isSmartPhoneResolution()&&(a="#content");var f=!0;i==0&&(f=!1);var l={_:t,message:n,isDesktop:r.isDesktop(),withSignature:f,msgType:s,msgOriginal:u,Shared:r},c=t.template(o,l);this.$el.html(""),this.$el.html(c),e(a).empty().append(this.$el);if(r.isDesktop()){var h=this,p=function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},d=function(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer.files,n=r.currentDraftMessage.getQtdFiles();for(var i=0,s;s=t[i];i++)h.prependAttachmentImage(n,s.name,s.size,"binary",t[i]),r.currentDraftMessage.addBinaryFile(n,escape(s.name),t[i]),n+=1;h.updateBody()},v=document.getElementById("msgAttachmentsRecipients");e(v).addClass("drop_zone"),e("#msgAttachmentsRow").removeClass("hidden"),v.addEventListener("dragover",p,!1),v.addEventListener("drop",d,!1),this.setupAutoComplete()}this.renderContextMenu(),this.loaded()},renderAttachments:function(e){this.showAttachments(),r.currentDraftMessage.clearFiles();if(e!=undefined){var t=e.get("msgAttachments");for(var n in t){var i=t[n],s=new l;s.fileID=i.attachmentID,s.fileName=i.attachmentName,s.fileSize=i.attachmentSize,s.fileEncoding=i.attachmentEncoding,s.fileIndex=i.attachmentIndex,s.msgID=e.get("msgID"),s.folderID=e.get("folderID"),s.fileData="",s.previewType="compose";var o=function(e,t,n,i){r.currentDraftMessage.addFile(e,t,n,i)};s.forceDownloadFile=o,s.render()}}},setupAutoComplete:function(){if(r.userHasModule("catalog")){var t=this,n=new h;n.done(function(n){var r=t,i=function(t){var n="msgTo";e("#"+n+"Input").val(""),r.prependEmailRecipientBadgeToDiv(n,"#"+n+"Recipients",t.getEmailString(),t.get("contactFirstName")+" "+t.get("contactLastName"))},s=function(t){var n="msgCc";e("#"+n+"Input").val(""),r.prependEmailRecipientBadgeToDiv(n,"#"+n+"Recipients",t.getEmailString(),t.get("contactFirstName")+" "+t.get("contactLastName"))},o=function(t){var n="msgBcc";e("#"+n+"Input").val(""),r.prependEmailRecipientBadgeToDiv(n,"#"+n+"Recipients",t.getEmailString(),t.get("contactFirstName")+" "+t.get("contactLastName"))};e("#msgToInput").autocomplete({collection:n,attr:"contactSearchString",attrID:"contactID",noCase:!0,width:"95%",onselect:i,ul_class:"autocomplete shadow",ul_css:{"z-index":1234},max_results:10}),e("#msgCcInput").autocomplete({collection:n,attr:"contactSearchString",attrID:"contactID",noCase:!0,width:"95%",onselect:s,ul_class:"autocomplete shadow",ul_css:{"z-index":1234},max_results:10}),e("#msgBccInput").autocomplete({collection:n,attr:"contactSearchString",attrID:"contactID",noCase:!0,width:"95%",onselect:o,ul_class:"autocomplete shadow",ul_css:{"z-index":1234},max_results:10})}).fail(function(e){}).getContacts("","1")}},getContextMenuParams:function(){var e={};return e.sendCallBack=this.sendMessage,e.addCcBccCallBack=this.addCcBcc,e.removeCcBccCallBack=this.removeCcBcc,e.takePictureCallBack=this.takePicture,e.selectAttachmentFileCallBack=this.selectAttachmentFile,e.selectPictureCallBack=this.selectPicture,e.parentCallBack=this,e},renderContextMenu:function(){var t=this.getContextMenuParams();e("#msgCcRow").hasClass("hidden")?r.menuView.renderContextMenu("newMessage",t):r.menuView.renderContextMenu("newMessageWithCc",t)},sendMessage:function(t){var n=t,i="#contentDetail";r.isSmartPhoneResolution()&&(i="#content");var s=function(e){var t=JSON.parse(e);if(t.error==undefined)var n={type:"success",icon:"icon-email",title:"Mensagem enviada com sucesso!",description:"",elementID:"#pageMessage"};else var n={type:"error",icon:"icon-email",title:"Sua Mensagem não pode ser enviada!",description:"",elementID:"#pageMessage"};r.showMessage(n),r.router.navigate("/Mail/Messages/1/0/INBOX",{trigger:!0})},o=function(e){var t={type:"error",icon:"icon-email",title:"Ocorreu um erro ao enviar a mensagem!",description:e.message,elementID:"#pageMessage"};r.showMessage(t),r.router.navigate("/Mail/Messages/1/0/INBOX",{trigger:!0})},u=t.getNewMessageModel(),a=t.getMessageStringForRecipient("msgTo"),f=!1;if(a==""){var l={type:"error",icon:"icon-email",title:"Campo 'Para:' Não informado/Inválido!",description:"",elementID:"#pageMessage"};r.showMessage(l),f=!0}var h=u.checkAttachments(!1);if(h!=1){var l={type:"error",icon:"icon-email",title:h,description:"",elementID:"#pageMessage"};r.showMessage(l),f=!0}if(!f){var p=new c({el:e(i)});p.render(),u.send(s,o)}},onFailUploadPicture:function(e){r.showMessage({type:"warning",icon:"icon-email",title:"Não foi possível adicionar a foto aos anexos!",description:"",elementID:"#pageMessage"})},uploadPicture:function(e){var t=r.currentView;t.showAttachments();var n=r.currentDraftMessage.getQtdFiles();t.prependAttachmentImage(n,"Foto "+n+".png","","base64",e),r.currentDraftMessage.addFile(n,e,"Foto "+n+".png","base64"),t.renderContextMenu()},selectPicture:function(e){r.isPhonegap()&&navigator.camera!=undefined?(r.currentView=e,navigator.camera.getPicture(e.uploadPicture,e.onFailUploadPicture,{quality:60,destinationType:Camera.DestinationType.DATA_URL,sourceType:Camera.PictureSourceType.PHOTOLIBRARY})):r.showMessage({type:"error",icon:"icon-email",title:"Seu dispositivo não possui câmera!",description:"",elementID:"#pageMessage"})},takePicture:function(e){r.isPhonegap()&&navigator.camera!=undefined?(r.currentView=e,navigator.camera.getPicture(e.uploadPicture,e.onFailUploadPicture,{quality:60,destinationType:Camera.DestinationType.DATA_URL})):r.showMessage({type:"error",icon:"icon-email",title:"Seu dispositivo não possui câmera!",description:"",elementID:"#pageMessage"})},selectAttachmentFile:function(t){r.currentView=t,e("#attachment_input").click(),t.renderContextMenu()},addAttachmentFile:function(t){t.stopPropagation(),t.preventDefault(),e("#msgAttachmentsRow").removeClass("hidden");var n=this,i=t.target.files;for(var s=0,o;o=i[s];s++){var u=r.currentDraftMessage.getQtdFiles();n.prependAttachmentImage(u,o.name,o.size,"binary",i[s]),r.currentDraftMessage.addBinaryFile(u,escape(o.name),i[s])}var a=e("#attachment_input");a.replaceWith(a=a.clone(!0))},render:function(){var t="#contentDetail",n=this;r.isSmartPhoneResolution()&&(t="#content");if(this.secondViewName=="New"){var i=new u;i.set("msgSubject",""),i.set("msgTo",[]),i.set("msgCc",[]),i.set("msgBcc",[]),i.set("msgBody",""),i.clearFiles(),e.trim(this.emailTo)!=""&&i.addRecipient("msgTo",this.emailTo,"");var n=this;n.renderComposeMessage(i,!0,"new"),e("#msgAttachmentsRow").removeClass("hidden");var s=function(t){r.currentDraftMessage=t;var i=r.currentDraftMessage.get("files");r.isDesktop()||e("#msgAttachmentsRecipients").empty();for(var s=0,o;o=i[s];s++)n.prependAttachmentImage(o.fileID,o.filename,o.fileSize,o.dataType,o.src)};i.addNewMessageFiles(s)}if(this.secondViewName=="DelMessage"){var o=new c({el:e(t)});o.render();var n=this,f=function(){r.showMessage({type:"success",icon:"icon-email",title:"Mensagem apagada com sucesso!",description:"",elementID:"#pageMessage"});var t={msgID:n.msgID,folderID:n.folderID},i=new u(t);r.isTabletResolution()?e("#"+i.listItemID()).animate({opacity:.25,height:"toggle"},1e3,function(){e("#"+i.listItemID()).remove(),e("#scrollerList li:first").addClass("selected"),e("#"+i.listItemID()).animate({opacity:1},1e3,function(){});var t=0,s=0;if(e("#scrollerList li:first").length!==0){var o=e("#scrollerList li:first").attr("id").split("_");t=o[o.length-1]}t==undefined&&(t=0,s=1),r.router.navigate("/Mail/Messages/"+s+"/"+t+"/"+n.folderID,{trigger:!0})}):r.router.navigate("/Mail/Messages/1/0/"+n.folderID,{trigger:!0})},l=function(){r.showMessage({type:"error",icon:"icon-email",title:"Não foi possível apagar a mensagem selecionada!",description:"",elementID:"#pageMessage"}),r.router.navigate("/Mail/Messages/1/0/"+n.folderID+"#",{trigger:!0})},h={msgID:this.msgID,folderID:this.folderID},p=new u(h);p.delete(f,l)}if(this.secondViewName=="ReplyToAll"){var d=function(e){var t=e.models[0],i=new u,s=t.get("msgFrom"),o=t.get("msgTo"),a=t.get("msgCC"),f=t.get("msgBcc"),l=r.profile.contactMails[0];i.set("msgTo",[]),i.set("msgCc",[]),i.set("msgBcc",[]),i.addRecipient("msgTo",s.mailAddress,s.fullName);for(var c in o)o[c].mailAddress!=s.mailAddress&&o[c].mailAddress!=l&&i.addRecipient("msgCc",o[c].mailAddress,o[c].fullName);for(var c in a)i.addRecipient("msgCc",a[c].mailAddress,a[c].fullName);i.set("msgSubject","Re: "+t.get("msgSubject")),r.currentDraftMessage=i,n.renderComposeMessage(i,!0,"reply",t)},v=function(){},o=new c({el:e(t)});o.render();var m=new a;m.getMessageByID(this.folderID,this.msgID).done(d).fail(v).execute()}if(this.secondViewName=="ReplyMessage"){var d=function(e){var t=e.models[0],i=new u,s=t.get("msgFrom");i.set("msgTo",[]),i.addRecipient("msgTo",s.mailAddress,s.fullName),i.set("msgSubject","Re: "+t.get("msgSubject")),r.currentDraftMessage=i,n.renderComposeMessage(i,!0,"reply",t)},v=function(){},o=new c({el:e(t)});o.render();var m=new a;m.getMessageByID(this.folderID,this.msgID).done(d).fail(v).execute()}if(this.secondViewName=="Forward"){var g=function(e){var t=e.models[0],i=new u;i.set("msgID",t.get("msgID")),i.set("folderID",t.get("folderID")),i.set("msgTo",[]),i.set("msgCc",[]),i.set("msgBcc",[]),i.set("msgSubject","Fw: "+t.get("msgSubject")),r.currentDraftMessage=i,t.get("msgHasAttachments")=="1"&&(i.set("msgHasAttachments","1"),i.set("msgAttachments",t.get("msgAttachments")),i.set("files",t.get("files"))),n.renderComposeMessage(i,!0,"forward",t),t.get("msgHasAttachments")=="1"&&n.renderAttachments(r.currentDraftMessage)},y=function(){},o=new c({el:e(t)});o.render();var m=new a;m.getMessageByID(this.folderID,this.msgID).done(g).fail(y).execute()}},addCcBcc:function(e){e.toggleCCBcc();var t=e.getContextMenuParams();r.menuView.renderContextMenu("newMessageWithCc",t)},removeCcBcc:function(e){e.toggleCCBcc();var t=e.getContextMenuParams();r.menuView.renderContextMenu("newMessage",t)},events:{"keydown #msgToInput":"addRecipientTo","keydown #msgCcInput":"addRecipientTo","keydown #msgBccInput":"addRecipientTo","keydown #msgSubjectInput":"updateSubject","keydown #msgBodyInput":"updateBody","click #msgToRow":"focusRecipientTo","click #msgCcRow":"focusRecipientCc","click #msgBccRow":"focusRecipientBcc","click #msgSubjectRow":"focusSubject","click #addMsgToField":"addMsgToField","click #addMsgCcField":"addMsgCcField","click #addMsgBccField":"addMsgBccField","dblclick .recipientmsgTo":"removeRecipientMsgTo","dblclick .recipientmsgCc":"removeRecipientMsgCc","dblclick .recipientmsgBcc":"removeRecipientMsgBcc","touch .recipientmsgTo":"removeRecipientMsgTo","touch .recipientmsgCc":"removeRecipientMsgCc","touch .recipientmsgBcc":"removeRecipientMsgBcc","change #attachment_input":"addAttachmentFile","click #add_attachment":"selectAttachmentFile"},removeRecipientMsgTo:function(t){var n=e(t.currentTarget).attr("data-mail");e(t.currentTarget).remove(),r.currentDraftMessage.removeRecipient("msgTo",n)},removeRecipientMsgCc:function(t){var n=e(t.currentTarget).attr("data-mail");e(t.currentTarget).remove(),r.currentDraftMessage.removeRecipient("msgCc",n)},removeRecipientMsgBcc:function(t){var n=e(t.currentTarget).attr("data-mail");e(t.currentTarget).remove(),r.currentDraftMessage.removeRecipient("msgBcc",n)},addMsgToField:function(e){this.updateCurrentDraftMessage();var t=r.currentDraftMessage,n={currentField:"msgTo",eventParticipants:[],listParticipants:[]};t.set(n);var i=new s({listParticipants:[],model:t,view:new p,senderName:"compose"});i.senderName="compose",i.render()},addMsgCcField:function(e){this.updateCurrentDraftMessage();var t=r.currentDraftMessage,n={currentField:"msgCc",eventParticipants:[],listParticipants:[]};t.set(n);var i=new s({listParticipants:[],model:t,view:new p,senderName:"compose"});i.senderName="compose",i.render()},addMsgBccField:function(e){this.updateCurrentDraftMessage();var t=r.currentDraftMessage,n={currentField:"msgBcc",eventParticipants:[],listParticipants:[]};t.set(n);var i=new s({listParticipants:[],model:t,view:new p,senderName:"compose"});i.senderName="compose",i.render()},updateSubject:function(t){var n=e(t.currentTarget).val();e("#msgSubjectTitle").html(n),t.which==13&&!t.shiftKey&&e("#msgBodyInput").focus()},updateBody:function(e){r.scrollerRefresh()},focusRecipientTo:function(t){e("#msgToInput").focus()},focusRecipientCc:function(t){e("#msgCcInput").focus()},focusRecipientBcc:function(t){e("#msgBccInput").focus()},focusSubject:function(t){e("#msgSubjectInput").focus()},showAttachments:function(t){e("#msgAttachmentsRow").removeClass("hidden")},addRecipientTo:function(t){var n=e(t.currentTarget).val(),i="msgTo",s="msgCc";e(t.currentTarget).attr("id")=="msgToInput"&&(i="msgTo",e("#msgCCBcc").hasClass("hidden")?s="msgSubject":s="msgCc"),e(t.currentTarget).attr("id")=="msgCcInput"&&(i="msgCc",s="msgBcc"),e(t.currentTarget).attr("id")=="msgBccInput"&&(i="msgBcc",s="msgSubject"),e(t.currentTarget).attr("id")=="msgSubjectInput"&&(s="msgBody");if(t.which==13&&!t.shiftKey||t.which==32||t.which==188||t.which==59)this.validateEmail(e.trim(n))?(e(t.currentTarget).val(""),this.prependEmailRecipientBadgeToDiv(i,"#"+i+"Recipients",n),(t.which==188||t.which==59||t.which==32)&&t.preventDefault()):(t.which==13&&!t.shiftKey&&n==""||t.which==9)&&e("#"+s+"Input").focus();t.which==8&&e.trim(n)==""&&(r.currentDraftMessage.removeRecipient(i,e("#"+i+"Recipients div:last-child").attr("data-mail")),e("#"+i+"Recipients div:last-child").remove())},prependAttachmentImage:function(e,t,n,r,i){var s=new l;s.fileID=e,s.fileName=t,s.fileSize=n,s.fileType=r,s.fileData=i,s.render(),this.updateBody()},prependEmailRecipientBadgeToDiv:function(t,n,i,s){var o=e("<div />").addClass("recipient"+t).attr("data-mail",i),u=e("<span />").addClass("badge").addClass("badge-write-message");s==undefined?u.html(i):u.html(s);var a=e("<input />").attr("type","text").addClass("hidden").addClass(t+"Input").attr("name",t+"Input").attr("value",i);u.appendTo(o),a.appendTo(o),r.currentDraftMessage.addRecipient(t,i,""),o.appendTo(e(n))},validateEmail:function(e){var t=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;return t.test(e)},getMessageStringForRecipient:function(t){var n="",r=e("."+t+"Input").length;return e("."+t+"Input").each(function(t,i){n+=e(i).val(),t<r-1&&(n+=", ")}),e("#"+t+"Input").val()!=""&&(n=n+", "+e("#"+t+"Input").val()),n},restoreDraftMessage:function(){var t=r.currentDraftMessage,n=t.get("msgSubject");n!=""&&e("#msgSubjectTitle").html(t.get("msgSubject")),e("#msgSubjectInput").val(n),e("#msgBodyInput").html(t.get("msgBody"))},updateCurrentDraftMessage:function(){var e=this.getNewMessageModel();r.currentDraftMessage=e},getNewMessageModel:function(){var t={};r.currentDraftMessage&&(t=r.currentDraftMessage.get("files"));var n=this.getMessageStringForRecipient("msgTo"),i=e("#msgSubjectInput").val(),s=this.getMessageStringForRecipient("msgCc"),o=this.getMessageStringForRecipient("msgBcc"),a=e("#msgBodyInput").html(),f={msgTo:r.currentDraftMessage.get("msgTo"),msgCc:r.currentDraftMessage.get("msgCc"),msgBcc:r.currentDraftMessage.get("msgBcc"),msgToString:n,msgCcString:s,msgBccString:o,msgSubject:i,msgBody:a,msgType:"html"},l=new u(f),c="base64,";return l.clearFiles(),l.set("files",t),l},toggleCCBcc:function(){e("#msgCcRow").hasClass("hidden")?(e("#msgCcRow").removeClass("hidden"),e("#msgBccRow").removeClass("hidden")):(e("#msgCcRow").addClass("hidden"),e("#msgBccRow").addClass("hidden"))},refreshWindowHeight:function(){var t=e(".topHeader").outerHeight(!0),n=e("#composeMessageHeader").outerHeight(true)==null?0:e("#composeMessageHeader").outerHeight(!0);e("#msgBody").height(e(window).height()-t-n),r.scrollerRefresh()},loaded:function(){r.scrollDetail!=null&&(r.scrollDetail.destroy(),r.scrollDetail=null),this.refreshWindowHeight();var t=e("#msgBodyInput").width(),n=e("#contentDetail").width();r.isTabletResolution()?t+13>=n&&e("#scrollerDetail").width(t+13):e("#scrollerDetail").width("100%"),r.scrollDetail=new iScroll("wrapperDetail",{vScroll:!0,hScroll:!0,hScrollBar:!0,vScrollBar:!0,zoom:!0})}});return p}),define("text!templates/mail/editFolderTemplate.html",[],function(){return'<h2 class="ellipsis50"><%=title%></h2>\n<article id="wrapperDetail" class="container">\n	<div id="scrollerDetail">\n		<form id="changePassword">\n			<ol>\n				<li>\n					<input type="text" name="folderName" id="folderName" placeholder="Nome da Pasta" value="<%=folderName%>" />\n					<input type="hidden" name="folderID" id="folderID" value="<%=folderID%>" />\n					<input type="hidden" name="parentFolderID" id="parentFolderID" value="<%=parentFolderID%>" />\n					<input type="hidden" name="folderAction" id="folderAction" value="<%=folderAction%>" />\n				</li>\n			</ol>\n		</form>\n  	</div>\n</article>'}),define("views/mail/EditFolderView",["jquery","underscore","backbone","shared","text!templates/mail/editFolderTemplate.html","collections/mail/FoldersCollection"],function(e,t,n,r,i,s){var o=n.View.extend({action:"addFolder",folderID:"",folderName:"Nova Pasta",parentFolderID:"INBOX",render:function(){this.elementID="#content";if(this.action=="renameFolder"){title="Renomear Pasta";var t=new s,n=this;t.getFolders(this.folderID,this.search).done(function(e){var t=e.getFolderByID(n.folderID);n.folderName=t.get("folderName"),n.renderView()}).fail(function(t){return r.handleErrors(t.error),e(n.elementID).empty(),e(n.detailElementID).empty(),!1}).execute()}else this.renderView()},renderView:function(){var n="";this.action=="addFolder"&&(n="Adicionar Pasta"),this.action=="renameFolder"&&(n="Renomear Pasta");var s={_:t,title:n,folderName:this.folderName,folderID:this.folderID,parentFolderID:this.parentFolderID,folderAction:this.action},o=t.template(i,s);this.$el.html(o),e(this.elementID).empty().append(this.$el);var u={};u.saveCallBack=this.saveFolder,u.parentCallBack=this,r.menuView.renderContextMenu("editFolder",u),this.loaded()},cleanTrash:function(e){var t=new s;t.cleanTrash().done(function(t){var n={type:"success",icon:"icon-email",title:"Lixeira foi esvaziada com sucesso!",description:"",elementID:"#pageMessage"};r.showMessage(n),r.menuView.refreshFolders(),r.router.navigate("/Mail/Messages/1/0/"+e+"#",{trigger:!0})}).fail(function(t){var n={type:"error",icon:"icon-email",title:"Não foi possível esvaziar a lixeira!",description:"",elementID:"#pageMessage"};r.showMessage(n),r.router.navigate("/Mail/Messages/1/0/"+e+"#",{trigger:!0})}).execute()},saveFolder:function(){var t=e("#folderAction").val(),n=e("#folderName").val(),i=e("#folderID").val(),o=e("#parentFolderID").val(),u=new s;t=="addFolder"&&u.addFolder(n,o).done(function(e){var t={type:"success",icon:"icon-email",title:"Nova pasta adicionada com sucesso!",description:"",elementID:"#pageMessage"};r.showMessage(t),r.deviceType(r.isSmartPhoneResolution()),r.menuView.refreshFolders(),r.router.navigate("/Mail/Messages/1/0/"+e.folderID+"#",{trigger:!0})}).fail(function(e){var t={type:"error",icon:"icon-email",title:"Não foi possível adicionar esta pasta!",description:"",elementID:"#pageMessage"};e.error.code=="1011"&&(t.title="Não foi possível adicionar uma pasta com esse nome!"),e.error.code=="1011"&&(t.title="Não foi possível adicionar uma pasta com esse nome!"),r.showMessage(t)}).execute(),t=="renameFolder"&&u.renameFolder(n,i).done(function(e){var t={type:"success",icon:"icon-email",title:"Pasta renomeada com sucesso!",description:"",elementID:"#pageMessage"};r.showMessage(t),r.deviceType(r.isSmartPhoneResolution()),r.menuView.refreshFolders(),r.router.navigate("/Mail/Messages/1/0/"+e.folderID+"#",{trigger:!0})}).fail(function(e){var t={type:"error",icon:"icon-email",title:"Não foi possível renomear esta pasta!",description:"",elementID:"#pageMessage"};e.error.code=="1011"&&(t.title="Não foi possível adicionar uma pasta com esse nome!"),r.showMessage(t)}).execute()},deleteFolder:function(e){var t=new s;t.deleteFolder(e).done(function(e){var t={type:"success",icon:"icon-email",title:"A pasta foi excluída com sucesso!",description:"",elementID:"#pageMessage"};r.showMessage(t),r.menuView.refreshFolders(),r.router.navigate("/Mail/Messages/1/0/INBOX#",{trigger:!0})}).fail(function(e){var t={type:"error",icon:"icon-email",title:"Não foi possível excluir esta pasta!",description:"",elementID:"#pageMessage"};r.showMessage(t)}).execute()},loaded:function(){var e=this;r.scrollDetail=new iScroll("wrapperDetail"),r.deviceType(!0)}});return o}),define("text!templates/settings/settingsListTemplate.html",[],function(){return'<h2 id="contentTitle" class="ellipsis50 icon-settings" style="padding-left: 50px; background-position: 10px;">Prefer&ecirc;ncias</h2>\n<div id="wrapper" class="container">\n	<div id="scroller">\n\n		<dl id="settingsList">\n			<% if (Shared.apiVersion != "1.0") { %>\n			<dt>Conta de e-mail</dt>\n			<dd>\n				<ul>\n\n					<li><% if (Shared.userHasModule("catalog")) { %>\n						<a href="/Contacts/General/<%=user.contactUIDNumber%>" class="settinsLink"><% if (!_.isNull(user.contactMails[0])) { %><%=user.contactMails[0]%><% } %></a>\n					<% } else { %>\n							<% if (!_.isNull(user.contactMails[0])) { %><%=user.contactMails[0]%><% } %>\n						<% } %>\n					</li>\n					<!-- <li>\n\n						<div id="automaticLogin" class="onoffswitch right" style="margin: 5px; margin-top: 10px;">\n						    <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="automaticLoginSwitch" <% if (automaticLogin == true) { %>checked<% } %>>\n						    <label class="onoffswitch-label" for="automaticLoginSwitch">\n						        <div id="automaticLoginSwitchInner" class="onoffswitch-inner"></div>\n						        <div class="onoffswitch-switch"></div>\n						    </label>\n						</div>\n						Login autom&aacute;tico \n					</li> -->\n					\n					<li><a href="/Settings/ChangePassword" class="settinsLink">Alterar senha</a></li>\n					\n				</ul>\n			</dd>\n				<% if (Shared.userHasModule("mail")) { %>\n				<dt>Configura&ccedil;&otilde;es do Email</dt>\n				<dd>\n					<ul>\n						<li><a href="/Settings/ResultsPerPage" class="settinsLink">Resultados por p&aacute;gina</a></li>\n						<li><a href="/Settings/MailSignature" class="settinsLink">Assinatura de e-mail</a></li>\n					</ul>\n				</dd>\n				<% } %>\n			<% } %>\n			<dt>Expresso</dt>\n			<dd>\n				<ul>\n					<li><a href="/Settings/Support" class="settinsLink">Suporte / Sugest&otilde;es</a></li>\n					<li><a href="/Settings/About" class="settinsLink">Sobre o Expresso</a></li>\n					<li><a href="/Settings/FAQ" class="settinsLink">Perguntas Frequentes</a></li>\n					<li><a href="/Settings/Credits" class="settinsLink">Cr&eacute;ditos</a></li>\n				</ul>\n			</dd>\n		</dl>\n	</div>\n</div>'}),define("text!templates/settings/settingsAboutListTemplate.html",[],function(){return'<h2 class="ellipsis50">Sobre o Expresso</h2>\n<article id="wrapperDetail" class="container">\n	<div id="scrollerDetail">\n\n		<dl id="aboutExpresso">\n\n			<div class="login-center" style="width: 245px; margin-top: 50px; margin-bottom: 50px;">\n			      <div class="product-logo"></div>\n			</div>\n			\n			<dt>O que &eacute;</dt>\n			<dd>O Expresso Livre &eacute; uma solu&ccedil;&atilde;o completa de comunica&ccedil;&atilde;o que re&uacute;ne Email, Agenda, Cat&aacute;logo de Endere&ccedil;os, Workflow e Mensagens Instant&acirc;neas em um &uacute;nico ambiente. Por ser uma vers&atilde;o customizada do E-GroupWare, seu desenvolvimento tamb&eacute;m &eacute; totalmente baseado em software livre.</dd>\n\n			<dt>Caracter&iacute;sticas</dt>\n			<dd>- Alta Escalabilidade<br>\n				- Baixo custo<br>\n				- Utiliza&ccedil;&atilde;o de protocolos padr&oatilde;es<br>\n				- Integra&ccedil;&atilde;o com outros sistemas Web<br>\n				- Independ&ecirc;ncia de fornecedor<br>\n				- Independ&ecirc;ncia de plataforma cliente<br>\n				- Independ&ecirc;ncia de plataforma servidor<br>\n				- Mobilidade dos usu&aacute;rios<br>\n			</dd>\n\n			<dt>Saiba mais</dt>\n			<dd><a href="#">www.expressolivre.org</a></dd>\n\n			<dt>Vers&otilde;es</dt>\n			<dd>\n				<ul>\n					<li>Vers&atilde;o da Aplica&ccedil;&atilde;o: <b><%=appVersion%></b></li>\n					<li>Vers&atilde;o do Expresso: <b><%=expressoVersion%></b></li>\n					<li>Vers&atilde;o da API: <b><%=apiVersion%></b><br><br><br><br><br></li>\n				</ul>\n			</dd>\n				\n		</dl>\n  	</div>\n</article>'}),define("views/settings/SettingsAboutListView",["jquery","underscore","backbone","shared","text!templates/settings/settingsAboutListTemplate.html"],function(e,t,n,r,i){var s=n.View.extend({el:e("#content"),render:function(){var e=this;r.api.resource("/ExpressoVersion").params({}).done(function(n){var s={expressoVersion:n.expressoVersion,apiVersion:n.apiVersion,appVersion:r.appVersion,_:t},o=t.template(i,s);e.$el.html(o),e.loaded()}).execute()},loaded:function(){r.scrollDetail=new iScroll("wrapperDetail")}});return s}),define("text!templates/settings/settingsChangePasswordListTemplate.html",[],function(){return'<h2 class="ellipsis50">Alterar Senha</h2>\n<article id="wrapperDetail" class="container">\n	<div id="scrollerDetail">\n		<form id="changePassword">\n			<ol>\n				<li>\n					<input type="password" name="senhaAtual" id="senhaAtual" placeholder="Senha atual" value="" />\n				</li>\n				<li>\n					<input type="password" name="novaSenha" id="novaSenha" placeholder="Nova senha" value="" />\n				</li>\n				<li>\n					<input type="password" name="repetirNovaSenha" id="repetirNovaSenha" placeholder="Repetir nova senha" value="" />\n				</li>\n			</ol>\n		</form>\n  	</div>\n</article>'}),define("views/settings/SettingsChangePasswordListView",["jquery","underscore","backbone","shared","text!templates/settings/settingsChangePasswordListTemplate.html"],function(e,t,n,r,i){var s=n.View.extend({el:e("#content"),render:function(){var e={_:t},n=t.template(i,e);this.$el.html(n),this.loaded(),r.menuView.renderContextMenu("changePassword",{saveCallBack:this.SaveChangePassword,parentCallBack:this})},SaveChangePassword:function(t){var n=e("#senhaAtual").val(),i=e("#novaSenha").val(),s=e("#repetirNovaSenha").val();r.menuView.renderContextMenu("changePassword",{saveCallBack:t.SaveChangePassword,parentCallBack:t});var o="";i!=s&&(o="Nova Senhas são diferentes!");if(n==i||n==s)o="A nova senha deve ser diferente da senha atual!";if(s==""||s==undefined)o="Repetição da nova senha não informada/inválida!";if(i==""||i==undefined)o="Nova senha não informada/inválida!";if(n==""||n==undefined)o="Senha atual não informada/inválida!";if(o==""){var u=this;n=encodeURIComponent(n),i=encodeURIComponent(i),s=encodeURIComponent(s),r.api.resource("Preferences/ChangePassword").params({currentPassword:n,newPassword_1:i,newPassword_2:s}).done(function(e){r.showMessage({type:"success",icon:"icon-settings",title:"Sua nova senha foi alterada com sucesso!",description:"",elementID:"#pageMessage"}),r.router.navigate("/Settings",{trigger:!0})}).fail(function(e){var t="";switch(e.error.code){case"1054":t="Senha atual Não Informada/Inválida!";break;case"1055":t="Nova Senha Não Informada/Inválida!";break;case"1056":t="Nova Senhas são diferentes!";break;case"1057":t="Senha atual Não Informada/Inválida!";break;case"1058":t="Seu usuário não possui permissão de alterar a senha.";break;case"1059":t="Sua senha deve conter 8 ou mais caracteres.";break;case"1060":t="Sua senha deve conter no mínimo 2 números ou caracteres especiais.";break;case"1061":t="Não foi possível alterar a senha, não existe suporte para certificados digitais.";break;default:}r.showMessage({type:"error",icon:"icon-settings",title:t,description:"",elementID:"#pageMessage"})}).execute()}else r.showMessage({type:"error",icon:"icon-settings",title:o,description:"",elementID:"#pageMessage"})},loaded:function(){var e=this;r.scrollDetail=new iScroll("wrapperDetail")}});return s}),define("text!templates/settings/settingsCreditsListTemplate.html",[],function(){return'<h2 class="ellipsis50">Cr&eacute;ditos</h2>\n<article id="wrapperDetail" class="container">\n	<div id="scrollerDetail">\n\n		<dl id="credits">\n			\n			<dt>Projeto desenvolvido por:</dt>\n			<dd>CELEPAR - Companhia de Tecnologia da Informa&ccedil;&atilde;o e Comunica&ccedil;&atilde;o do Estado do Paran&aacute;\n				<br><br>\n				<div class="company-logo"></div>\n			</dd>\n\n			<dt>Desenvolvedores</dt>\n			<dd>\n				<ul>\n					<li>Alexandre Rocha Wendling</li>\n					<li>Jair Gon&ccedil;alves Pereira Jr</li>\n					<li>Rafael Katayama Gobara</li>\n				</ul>\n			</dd>\n\n			<dt>Desenvolvedores API</dt>\n			<dd>\n				<ul>\n					<li>Alexandre Luiz Correia</li>\n					<li>Alexandre Rocha Wendling</li>\n					<li>Anderson Tadayuki Saikawa</li>\n					<li>Jair Gon&ccedil;alves Pereira Jr</li>\n					<li>Nilton Emilio Buhrer Neto</li>\n					<li>Rafael Katayama Gobara</li>			\n				</ul>\n			</dd>\n\n			<dt>Design e Padrão de Usabilidade</dt>\n			<dd>\n				<ul>\n					<li>Carlos Henrique Roland</li>\n					<li>Jair Gon&ccedil;alves Pereira Jr</li>\n					<li>Rafael Katayama Gobara</li>			\n				</ul>\n			</dd>\n\n			<dt>Biliotecas utilizadas</dt>\n			<dd>\n				<ul>\n					<li>Bacbkone</li>\n					<li>RequireJS</li>\n					<li>Underscore</li>\n					<li>jQuery</li>\n					<li>Moment.js</li>\n					<li>PhoneGap</li>\n					<li>iScroll</li>\n					<li>jQuery Dot Dot Dot</li>\n					<li>jQuery XMPP</li>\n				</ul>\n			</dd>\n\n		</dl>\n\n  	</div>\n</article>'}),define("views/settings/SettingsCreditsListView",["jquery","underscore","backbone","shared","text!templates/settings/settingsCreditsListTemplate.html"],function(e,t,n,r,i){var s=n.View.extend({el:e("#content"),render:function(){var e={_:t},n=t.template(i,e);this.$el.html(n),this.loaded()},loaded:function(){var e=this;r.scrollDetail=new iScroll("wrapperDetail")}});return s}),define("text!templates/settings/settingsMailSignatureListTemplate.html",[],function(){return'<h2 class="ellipsis50">Assinatura do Email</h2>\n<article id="wrapperDetail" class="container">\n	<div id="scrollerDetail">\n		<div id="emailSignature">\n			<ol>\n				<li>\n					<input type="hidden" id="typeSignature" name="typeSignature" value="<%=typeSignature%>">\n					<% if (typeSignature == \'html\') { %>\n					<div id="assinaturaEmailHTML"  class="messageBodyInput" style="width: 100%; min-height: 400px;" contenteditable="true">\n						<%=mailsignature%>\n					</div>\n					<% } else { %>\n					<textarea name="assinaturaEmail" id="assinaturaEmail" placeholder="Mensagem enviada pelo Expresso Mobile."><%=mailsignature%></textarea>\n					<% } %>\n				</li>\n			</ol>\n		</div>\n  	</div>\n</article>'}),define("views/settings/SettingsMailSignatureListView",["jquery","underscore","backbone","shared","text!templates/settings/settingsMailSignatureListTemplate.html"],function(e,t,n,r,i){var s=n.View.extend({el:e("#content"),render:function(){var e="",n="",s=this;r.api.resource("Preferences/UserPreferences").params({module:"mail"}).done(function(o){e=o.mail.signature,n=o.mail.type_signature;var u={_:t,mailsignature:e,typeSignature:n},a=t.template(i,u);s.$el.html(a),s.loaded(),r.menuView.renderContextMenu("mailsignature",{})}).fail(function(e){}).execute()},SaveMailSignature:function(){var t="";e("#typeSignature").val()=="html"?t=e("#assinaturaEmailHTML").html():t=e("#assinaturaEmail").val(),r.api.resource("Preferences/ChangeUserPreferences").params({module:"mail",preference:"signature",value:t}).done(function(n){r.settings.mailSignature=t,r.settings.typeSignature=e("#typeSignature").val(),r.saveSettingsToLocalStorage(),r.showMessage({type:"success",icon:"icon-settings",title:"Sua preferência foi salva com sucesso!",description:"",elementID:"#pageMessage"}),r.router.navigate("/Settings",{trigger:!0})}).fail(function(e){}).execute()},loaded:function(){var e=this;r.scrollDetail=new iScroll("wrapperDetail")}});return s}),define("text!templates/settings/settingsResultsPerPageListTemplate.html",[],function(){return'<h2 class="ellipsis50">Resultados Por P&aacute;gina</h2>\n<article id="wrapperDetail" class="container">\n	<div id="scrollerDetail">\n		<div id="detailList">\n			<ul>\n				<% _.each(possibleValues, function(value){ %>\n				<li value="<%=value%>" <% if (resultsperpage == value) { %>class="selected"<% } %>>\n					<a href="#" class="detailListItemLink">\n						<h3><%=value%></h3>\n					</a>\n				</li>\n				<% }); %>\n			</ul>\n		</div>\n  	</div>\n</article>'}),define("views/settings/SettingsResultsPerPageListView",["jquery","underscore","backbone","shared","text!templates/settings/settingsResultsPerPageListTemplate.html"],function(e,t,n,r,i){var s=n.View.extend({elementID:"#content",render:function(){var n=[25,50,75,100],s=this;r.api.resource("Preferences/UserPreferences").params({module:"mail",preference:"max_email_per_page"}).done(function(r){var o=25;o=r.mail.max_email_per_page;var u={_:t,resultsperpage:o,possibleValues:n},a=t.template(i,u);s.$el.html(a),e(s.elementID).empty().html(s.$el),s.loaded()}).fail(function(e){}).execute()},events:{"click a.detailListItemLink":"selectListItem"},selectListItem:function(t){t.preventDefault(),e("#detailList li").each(function(){e(this).hasClass("listDivision").toString()=="false"&&e(this).removeClass("selected")});var n=e(t.target).parent();n.hasClass("detailListItemLink")&&(n=n.parent()),n.addClass("selected");var i=e(n).attr("value");r.settings.resultsPerPage=i,r.saveSettingsToLocalStorage(),r.api.resource("Preferences/ChangeUserPreferences").params({module:"mail",preference:"max_email_per_page",value:i}).done(function(e){r.showMessage({type:"success",icon:"icon-settings",title:"Sua preferência foi salva com sucesso!",description:"",elementID:"#pageMessage"}),r.isSmartPhoneResolution()&&r.router.navigate("/Settings",{trigger:!0})}).fail(function(e){}).execute()},loaded:function(){var e=this;r.scrollDetail=new iScroll("wrapperDetail")}});return s}),define("text!templates/settings/settingsSupportListTemplate.html",[],function(){return'<h2 class="ellipsis50">Suporte / Sugest&otilde;es</h2>\n<article id="wrapperDetail" class="container">\n	<div id="scrollerDetail">\n		<div id="support">\n			<ol>\n				<li>\n					<textarea name="sugestao" id="sugestao" placeholder="Envie suas sugest&otilde;es ou cr&iacute;ticas para o time que administra o Expresso."></textarea>\n				</li>\n			</ol>\n		</div>\n  	</div>\n</article>'}),define("views/settings/SettingsSupportListView",["jquery","underscore","backbone","shared","text!templates/settings/settingsSupportListTemplate.html"],function(e,t,n,r,i){var s=n.View.extend({el:e("#content"),render:function(){var e={_:t},n=t.template(i,e);this.$el.html(n),this.loaded(),r.menuView.renderContextMenu("support",{saveCallBack:this.SendSupportFeedback,parentCallback:this})},SendSupportFeedback:function(){var t=e("#sugestao").val();if(t=="")r.showMessage({type:"error",icon:"icon-settings",title:"Por favor, escreva sua sugestão!",description:"",elementID:"#pageMessage"});else{var n="Mensagem enviada pelo Expresso Mobile: ",i="",s="";r.isPhonegap()&&(i+="Phonegap,"),r.isAndroid()&&(i+="Android"),r.isIDevice()&&(i+="iOS"),r.isDesktop()&&(s+="Desktop,"),r.isTabletResolution()?s+="Tablet":r.isSmartPhoneResolution()&&(s+="SmartPhone"),n=n+s+" - "+i+"<br><br>",t=n+t,r.api.resource("Mail/SendSupportFeedback").params({message:t}).done(function(e){r.showMessage({type:"success",icon:"icon-settings",title:"Sua Sugestão foi enviada com sucesso!",description:"",elementID:"#pageMessage"}),r.router.navigate("/Settings",{trigger:!0})}).fail(function(e){return r.handleErrors(e),!1}).execute()}},loaded:function(){var e=this;r.scrollDetail=new iScroll("wrapperDetail")}});return s}),define("views/settings/SettingsListView",["jquery","underscore","backbone","shared","text!templates/settings/settingsListTemplate.html","views/settings/SettingsAboutListView","views/settings/SettingsChangePasswordListView","views/settings/SettingsCreditsListView","views/settings/SettingsMailSignatureListView","views/settings/SettingsResultsPerPageListView","views/settings/SettingsSupportListView","views/settings/SettingsFaqListView","views/home/LoadingView"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){var p=n.View.extend({secondViewName:"",render:function(){var n=this,p="#content",d="#contentDetail";r.menuView.renderContextMenu(0,[]),r.isSmartPhoneResolution()&&(d="#content");if(this.secondViewName!=null){if(this.secondViewName!="SaveMailSignature"&&this.secondViewName!="SaveChangePassword"){e(d).html("");var v=new h({el:e(d)});v.render()}if(this.secondViewName=="Support")var m=new l({el:e(d)});if(this.secondViewName=="About")var m=new s({el:e(d)});if(this.secondViewName=="FAQ"){var m=new c({});m.elementID=d}if(this.secondViewName=="Credits")var m=new u({el:e(d)});if(this.secondViewName=="ChangePassword")var m=new o({el:e(d)});if(this.secondViewName=="ResultsPerPage"){var m=new f;m.elementID=d}if(this.secondViewName=="MailSignature")var m=new a({el:e(d)});if(this.secondViewName=="SaveMailSignature"){var m=new a({el:e(d)});m.SaveMailSignature()}else if(this.secondViewName=="SaveChangePassword"){var m=new o({el:e(d)});m.SaveChangePassword()}else setTimeout(function(){m.render()},r.timeoutDelay)}else{e(d).html("");var v=new h({el:e(p)});v.render();var n=this;setTimeout(function(){var s={_:t,user:r.profile,auth:r.api.auth(),automaticLogin:r.settings.automaticLogin,Shared:r},o=t.template(i,s);n.$el.html(o),e(p).empty().html(n.$el),n.loaded()},r.timeoutDelay)}r.setDefaultIMListeners()},events:{"click .settinsLink":"selectMenuItem","change #automaticLoginSwitch":"selectAutomaticLogin"},selectAutomaticLogin:function(t){r.settings.automaticLogin==1?(e("#automaticLoginSwitch").val("off"),r.settings.automaticLogin=!1):(e("#automaticLoginSwitch").val("on"),r.settings.automaticLogin=!0)},selectMenuItem:function(t){t.preventDefault(),e("#settingsList li").each(function(){e(this).removeClass("selected")});var n=e(t.target).parent();n.hasClass("settinsLink")&&(n=n.parent()),n.addClass("selected"),r.router.navigate(t.currentTarget.getAttribute("href"),{trigger:!0})},initialize:function(){this.secondViewName=""},loaded:function(){var e=this;r.scroll=new iScroll("wrapper")}});return p}),define("text!templates/contacts/generalContactsListTemplate.html",[],function(){return'<div id="pullDown">\n  	<span class="pullDownIcon"></span><span class="pullDownLabel"><% if (contacts.length) { %>Puxe para baixo para atualizar<% } %></span>\n</div>\n<% if (typeof(contacts) != \'undefined\' && contacts.length > 0) { %>\n	\n	<dl id="contactsList" class="general">\n\n		<% var summaryLetter = _.first(contacts).get(\'contactFirstName\').charAt(0).toUpperCase(); %>\n		<dt><%=summaryLetter%></dt>\n		<dd>\n			<ul>\n		\n				<% _.each(contacts, function(c) { %>\n\n					<% if (!_.isEqual(summaryLetter, c.get(\'contactFirstName\').charAt(0).toUpperCase())) { %>\n					\n						<% summaryLetter = c.get(\'contactFirstName\').charAt(0).toUpperCase(); %>\n						\n						</ul>\n							</dd>\n							<dt><%=summaryLetter%></dt>\n							<dd>\n								<ul>\n\n					<% } %>\n\n					<% \n					var contactID = decodeURIComponent(c.get(\'contactID\'));\n					var queryUID = contactID.split(",")[0]; \n					var uid = queryUID.split("=");\n					var id = uid[1].replace(".", "___");\n					%>\n\n					<li id="<%=id%>">\n						<a href="/Contacts/General/<%= c.get(\'contactUIDNumber\') %>" title="<%=c.get(\'contactFullName\')%>">\n\n\n							<div id="picture_contact_<%= id %>" class="picture_image"></div>\n							<div class="info">\n								<span class="name"><%=c.get(\'contactFullName\')%></span>\n								<span class="email"><%=c.getFirstEmailAddress()%></span>\n							</div>\n\n						</a>\n					</li>\n\n				<% }); %>\n\n			</ul>\n		</dd>\n\n	</dl>\n	\n<% } else { %>\n\n	<% if (_.isObject(error)) { %>\n\n		<p class="erro"><%= error.message %></p>\n\n	<% } else { %>\n\n		<p class="erro">Nenhum registro encontrado</p>\n\n	<% } %>\n\n<% } %>'}),define("text!templates/contacts/personalContactsListTemplate.html",[],function(){return'<% if (contacts.length > 0) { %>\n	<div id="pullDown">\n	  	<span class="pullDownIcon"></span><span class="pullDownLabel"><% if (contacts.length) { %>Puxe para baixo para atualizar<% } %></span>\n	</div>\n	<dl id="contactsList" class="personal">\n\n		<% var summaryLetter = _.first(contacts).get(\'contactFirstName\').charAt(0).toUpperCase(); %>\n		<dt><%=summaryLetter%></dt>\n		<dd>\n			<ul>\n		\n				<% _.each(contacts, function(c) { %>\n\n					<% if (!_.isEqual(summaryLetter, c.get(\'contactFirstName\').charAt(0).toUpperCase())) { %>\n					\n						<% summaryLetter = c.get(\'contactFirstName\').charAt(0).toUpperCase(); %>\n						\n						</ul>\n							</dd>\n							<dt><%=summaryLetter%></dt>\n							<dd>\n								<ul>\n\n					<% } %>\n\n					<li id="<%=c.get(\'contactID\')%>">\n						<a href="/Contacts/Personal/<%= c.get(\'contactID\') %>" title="<%=c.get(\'contactFullName\')%>">\n\n							<% \n							var id = c.get(\'contactID\');\n							%>\n\n							<div id="picture_contact_<%= id %>" class="picture_image"></div>\n							<div class="info">\n								<span class="name"><%=c.get(\'contactFullName\')%></span>\n								<span class="email"><%=c.getFirstEmailAddress()%></span>\n							</div>\n						</a>\n					</li>\n\n				<% }); %>\n\n			</ul>\n		</dd>\n\n	</dl>\n\n<% } else { %>\n\n	<p class="erro">Nenhum registro encontrado</p>\n\n<% } %>'}),define("models/contacts/ContactPictureImageModel",["underscore","backbone","shared"],function(e,t,n){var r=t.Model.extend({defaults:{contactID:"",contactImagePicture:""},initialize:function(){this.api=n.api,this.readResource="/Catalog/ContactPicture",this.updateResource="",this.createResource="",this.deleteResource=""},done:function(e){return this.done=e,this},fail:function(e){return this.fail=e,this},getImagePicture:function(e,t){var n=this;return this.api.resource("Catalog/ContactPicture").params({contactID:e,contactType:t}).done(function(e){var t=new r(e.contacts[0]);n.done&&n.done(t)}).fail(function(e){n.fail&&n.fail(e)}).execute(),n},execute:function(){return this.api.execute()}});return r}),define("text!templates/contacts/pictureImageContactTemplate.html",[],function(){return'<img src="" class="userPicture" alt="" />'}),define("views/contacts/PictureImageContactView",["jquery","underscore","backbone","shared","views/home/LoadingView","models/contacts/ContactPictureImageModel","text!templates/contacts/pictureImageContactTemplate.html"],function(e,t,n,r,i,s,o){var u=n.View.extend({render:function(n){var r=function(t){var n=decodeURIComponent(t.contact.get("contactID")),r;if(parseInt(n)!=NaN&&parseInt(n)%1==0)r=n;else{var i=n.split(",")[0],s=i.split("=");r=s[1].replace(".","___")}e("#picture_contact_"+r+" img").attr("src","data:image/gif;base64,"+t.contact.get("contactImagePicture"))};for(var i in n.contacts)n.contacts[i].get("contactHasImagePicture")==1&&this.getContactPictureImage(n.contacts[i].get("contactID"),r,r);var s=t.template(o);this.$el.html(s),this.loaded()},initialize:function(){},loaded:function(){},getContactPictureImage:function(e,n,r){var i="2";parseInt(e)!=NaN&&parseInt(e)%1==0&&(i="1");var o=new s;o.done(function(e){n({contact:e,_:t})}).fail(function(e){r({error:e.error,_:t})}).getImagePicture(e,i)}});return u}),define("views/contacts/ContactsListView",["jquery","underscore","backbone","shared","text!templates/master/primaryContentTemplate.html","text!templates/master/detailContentTemplate.html","text!templates/contacts/generalContactsListTemplate.html","text!templates/contacts/personalContactsListTemplate.html","collections/home/ContextMenuCollection","views/contacts/PictureImageContactView","views/home/LoadingView","views/home/HomeView","collections/contacts/ContactsListCollection"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){var p=n.View.extend({searchLength:0,secondViewName:"",status:null,currentView:null,arrayContacts:{},events:{"keyup .personalContacts .searchField":"searchPersonalContacts","keypress .generalContacts .searchField":"searchGeneralContacts","click #contactsList a":"viewContact"},render:function(){this.$el.html(t.template(i)),e("#content").empty().append(this.$el),r.setDefaultIMListeners(),r.isSmartPhoneResolution()||(e("#contentDetail").html(t.template(s)),e("#contentDetail .searchArea").remove());var n=new l({el:e("#scroller")});n.render(),this.secondViewName=="General"?this.listGeneralContacts("",!1):this.listPersonalContacts("",!1)},initialize:function(){},loaded:function(){var t=e(".topHeader").outerHeight(!0),n=e(".searchArea").outerHeight(true)==null?0:e(".searchArea").outerHeight(!0);e("#wrapper").css("top",t+n),r.scroll!=null&&(r.scroll.destroy(),r.scroll=null);var i=this;pullDownEl=document.getElementById("pullDown"),pullDownOffset=pullDownEl.offsetHeight,r.scroll=new iScroll("wrapper",{useTransition:!0,topOffset:pullDownOffset,onRefresh:function(){pullDownEl.className.match("loading")&&(pullDownEl.className="",pullDownEl.querySelector(".pullDownLabel").innerHTML="Puxe para baixo para atualizar...")},onScrollMove:function(){this.y>5&&!pullDownEl.className.match("flip")?(pullDownEl.className="flip",pullDownEl.querySelector(".pullDownLabel").innerHTML="Solte para atualizar...",this.minScrollY=0):this.y<5&&pullDownEl.className.match("flip")&&(pullDownEl.className="",pullDownEl.querySelector(".pullDownLabel").innerHTML="Puxe para baixo para atualizar...",this.minScrollY=-pullDownOffset)},onScrollEnd:function(){pullDownEl.className.match("flip")&&(pullDownEl.className="loading",pullDownEl.querySelector(".pullDownLabel").innerHTML="Carregando...",i.pullDownAction())}}),r.scrollerRefresh()},pullDownAction:function(){this.secondViewName=="General"?this.listGeneralContacts(e(".searchField").val(),!0):this.listPersonalContacts(e(".searchField").val(),!0)},searchPersonalContacts:function(t){this.searchContacts(t,e(".searchField").val(),"1")},searchGeneralContacts:function(t){t.keyCode==13&&this.searchContacts(t,e(".searchField").val(),"2")},searchContacts:function(t,n,r){var i=e(".searchField").val(),n="";i.length>=3?n=i:n="";if(n.length>=3||this.searchLength>=3){var s=new l({el:e("#scroller")});s.render(),r=="1"?this.listPersonalContacts(n,!0):this.listGeneralContacts(this.removeAccents(n),!0)}this.searchLength=i.length},listPersonalContacts:function(n,i){var s=this;e("#contentTitle").text("Contatos Pessoais"),e("#contentTitle").addClass("icon-contacts"),e(".searchArea").removeClass("generalContacts"),e(".searchArea").addClass("personalContacts");var o=function(n){r.menuView.renderContextMenu(0,[]),s.secondViewName=="General"?r.menuView.renderContextMenu("generalContacts",{}):r.menuView.renderContextMenu("personalContacts",{}),n.error==undefined?n.contacts.length>0?(e("#message").empty(),e("#scroller").empty().append(t.template(u,n)),s.openFirstContact(n.contacts[0].get("contactID"),n.contacts[0].get("contactID"),"Personal")):(r.showMessage({type:"error",icon:"icon-contacts",title:"Nenhum Resultado Encontrado.",route:"",description:"",timeout:0,animate:!1,elementID:"#message"}),e("#scroller").empty()):(e("#scroller").empty(),r.handleErrors(n.error)),s.setElement(s.$el),s.loaded();var i=new f({el:e(".picture_image")});i.render(n)};this.listContacts(n,"1",i,o,o)},listGeneralContacts:function(n,i){var s=this;this.personalContact=!1,e("#contentTitle").text("Catálogo Geral"),e("#contentTitle").addClass("icon-contacts"),e(".searchArea").removeClass("personalContacts"),e(".searchArea").addClass("generalContacts");var u=function(n){s.secondViewName=="General"?r.menuView.renderContextMenu("generalContacts",{}):r.menuView.renderContextMenu("personalContacts",{}),n.error==undefined?(e("#message").empty(),e("#scroller").empty().append(t.template(o,n)),n.contacts.length>0&&s.openFirstContact(n.contacts[0].get("contactUIDNumber"),n.contacts[0].get("contactID"),"General")):(n.error.code=="1001"&&r.showMessage({type:"chat-message",icon:"icon-contacts",title:"Sua busca deve ser específica.",route:"",description:"Procure pelo nome e sobrenome.<br>Nenhum resultado será exibido caso a sua busca retorne mais do que 200 contatos.",timeout:0,animate:!1,elementID:"#message"}),n.error.code=="1019"&&r.showMessage({type:"error",icon:"icon-contacts",title:"Nenhum Resultado Encontrado.",route:"",description:"Procure pelo nome e sobrenome.<br>Nenhum resultado será exibido caso a sua busca retorne mais do que 200 contatos.",timeout:0,animate:!1,elementID:"#message"}),e("#scroller").empty(),e("#scroller").append('<div id="pullDown"><span class="pullDownIcon"></span><span class="pullDownLabel"></span></div>')),s.setElement(s.$el),s.loaded();var i=new f({el:e(".picture_image")});i.render(n)};this.listContacts(n,"2",i,u,u)},listContacts:function(e,n,r,i,s){var o=new h;o.done(function(n){this.arrayContacts={contacts:n.models,search:e,_:t},i(this.arrayContacts)}).fail(function(e){s({error:e.error,_:t})}).getContacts(e,n,r)},viewContact:function(t){t.preventDefault(),e("#contactsList ul li").removeAttr("class"),e(t.target).parents("li").addClass("selected"),r.router.navigate(t.currentTarget.getAttribute("href"),{trigger:!0})},openFirstContact:function(t,n,i){if(!r.isSmartPhoneResolution()){if(parseInt(n)!=NaN&&parseInt(n)%1==0)id=n;else{n=decodeURIComponent(n);var s=n.split(",")[0],o=s.split("=");id=o[1].replace(".","___")}e("#contactsList ul li").removeAttr("class"),e("#"+id).addClass("selected"),this.status!=null?r.router.navigate("/Contacts/"+i+"/"+t+"/OK",{trigger:!0}):r.router.navigate("/Contacts/"+i+"/"+t,{trigger:!0})}},removeAccents:function(e){var e=e.split(""),t=new Array,n=e.length,r="ÀÁÂÃÄÅàáâãäåÒÓÔÕÕÖØòóôõöøÈÉÊËèéêëðÇçÐÌÍÎÏìíîïÙÚÛÜùúûüÑñŠšŸÿýŽž",i="AAAAAAaaaaaaOOOOOOOooooooEEEEeeeeeCcDIIIIiiiiUUUUuuuuNnSsYyyZz";for(var s=0;s<n;s++)r.indexOf(e[s])!=-1?t[s]=i.substr(r.indexOf(e[s]),1):t[s]=e[s];return t=t.join(""),t}});return p}),define("text!templates/contacts/detailsContactTemplate.html",[],function(){return'<!-- <div id="picture_contact" class="picture_image" style="margin: 0 10px;"><img src="" class="userPicture" alt="" style="height: 106px; width: 80px;" /></div> -->\n<%\nvar contactID = decodeURIComponent(contact.get(\'contactID\'));\nvar id;\n\nif (parseInt(contactID) != NaN && parseInt(contactID) % 1 == 0)\n	id = contactID;\nelse\n{\n	var queryUID = contactID.split(",")[0]; \n	var uid = queryUID.split("=");\n	id = uid[1].replace(".", "___");\n}\n%>\n\n<div id="picture_contact_<%= id %>" class="details_picture_image"></div>\n<dl id="contactDetails" style="margin-left: 100px;">\n\n	<% if (!_.isEmpty(contact.get(\'contactMails\'))) { %>\n				\n		<dt>Contas de e-mail</dt>\n		<dd>\n			<ul>\n				<% _.each(contact.get(\'contactMails\'), function (email) { %>\n					<li><%= email %></li>\n				<% }); %>\n			</ul>\n		</dd>\n\n	<% } %>\n\n	<% if (!_.isEmpty(contact.get(\'contactPhones\')) && !_.isEmpty(_.first(contact.get(\'contactPhones\')))) { %>\n\n		<dt>Telefones</dt>\n		<dd>\n			<ul>\n				<% _.each(contact.get(\'contactPhones\'), function (phone) { %>\n					<li><%= phone %></li>\n				<% }); %>\n			</ul>\n		</dd>\n\n	<% } %>\n\n</dl>'}),define("views/contacts/DetailsContactView",["jquery","underscore","backbone","shared","views/home/LoadingView","views/home/HomeView","views/contacts/PictureImageContactView","text!templates/master/detailContentTemplate.html","text!templates/master/primaryContentTemplate.html","text!templates/contacts/detailsContactTemplate.html","collections/contacts/DetailsContactCollection","collections/home/ContextMenuCollection","models/contacts/ContactPictureImageModel"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){var p=n.View.extend({secondViewName:"",contactID:null,status:null,render:function(n){var s=this,l,c,h;r.isSmartPhoneResolution()?(this.$el.html(t.template(a)),e("#content").empty().append(this.$el),l=e("#contentTitle"),c=e("#scroller"),h="#pageMessage"):(this.$el.html(t.template(u)),e("#contentDetail").empty().append(this.$el),l=e("#contentDetailTitle"),c=e("#scrollerDetail"),h="#pageMessage");var p=new i({el:c});p.render();var d=function(n){var i=t.first(n.contacts);if(i!=undefined){l.text(i.get("contactFullName"));var u={contact:t.first(n.contacts),_:t},a=s.secondViewName=="Personal"?t.first(n.contacts).get("contactID"):t.first(n.contacts).get("contactUIDNumber");c.empty().append(t.template(f,u)),s.loaded(t.first(n.contacts).get("contactMails")[0],a);var p=new o({el:e(".details_picture_image")});p.render(n),e(".details_picture_image").css("margin","0 10px"),e(".details_picture_image img").css("width","80px").css("height","106px"),e(".details_picture_image img").css("margin-top","10px").css("background-size","110px 130px")}if(s.status=="OK"){var d="";s.secondViewName=="Personal"?d="Contato removido do catálogo pessoal com sucesso.":d="Contato adicionado ao catálogo pessoal com sucesso.",r.showMessage({type:"success",icon:"icon-agenda",title:d,description:"",timeout:3e3,elementID:h})}else if(!isNaN(parseInt(s.status))){var v="";switch(s.status){case"1052":case"1055":v="Endereço de e-mail inválido.";break;case"1053":v="Contato já existe no catálogo pessoal.";break;case"1056":v="Erro ao excluir o contato. O ID  está vazio ou é inválido.";break;default:case"1054":v="Não foi possível adicionar o contato no catálogo pessoal. Por favor, tente novamente."}r.showMessage({type:"error",icon:"icon-agenda",title:v,description:"",timeout:3e3,elementID:h})}};this.secondViewName=="Personal"?this.getPersonalContactDetails(this.contactID,d,d):this.getGeneralContactDetails(this.contactID,d,d)},initialize:function(){},loaded:function(t,n){r.isSmartPhoneResolution()?(r.scroll!=null&&(r.scroll.destroy(),r.scroll=null),r.scroll=new iScroll("wrapper")):(r.scrollDetail!=null&&(r.scrollDetail.destroy(),r.scrollDetail=null),r.scrollDetail=new iScroll("wrapperDetail")),e("#contentDetail .searchArea").remove(),r.scrollerRefresh(),r.menuView.renderContextMenu("detailsContact",{email:t,contactID:n,contactType:this.secondViewName})},getPersonalContactDetails:function(e,n,r){var i=new l;i.done(function(e){n({contacts:e.models,_:t})}).fail(function(e){r({error:e.error,_:t})}).getPersonalContactDetails(e)},getGeneralContactDetails:function(e,n,r){var i=new l;i.done(function(e){n({contacts:e.models,_:t})}).fail(function(e){r({error:e.error,_:t})}).getGeneralContactDetails(e)}});return p}),define("views/contacts/AddContactView",["jquery","underscore","backbone","shared","views/home/LoadingView","views/home/HomeView","text!templates/master/detailContentTemplate.html","text!templates/master/primaryContentTemplate.html","models/contacts/ContactModel","collections/contacts/DetailsContactCollection","collections/home/ContextMenuCollection"],function(e,t,n,r,i,s,o,u,a,f,l){var c=n.View.extend({contactID:null,render:function(n){var s=this,a,f,l;r.isSmartPhoneResolution()?(this.$el.html(t.template(u)),e("#content").empty().append(this.$el),a=e("#contentTitle"),f=e("#scroller"),l="#message"):(this.$el.html(t.template(o)),e("#contentDetail").empty().append(this.$el),a=e("#contentDetailTitle"),f=e("#scrollerDetail"),l="#messageDetail");var c=new i({el:f});c.render();var h=function(e){var n=function(e){e.contact==1?r.router.navigate("/Contacts/General/"+s.contactID+"/OK",{trigger:!0}):e.error!=undefined&&r.router.navigate("/Contacts/General/"+s.contactID+"/"+e.error.code,{trigger:!0})},i=t.first(e.contacts),o=i.get("contactPhones")!=""&&i.get("contactPhones").length>0?i.get("contactPhones")[0]:"",u={contactAlias:i.get("contactFullName"),contactGivenName:i.get("contactFirstName"),contactFamilyName:i.get("contactLastName"),contactEmail:i.get("contactMails")[0],contactPhone:o};s.addContact(u,n,n)};this.getContactDetails(this.contactID,h,h)},initialize:function(){},loaded:function(e,t){r.isSmartPhoneResolution()?(r.scroll!=null&&(r.scroll.destroy(),r.scroll=null),r.scroll=new iScroll("wrapper")):(r.scrollDetail!=null&&(r.scrollDetail.destroy(),r.scrollDetail=null),r.scrollDetail=new iScroll("wrapperDetail")),r.scrollerRefresh(),r.menuView.renderContextMenu("detailsContact",{email:e,contactID:t})},getContactDetails:function(e,n,r){var i=new f;i.getGeneralContactDetails(e).done(function(e){n({contacts:e.models,_:t})}).fail(function(e){r({error:e.error,_:t})})},addContact:function(e,n,r){var i=new a;i.addContact(e).done(function(e){var r={contact:e,_:t};n&&n(r)}).fail(function(e){r&&r(e)})}});return c}),define("views/contacts/DeleteContactView",["jquery","underscore","backbone","shared","views/home/LoadingView","views/home/HomeView","text!templates/master/detailContentTemplate.html","text!templates/master/primaryContentTemplate.html","models/contacts/ContactModel","collections/contacts/DetailsContactCollection","collections/home/ContextMenuCollection"],function(e,t,n,r,i,s,o,u,a,f,l){var c=n.View.extend({contactID:null,render:function(n){var s=this,a,f,l;r.isSmartPhoneResolution()?(this.$el.html(t.template(u)),e("#content").empty().append(this.$el),a=e("#contentTitle"),f=e("#scroller"),l="#message"):(this.$el.html(t.template(o)),e("#contentDetail").empty().append(this.$el),a=e("#contentDetailTitle"),f=e("#scrollerDetail"),l="#messageDetail");var c=new i({el:f});c.render();var h=function(e){e.contact!=undefined&&Boolean(e.contact.status)==1?r.router.navigate("/Contacts/Personal/OK",{trigger:!0}):e.error!=undefined&&r.router.navigate("/Contacts/Personal/"+s.contactID+"/"+e.error.code,{trigger:!0})};this.deleteContact(this.contactID,h,h)},initialize:function(){},loaded:function(e,t){r.isSmartPhoneResolution()?(r.scroll!=null&&(r.scroll.destroy(),r.scroll=null),r.scroll=new iScroll("wrapper")):(r.scrollDetail!=null&&(r.scrollDetail.destroy(),r.scrollDetail=null),r.scrollDetail=new iScroll("wrapperDetail")),r.scrollerRefresh(),r.menuView.renderContextMenu("detailsContact",{email:e,contactID:t})},deleteContact:function(e,n,r){var i=new a;i.deleteContact({contactID:e}).done(function(e){var r={contact:e,_:t};n&&n(r)}).fail(function(e){r&&r(e)})}});return c}),define("collections/calendar/EventsListCollection",["underscore","backbone","shared","models/calendar/EventModel"],function(e,t,n,r){var i=t.Collection.extend({model:r,_data:{},_functions:{},done:function(e){return this._functions.done=e,this},fail:function(e){return this._functions.fail=e,this},initialize:function(e,t){this.api=n.api,this.model=r},listEvents:function(e,t,n){var i=this;i._data={};var s=r,o=this._data;return n&&(console.log("ignoreCache"),this.api.ignoreCache(!0)),this.api.resource("Calendar/Events").params({dateStart:e,dateEnd:t}).done(function(e){for(var t in e.events){var n=new s(e.events[t]);i.add(n)}i._functions.done&&i._functions.done(i)}).fail(function(e){i._functions.fail&&i._functions.fail(e)}).execute(),i},execute:function(){return this.api.execute()}});return i}),define("text!templates/calendar/calendarEventsDayListTemplate.html",[],function(){return'<% if (typeof(events) != \'undefined\' && events.length > 0) { %>\n\n	<ul id="events">\n	\n		<% _.each(events, function(e) { %>\n\n			<li>\n				<a href="/Calendar/Events/<%= e.get(\'eventID\') %>" title="Ver evento">\n					<div class="hourly">\n\n						<% \n							var startTime = \'Todo\';\n							var endTime = \'o dia\';\n\n							if (e.get(\'eventAllDay\') == \'0\')\n							{\n								var startTime = (e.get(\'eventStartDate\')).split(\' \')[1];\n								var endTime = (e.get(\'eventEndDate\')).split(" ")[1];	\n							}\n						%>\n\n						<strong class="start"><%= startTime %></strong>\n						<strong class="end"><%= endTime %></strong>\n\n					</div>\n					<span><%= e.get(\'eventName\') %></span>\n				</a>\n			</li>\n		\n		<% }); %>\n\n		<li>\n			<a href="/Calendar/FullDay/<%= year + \'/\' + month + \'/\' + day %>" title="Ver evento" class="see_all">\n				<span class="complete">Ver tudo</span>\n			</a>\n		</li>\n\n	</ul>\n\n<% } else { %>\n\n	<ul id="events">\n		<li>\n			<a href="/Calendar/FullDay/<%= year + \'/\' + month + \'/\' + day %>" title="Ver evento" class="see_all">\n				<span class="complete">Ver tudo</span>\n			</a>\n		</li>\n	</ul>\n	<p class="noEvent">Nenhum evento agendado</p>\n\n\n<% } %>'}),define("views/calendar/CalendarEventsDayListView",["jquery","underscore","backbone","shared","collections/calendar/EventsListCollection","views/home/LoadingView","text!templates/calendar/calendarEventsDayListTemplate.html"],function(e,t,n,r,i,s,o){var u=n.View.extend({year:"",month:"",day:"",data:{},events:{"click #events li a":"selectItem"},render:function(){var n=new i,r=new Date(this.year,this.month-1,this.day);for(var s in this.data.events){var u=this.data.events[s].get("eventStartDate").split(" ")[0].split("/");u=new Date(u[2],u[1]-1,u[0]),u.getTime()==r.getTime()&&n.add(this.data.events[s])}var a={events:n.models,year:this.year,month:this.month,day:this.day,_:t};this.$el.html(t.template(o,a)),e("#eventsList").empty().append(this.$el)},initialize:function(){},selectItem:function(e){e.preventDefault(),r.router.navigate(e.currentTarget.getAttribute("href"),{trigger:!0})}});return u}),define("text!templates/calendar/calendarFullDayListTemplate.html",[],function(){return"<%\nvar startTime = new Date(year, month - 1, day, 0, 0, 0);\nvar endTime = new Date(year, month - 1, day, 23, 30, 0);\n%>\n<table id=\"eventsTable\"> \n\n	<% while (startTime.getTime() <= endTime.getTime()) { %>\n\n		<%\n			var pad = '00';\n			var hours = startTime.getHours();\n			var minutes = startTime.getMinutes();\n			var time = (pad.substring(0, pad.length - (\"\" + hours).length) + (\"\" + hours)) + ':' + (pad.substring(0, pad.length - (\"\" + minutes).length) + (\"\" + minutes));\n\n			if ((typeof(events) != 'undefined' && events.length > 0) && (typeof(hourlyBusy) != 'undefined' && hourlyBusy.length > 0))\n			{\n				var event = hourlyBusy.filter(function (element)\n				{\n					return element.dateStart.getTime() == startTime.getTime();\n				});\n\n				var tdClass = 'description';\n				var description = '';\n				var eventID = 0;\n				var tdRowSpan = '';\n\n				if (event.length > 0)\n				{\n					tdClass += ' busy';\n					description = events[event[0].index].get('eventName') + ' - ' + events[event[0].index].get('eventDescription');\n					eventID = events[event[0].index].get('eventID');\n\n					if (event[0].rowSpan > 1)\n						tdRowSpan = ' rowSpan=\"' + event[0].rowSpan + '\"';\n				}\n			}\n		%>\n\n		<tr>\n\n			<% if (time == '00:00') { %>\n\n				<td class=\"period\" rowspan=\"13\">\n					<div>MADRUGADA<Adiv>\n				</td>\n			\n			<% } %>\n\n			<% if (time == '06:30') { %>\n\n				<td class=\"period\" rowspan=\"12\">\n					<div>MANH&Atilde;</div>\n				</td>\n			\n			<% } %>\n\n			<% if (time == '12:30') { %>\n\n				<td class=\"period\" rowspan=\"12\">\n					<div>TARDE</div>\n				</td>\n			\n			<% } %>\n\n			<% if (time == '18:30') { %>\n\n				<td class=\"period noborder\" rowspan=\"12\">\n					<div>NOITE</div>\n				</td>\n			\n			<% } %>\n\n			<td class=\"hourly\">\n				<%= time %>\n			</td>\n			<td class=\"<%= tdClass %>\"<%= tdRowSpan %>>\n\n				<% if (description != '' && eventID != 0) { %>\n					<a href=\"/Calendar/Events/<%= eventID %>\" title=\"Ver detalhes\">\n						<%= description %>\n					</a>\n				<% } %>\n				\n			</td>\n		</tr>\n\n		<% startTime.setMinutes(startTime.getMinutes() + 30); %>\n\n	<% } %>\n\n</table>"}),function(e,t){function n(t,n){var i,s,o,u=t.nodeName.toLowerCase();return"area"===u?(i=t.parentNode,s=i.name,t.href&&s&&"map"===i.nodeName.toLowerCase()?(o=e("img[usemap=#"+s+"]")[0],!!o&&r(o)):!1):(/input|select|textarea|button|object/.test(u)?!t.disabled:"a"===u?t.href||n:n)&&r(t)}function r(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var i=0,s=/^ui-id-\d+$/;e.ui=e.ui||{},e.extend(e.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({focus:function(t){return function(n,r){return"number"==typeof n?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),r&&r.call(t)},n)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length)for(var r,i,s=e(this[0]);s.length&&s[0]!==document;){if(r=s.css("position"),("absolute"===r||"relative"===r||"fixed"===r)&&(i=parseInt(s.css("zIndex"),10),!isNaN(i)&&0!==i))return i;s=s.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++i)})},removeUniqueId:function(){return this.each(function(){s.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,r){return!!e.data(t,r[3])},focusable:function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var r=e.attr(t,"tabindex"),i=isNaN(r);return(i||r>=0)&&n(t,!i)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(n,r){function i(t,n,r,i){return e.each(s,function(){n-=parseFloat(e.css(t,"padding"+this))||0,r&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),i&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var s="Width"===r?["Left","Right"]:["Top","Bottom"],o=r.toLowerCase(),u={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+r]=function(n){return n===t?u["inner"+r].call(this):this.each(function(){e(this).css(o,i(this,n)+"px")})},e.fn["outer"+r]=function(t,n){return"number"!=typeof t?u["outer"+r].call(this,t):this.each(function(){e(this).css(o,i(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,n,r){var i,s=e.ui[t].prototype;for(i in r)s.plugins[i]=s.plugins[i]||[],s.plugins[i].push([n,r[i]])},call:function(e,t,n){var r,i=e.plugins[t];if(i&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(r=0;i.length>r;r++)e.options[i[r][0]]&&i[r][1].apply(e.element,n)}},hasScroll:function(t,n){if("hidden"===e(t).css("overflow"))return!1;var r=n&&"left"===n?"scrollLeft":"scrollTop",i=!1;return t[r]>0?!0:(t[r]=1,i=t[r]>0,t[r]=0,i)}})}(jQuery),function(e,t){function n(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},e.extend(this._defaults,this.regional[""]),this.dpDiv=r(e("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function r(t){var n="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(n,"mouseout",function(){e(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).removeClass("ui-datepicker-next-hover")}).delegate(n,"mouseover",function(){e.datepicker._isDisabledDatepicker(s.inline?t.parent()[0]:s.input[0])||(e(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),e(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&e(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&e(this).addClass("ui-datepicker-next-hover"))})}function i(t,n){e.extend(t,n);for(var r in n)null==n[r]&&(t[r]=n[r]);return t}e.extend(e.ui,{datepicker:{version:"1.10.3"}});var s,o="datepicker";e.extend(n.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return i(this._defaults,e||{}),this},_attachDatepicker:function(t,n){var r,i,s;r=t.nodeName.toLowerCase(),i="div"===r||"span"===r,t.id||(this.uuid+=1,t.id="dp"+this.uuid),s=this._newInst(e(t),i),s.settings=e.extend({},n||{}),"input"===r?this._connectDatepicker(t,s):i&&this._inlineDatepicker(t,s)},_newInst:function(t,n){var i=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:i,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:n,dpDiv:n?r(e("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(t,n){var r=e(t);n.append=e([]),n.trigger=e([]),r.hasClass(this.markerClassName)||(this._attachments(r,n),r.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(n),e.data(t,o,n),n.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,n){var r,i,s,o=this._get(n,"appendText"),u=this._get(n,"isRTL");n.append&&n.append.remove(),o&&(n.append=e("<span class='"+this._appendClass+"'>"+o+"</span>"),t[u?"before":"after"](n.append)),t.unbind("focus",this._showDatepicker),n.trigger&&n.trigger.remove(),r=this._get(n,"showOn"),("focus"===r||"both"===r)&&t.focus(this._showDatepicker),("button"===r||"both"===r)&&(i=this._get(n,"buttonText"),s=this._get(n,"buttonImage"),n.trigger=e(this._get(n,"buttonImageOnly")?e("<img/>").addClass(this._triggerClass).attr({src:s,alt:i,title:i}):e("<button type='button'></button>").addClass(this._triggerClass).html(s?e("<img/>").attr({src:s,alt:i,title:i}):i)),t[u?"before":"after"](n.trigger),n.trigger.click(function(){return e.datepicker._datepickerShowing&&e.datepicker._lastInput===t[0]?e.datepicker._hideDatepicker():e.datepicker._datepickerShowing&&e.datepicker._lastInput!==t[0]?(e.datepicker._hideDatepicker(),e.datepicker._showDatepicker(t[0])):e.datepicker._showDatepicker(t[0]),!1}))},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t,n,r,i,s=new Date(2009,11,20),o=this._get(e,"dateFormat");o.match(/[DM]/)&&(t=function(e){for(n=0,r=0,i=0;e.length>i;i++)e[i].length>n&&(n=e[i].length,r=i);return r},s.setMonth(t(this._get(e,o.match(/MM/)?"monthNames":"monthNamesShort"))),s.setDate(t(this._get(e,o.match(/DD/)?"dayNames":"dayNamesShort"))+20-s.getDay())),e.input.attr("size",this._formatDate(e,s).length)}},_inlineDatepicker:function(t,n){var r=e(t);r.hasClass(this.markerClassName)||(r.addClass(this.markerClassName).append(n.dpDiv),e.data(t,o,n),this._setDate(n,this._getDefaultDate(n),!0),this._updateDatepicker(n),this._updateAlternate(n),n.settings.disabled&&this._disableDatepicker(t),n.dpDiv.css("display","block"))},_dialogDatepicker:function(t,n,r,s,u){var a,f,l,c,h,p=this._dialogInst;return p||(this.uuid+=1,a="dp"+this.uuid,this._dialogInput=e("<input type='text' id='"+a+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),e("body").append(this._dialogInput),p=this._dialogInst=this._newInst(this._dialogInput,!1),p.settings={},e.data(this._dialogInput[0],o,p)),i(p.settings,s||{}),n=n&&n.constructor===Date?this._formatDate(p,n):n,this._dialogInput.val(n),this._pos=u?u.length?u:[u.pageX,u.pageY]:null,this._pos||(f=document.documentElement.clientWidth,l=document.documentElement.clientHeight,c=document.documentElement.scrollLeft||document.body.scrollLeft,h=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[f/2-100+c,l/2-150+h]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),p.settings.onSelect=r,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),e.blockUI&&e.blockUI(this.dpDiv),e.data(this._dialogInput[0],o,p),this},_destroyDatepicker:function(t){var n,r=e(t),i=e.data(t,o);r.hasClass(this.markerClassName)&&(n=t.nodeName.toLowerCase(),e.removeData(t,o),"input"===n?(i.append.remove(),i.trigger.remove(),r.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===n||"span"===n)&&r.removeClass(this.markerClassName).empty())},_enableDatepicker:function(t){var n,r,i=e(t),s=e.data(t,o);i.hasClass(this.markerClassName)&&(n=t.nodeName.toLowerCase(),"input"===n?(t.disabled=!1,s.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===n||"span"===n)&&(r=i.children("."+this._inlineClass),r.children().removeClass("ui-state-disabled"),r.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}))},_disableDatepicker:function(t){var n,r,i=e(t),s=e.data(t,o);i.hasClass(this.markerClassName)&&(n=t.nodeName.toLowerCase(),"input"===n?(t.disabled=!0,s.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===n||"span"===n)&&(r=i.children("."+this._inlineClass),r.children().addClass("ui-state-disabled"),r.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=e.map(this._disabledInputs,function(e){return e===t?null:e}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(e){if(!e)return!1;for(var t=0;this._disabledInputs.length>t;t++)if(this._disabledInputs[t]===e)return!0;return!1},_getInst:function(t){try{return e.data(t,o)}catch(n){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(n,r,s){var o,u,a,f,l=this._getInst(n);return 2===arguments.length&&"string"==typeof r?"defaults"===r?e.extend({},e.datepicker._defaults):l?"all"===r?e.extend({},l.settings):this._get(l,r):null:(o=r||{},"string"==typeof r&&(o={},o[r]=s),l&&(this._curInst===l&&this._hideDatepicker(),u=this._getDateDatepicker(n,!0),a=this._getMinMaxDate(l,"min"),f=this._getMinMaxDate(l,"max"),i(l.settings,o),null!==a&&o.dateFormat!==t&&o.minDate===t&&(l.settings.minDate=this._formatDate(l,a)),null!==f&&o.dateFormat!==t&&o.maxDate===t&&(l.settings.maxDate=this._formatDate(l,f)),"disabled"in o&&(o.disabled?this._disableDatepicker(n):this._enableDatepicker(n)),this._attachments(e(n),l),this._autoSize(l),this._setDate(l,u),this._updateAlternate(l),this._updateDatepicker(l)),t)},_changeDatepicker:function(e,t,n){this._optionDatepicker(e,t,n)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var n=this._getInst(e);n&&(this._setDate(n,t),this._updateDatepicker(n),this._updateAlternate(n))},_getDateDatepicker:function(e,t){var n=this._getInst(e);return n&&!n.inline&&this._setDateFromField(n,t),n?this._getDate(n):null},_doKeyDown:function(t){var n,r,i,s=e.datepicker._getInst(t.target),o=!0,u=s.dpDiv.is(".ui-datepicker-rtl");if(s._keyEvent=!0,e.datepicker._datepickerShowing)switch(t.keyCode){case 9:e.datepicker._hideDatepicker(),o=!1;break;case 13:return i=e("td."+e.datepicker._dayOverClass+":not(."+e.datepicker._currentClass+")",s.dpDiv),i[0]&&e.datepicker._selectDay(t.target,s.selectedMonth,s.selectedYear,i[0]),n=e.datepicker._get(s,"onSelect"),n?(r=e.datepicker._formatDate(s),n.apply(s.input?s.input[0]:null,[r,s])):e.datepicker._hideDatepicker(),!1;case 27:e.datepicker._hideDatepicker();break;case 33:e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(s,"stepBigMonths"):-e.datepicker._get(s,"stepMonths"),"M");break;case 34:e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(s,"stepBigMonths"):+e.datepicker._get(s,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&e.datepicker._clearDate(t.target),o=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&e.datepicker._gotoToday(t.target),o=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,u?1:-1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?-e.datepicker._get(s,"stepBigMonths"):-e.datepicker._get(s,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,-7,"D"),o=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,u?-1:1,"D"),o=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&e.datepicker._adjustDate(t.target,t.ctrlKey?+e.datepicker._get(s,"stepBigMonths"):+e.datepicker._get(s,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&e.datepicker._adjustDate(t.target,7,"D"),o=t.ctrlKey||t.metaKey;break;default:o=!1}else 36===t.keyCode&&t.ctrlKey?e.datepicker._showDatepicker(this):o=!1;o&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(n){var r,i,s=e.datepicker._getInst(n.target);return e.datepicker._get(s,"constrainInput")?(r=e.datepicker._possibleChars(e.datepicker._get(s,"dateFormat")),i=String.fromCharCode(null==n.charCode?n.keyCode:n.charCode),n.ctrlKey||n.metaKey||" ">i||!r||r.indexOf(i)>-1):t},_doKeyUp:function(t){var n,r=e.datepicker._getInst(t.target);if(r.input.val()!==r.lastVal)try{n=e.datepicker.parseDate(e.datepicker._get(r,"dateFormat"),r.input?r.input.val():null,e.datepicker._getFormatConfig(r)),n&&(e.datepicker._setDateFromField(r),e.datepicker._updateAlternate(r),e.datepicker._updateDatepicker(r))}catch(i){}return!0},_showDatepicker:function(t){if(t=t.target||t,"input"!==t.nodeName.toLowerCase()&&(t=e("input",t.parentNode)[0]),!e.datepicker._isDisabledDatepicker(t)&&e.datepicker._lastInput!==t){var n,r,s,o,u,a,f;n=e.datepicker._getInst(t),e.datepicker._curInst&&e.datepicker._curInst!==n&&(e.datepicker._curInst.dpDiv.stop(!0,!0),n&&e.datepicker._datepickerShowing&&e.datepicker._hideDatepicker(e.datepicker._curInst.input[0])),r=e.datepicker._get(n,"beforeShow"),s=r?r.apply(t,[t,n]):{},s!==!1&&(i(n.settings,s),n.lastVal=null,e.datepicker._lastInput=t,e.datepicker._setDateFromField(n),e.datepicker._inDialog&&(t.value=""),e.datepicker._pos||(e.datepicker._pos=e.datepicker._findPos(t),e.datepicker._pos[1]+=t.offsetHeight),o=!1,e(t).parents().each(function(){return o|="fixed"===e(this).css("position"),!o}),u={left:e.datepicker._pos[0],top:e.datepicker._pos[1]},e.datepicker._pos=null,n.dpDiv.empty(),n.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),e.datepicker._updateDatepicker(n),u=e.datepicker._checkOffset(n,u,o),n.dpDiv.css({position:e.datepicker._inDialog&&e.blockUI?"static":o?"fixed":"absolute",display:"none",left:u.left+"px",top:u.top+"px"}),n.inline||(a=e.datepicker._get(n,"showAnim"),f=e.datepicker._get(n,"duration"),n.dpDiv.zIndex(e(t).zIndex()+1),e.datepicker._datepickerShowing=!0,e.effects&&e.effects.effect[a]?n.dpDiv.show(a,e.datepicker._get(n,"showOptions"),f):n.dpDiv[a||"show"](a?f:null),e.datepicker._shouldFocusInput(n)&&n.input.focus(),e.datepicker._curInst=n))}},_updateDatepicker:function(t){this.maxRows=4,s=t,t.dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t),t.dpDiv.find("."+this._dayOverClass+" a").mouseover();var n,r=this._getNumberOfMonths(t),i=r[1],o=17;t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),i>1&&t.dpDiv.addClass("ui-datepicker-multi-"+i).css("width",o*i+"em"),t.dpDiv[(1!==r[0]||1!==r[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===e.datepicker._curInst&&e.datepicker._datepickerShowing&&e.datepicker._shouldFocusInput(t)&&t.input.focus(),t.yearshtml&&(n=t.yearshtml,setTimeout(function(){n===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml),n=t.yearshtml=null},0))},_shouldFocusInput:function(e){return e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&!e.input.is(":focus")},_checkOffset:function(t,n,r){var i=t.dpDiv.outerWidth(),s=t.dpDiv.outerHeight(),o=t.input?t.input.outerWidth():0,u=t.input?t.input.outerHeight():0,a=document.documentElement.clientWidth+(r?0:e(document).scrollLeft()),f=document.documentElement.clientHeight+(r?0:e(document).scrollTop());return n.left-=this._get(t,"isRTL")?i-o:0,n.left-=r&&n.left===t.input.offset().left?e(document).scrollLeft():0,n.top-=r&&n.top===t.input.offset().top+u?e(document).scrollTop():0,n.left-=Math.min(n.left,n.left+i>a&&a>i?Math.abs(n.left+i-a):0),n.top-=Math.min(n.top,n.top+s>f&&f>s?Math.abs(s+u):0),n},_findPos:function(t){for(var n,r=this._getInst(t),i=this._get(r,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||e.expr.filters.hidden(t));)t=t[i?"previousSibling":"nextSibling"];return n=e(t).offset(),[n.left,n.top]},_hideDatepicker:function(t){var n,r,i,s,u=this._curInst;!u||t&&u!==e.data(t,o)||this._datepickerShowing&&(n=this._get(u,"showAnim"),r=this._get(u,"duration"),i=function(){e.datepicker._tidyDialog(u)},e.effects&&(e.effects.effect[n]||e.effects[n])?u.dpDiv.hide(n,e.datepicker._get(u,"showOptions"),r,i):u.dpDiv["slideDown"===n?"slideUp":"fadeIn"===n?"fadeOut":"hide"](n?r:null,i),n||i(),this._datepickerShowing=!1,s=this._get(u,"onClose"),s&&s.apply(u.input?u.input[0]:null,[u.input?u.input.val():"",u]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),e.blockUI&&(e.unblockUI(),e("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(e.datepicker._curInst){var n=e(t.target),r=e.datepicker._getInst(n[0]);(n[0].id!==e.datepicker._mainDivId&&0===n.parents("#"+e.datepicker._mainDivId).length&&!n.hasClass(e.datepicker.markerClassName)&&!n.closest("."+e.datepicker._triggerClass).length&&e.datepicker._datepickerShowing&&(!e.datepicker._inDialog||!e.blockUI)||n.hasClass(e.datepicker.markerClassName)&&e.datepicker._curInst!==r)&&e.datepicker._hideDatepicker()}},_adjustDate:function(t,n,r){var i=e(t),s=this._getInst(i[0]);this._isDisabledDatepicker(i[0])||(this._adjustInstDate(s,n+("M"===r?this._get(s,"showCurrentAtPos"):0),r),this._updateDatepicker(s))},_gotoToday:function(t){var n,r=e(t),i=this._getInst(r[0]);this._get(i,"gotoCurrent")&&i.currentDay?(i.selectedDay=i.currentDay,i.drawMonth=i.selectedMonth=i.currentMonth,i.drawYear=i.selectedYear=i.currentYear):(n=new Date,i.selectedDay=n.getDate(),i.drawMonth=i.selectedMonth=n.getMonth(),i.drawYear=i.selectedYear=n.getFullYear()),this._notifyChange(i),this._adjustDate(r)},_selectMonthYear:function(t,n,r){var i=e(t),s=this._getInst(i[0]);s["selected"+("M"===r?"Month":"Year")]=s["draw"+("M"===r?"Month":"Year")]=parseInt(n.options[n.selectedIndex].value,10),this._notifyChange(s),this._adjustDate(i)},_selectDay:function(t,n,r,i){var s,o=e(t);e(i).hasClass(this._unselectableClass)||this._isDisabledDatepicker(o[0])||(s=this._getInst(o[0]),s.selectedDay=s.currentDay=e("a",i).html(),s.selectedMonth=s.currentMonth=n,s.selectedYear=s.currentYear=r,this._selectDate(t,this._formatDate(s,s.currentDay,s.currentMonth,s.currentYear)))},_clearDate:function(t){var n=e(t);this._selectDate(n,"")},_selectDate:function(t,n){var r,i=e(t),s=this._getInst(i[0]);n=null!=n?n:this._formatDate(s),s.input&&s.input.val(n),this._updateAlternate(s),r=this._get(s,"onSelect"),r?r.apply(s.input?s.input[0]:null,[n,s]):s.input&&s.input.trigger("change"),s.inline?this._updateDatepicker(s):(this._hideDatepicker(),this._lastInput=s.input[0],"object"!=typeof s.input[0]&&s.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var n,r,i,s=this._get(t,"altField");s&&(n=this._get(t,"altFormat")||this._get(t,"dateFormat"),r=this._getDate(t),i=this.formatDate(n,r,this._getFormatConfig(t)),e(s).each(function(){e(this).val(i)}))},noWeekends:function(e){var t=e.getDay();return[t>0&&6>t,""]},iso8601Week:function(e){var t,n=new Date(e.getTime());return n.setDate(n.getDate()+4-(n.getDay()||7)),t=n.getTime(),n.setMonth(0),n.setDate(1),Math.floor(Math.round((t-n)/864e5)/7)+1},parseDate:function(n,r,i){if(null==n||null==r)throw"Invalid arguments";if(r="object"==typeof r?""+r:r+"",""===r)return null;var s,o,u,a,f=0,l=(i?i.shortYearCutoff:null)||this._defaults.shortYearCutoff,c="string"!=typeof l?l:(new Date).getFullYear()%100+parseInt(l,10),h=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,p=(i?i.dayNames:null)||this._defaults.dayNames,d=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,v=(i?i.monthNames:null)||this._defaults.monthNames,m=-1,g=-1,y=-1,b=-1,w=!1,E=function(e){var t=n.length>s+1&&n.charAt(s+1)===e;return t&&s++,t},S=function(e){var t=E(e),n="@"===e?14:"!"===e?20:"y"===e&&t?4:"o"===e?3:2,i=RegExp("^\\d{1,"+n+"}"),s=r.substring(f).match(i);if(!s)throw"Missing number at position "+f;return f+=s[0].length,parseInt(s[0],10)},x=function(n,i,s){var o=-1,u=e.map(E(n)?s:i,function(e,t){return[[t,e]]}).sort(function(e,t){return-(e[1].length-t[1].length)});if(e.each(u,function(e,n){var i=n[1];return r.substr(f,i.length).toLowerCase()===i.toLowerCase()?(o=n[0],f+=i.length,!1):t}),-1!==o)return o+1;throw"Unknown name at position "+f},T=function(){if(r.charAt(f)!==n.charAt(s))throw"Unexpected literal at position "+f;f++};for(s=0;n.length>s;s++)if(w)"'"!==n.charAt(s)||E("'")?T():w=!1;else switch(n.charAt(s)){case"d":y=S("d");break;case"D":x("D",h,p);break;case"o":b=S("o");break;case"m":g=S("m");break;case"M":g=x("M",d,v);break;case"y":m=S("y");break;case"@":a=new Date(S("@")),m=a.getFullYear(),g=a.getMonth()+1,y=a.getDate();break;case"!":a=new Date((S("!")-this._ticksTo1970)/1e4),m=a.getFullYear(),g=a.getMonth()+1,y=a.getDate();break;case"'":E("'")?T():w=!0;break;default:T()}if(r.length>f&&(u=r.substr(f),!/^\s+/.test(u)))throw"Extra/unparsed characters found in date: "+u;if(-1===m?m=(new Date).getFullYear():100>m&&(m+=(new Date).getFullYear()-(new Date).getFullYear()%100+(c>=m?0:-100)),b>-1)for(g=1,y=b;;){if(o=this._getDaysInMonth(m,g-1),o>=y)break;g++,y-=o}if(a=this._daylightSavingAdjust(new Date(m,g-1,y)),a.getFullYear()!==m||a.getMonth()+1!==g||a.getDate()!==y)throw"Invalid date";return a},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864e9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(e,t,n){if(!t)return"";var r,i=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,s=(n?n.dayNames:null)||this._defaults.dayNames,o=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,u=(n?n.monthNames:null)||this._defaults.monthNames,a=function(t){var n=e.length>r+1&&e.charAt(r+1)===t;return n&&r++,n},f=function(e,t,n){var r=""+t;if(a(e))for(;n>r.length;)r="0"+r;return r},l=function(e,t,n,r){return a(e)?r[t]:n[t]},c="",h=!1;if(t)for(r=0;e.length>r;r++)if(h)"'"!==e.charAt(r)||a("'")?c+=e.charAt(r):h=!1;else switch(e.charAt(r)){case"d":c+=f("d",t.getDate(),2);break;case"D":c+=l("D",t.getDay(),i,s);break;case"o":c+=f("o",Math.round(((new Date(t.getFullYear(),t.getMonth(),t.getDate())).getTime()-(new Date(t.getFullYear(),0,0)).getTime())/864e5),3);break;case"m":c+=f("m",t.getMonth()+1,2);break;case"M":c+=l("M",t.getMonth(),o,u);break;case"y":c+=a("y")?t.getFullYear():(10>t.getYear()%100?"0":"")+t.getYear()%100;break;case"@":c+=t.getTime();break;case"!":c+=1e4*t.getTime()+this._ticksTo1970;break;case"'":a("'")?c+="'":h=!0;break;default:c+=e.charAt(r)}return c},_possibleChars:function(e){var t,n="",r=!1,i=function(n){var r=e.length>t+1&&e.charAt(t+1)===n;return r&&t++,r};for(t=0;e.length>t;t++)if(r)"'"!==e.charAt(t)||i("'")?n+=e.charAt(t):r=!1;else switch(e.charAt(t)){case"d":case"m":case"y":case"@":n+="0123456789";break;case"D":case"M":return null;case"'":i("'")?n+="'":r=!0;break;default:n+=e.charAt(t)}return n},_get:function(e,n){return e.settings[n]!==t?e.settings[n]:this._defaults[n]},_setDateFromField:function(e,t){if(e.input.val()!==e.lastVal){var n=this._get(e,"dateFormat"),r=e.lastVal=e.input?e.input.val():null,i=this._getDefaultDate(e),s=i,o=this._getFormatConfig(e);try{s=this.parseDate(n,r,o)||i}catch(u){r=t?"":r}e.selectedDay=s.getDate(),e.drawMonth=e.selectedMonth=s.getMonth(),e.drawYear=e.selectedYear=s.getFullYear(),e.currentDay=r?s.getDate():0,e.currentMonth=r?s.getMonth():0,e.currentYear=r?s.getFullYear():0,this._adjustInstDate(e)}},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(t,n,r){var i=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},s=function(n){try{return e.datepicker.parseDate(e.datepicker._get(t,"dateFormat"),n,e.datepicker._getFormatConfig(t))}catch(r){}for(var i=(n.toLowerCase().match(/^c/)?e.datepicker._getDate(t):null)||new Date,s=i.getFullYear(),o=i.getMonth(),u=i.getDate(),a=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,f=a.exec(n);f;){switch(f[2]||"d"){case"d":case"D":u+=parseInt(f[1],10);break;case"w":case"W":u+=7*parseInt(f[1],10);break;case"m":case"M":o+=parseInt(f[1],10),u=Math.min(u,e.datepicker._getDaysInMonth(s,o));break;case"y":case"Y":s+=parseInt(f[1],10),u=Math.min(u,e.datepicker._getDaysInMonth(s,o))}f=a.exec(n)}return new Date(s,o,u)},o=null==n||""===n?r:"string"==typeof n?s(n):"number"==typeof n?isNaN(n)?r:i(n):new Date(n.getTime());return o=o&&"Invalid Date"==""+o?r:o,o&&(o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0)),this._daylightSavingAdjust(o)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,n){var r=!t,i=e.selectedMonth,s=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth(),e.drawYear=e.selectedYear=e.currentYear=o.getFullYear(),i===e.selectedMonth&&s===e.selectedYear||n||this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(r?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&""===e.input.val()?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(t){var n=this._get(t,"stepMonths"),r="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){e.datepicker._adjustDate(r,-n,"M")},next:function(){e.datepicker._adjustDate(r,+n,"M")},hide:function(){e.datepicker._hideDatepicker()},today:function(){e.datepicker._gotoToday(r)},selectDay:function(){return e.datepicker._selectDay(r,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return e.datepicker._selectMonthYear(r,this,"M"),!1},selectYear:function(){return e.datepicker._selectMonthYear(r,this,"Y"),!1}};e(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q=new Date,R=this._daylightSavingAdjust(new Date(q.getFullYear(),q.getMonth(),q.getDate())),U=this._get(e,"isRTL"),z=this._get(e,"showButtonPanel"),W=this._get(e,"hideIfNoPrevNext"),X=this._get(e,"navigationAsDateFormat"),V=this._getNumberOfMonths(e),$=this._get(e,"showCurrentAtPos"),J=this._get(e,"stepMonths"),K=1!==V[0]||1!==V[1],Q=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),G=this._getMinMaxDate(e,"min"),Y=this._getMinMaxDate(e,"max"),Z=e.drawMonth-$,et=e.drawYear;if(0>Z&&(Z+=12,et--),Y)for(t=this._daylightSavingAdjust(new Date(Y.getFullYear(),Y.getMonth()-V[0]*V[1]+1,Y.getDate())),t=G&&G>t?G:t;this._daylightSavingAdjust(new Date(et,Z,1))>t;)Z--,0>Z&&(Z=11,et--);for(e.drawMonth=Z,e.drawYear=et,n=this._get(e,"prevText"),n=X?this.formatDate(n,this._daylightSavingAdjust(new Date(et,Z-J,1)),this._getFormatConfig(e)):n,r=this._canAdjustMonth(e,-1,et,Z)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"e":"w")+"'>"+n+"</span></a>":W?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+n+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"e":"w")+"'>"+n+"</span></a>",i=this._get(e,"nextText"),i=X?this.formatDate(i,this._daylightSavingAdjust(new Date(et,Z+J,1)),this._getFormatConfig(e)):i,s=this._canAdjustMonth(e,1,et,Z)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"w":"e")+"'>"+i+"</span></a>":W?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+i+"'><span class='ui-icon ui-icon-circle-triangle-"+(U?"w":"e")+"'>"+i+"</span></a>",o=this._get(e,"currentText"),u=this._get(e,"gotoCurrent")&&e.currentDay?Q:R,o=X?this.formatDate(o,u,this._getFormatConfig(e)):o,a=e.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(e,"closeText")+"</button>",f=z?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(U?a:"")+(this._isInRange(e,u)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+o+"</button>":"")+(U?"":a)+"</div>":"",l=parseInt(this._get(e,"firstDay"),10),l=isNaN(l)?0:l,c=this._get(e,"showWeek"),h=this._get(e,"dayNames"),p=this._get(e,"dayNamesMin"),d=this._get(e,"monthNames"),v=this._get(e,"monthNamesShort"),m=this._get(e,"beforeShowDay"),g=this._get(e,"showOtherMonths"),y=this._get(e,"selectOtherMonths"),b=this._getDefaultDate(e),w="",S=0;V[0]>S;S++){for(x="",this.maxRows=4,T=0;V[1]>T;T++){if(N=this._daylightSavingAdjust(new Date(et,Z,e.selectedDay)),C=" ui-corner-all",k="",K){if(k+="<div class='ui-datepicker-group",V[1]>1)switch(T){case 0:k+=" ui-datepicker-group-first",C=" ui-corner-"+(U?"right":"left");break;case V[1]-1:k+=" ui-datepicker-group-last",C=" ui-corner-"+(U?"left":"right");break;default:k+=" ui-datepicker-group-middle",C=""}k+="'>"}for(k+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+C+"'>"+(/all|left/.test(C)&&0===S?U?s:r:"")+(/all|right/.test(C)&&0===S?U?r:s:"")+this._generateMonthYearHeader(e,Z,et,G,Y,S>0||T>0,d,v)+"</div><table class='ui-datepicker-calendar'><thead>"+"<tr>",L=c?"<th class='ui-datepicker-week-col'>"+this._get(e,"weekHeader")+"</th>":"",E=0;7>E;E++)A=(E+l)%7,L+="<th"+((E+l+6)%7>=5?" class='ui-datepicker-week-end'":"")+">"+"<span title='"+h[A]+"'>"+p[A]+"</span></th>";for(k+=L+"</tr></thead><tbody>",O=this._getDaysInMonth(et,Z),et===e.selectedYear&&Z===e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,O)),M=(this._getFirstDayOfMonth(et,Z)-l+7)%7,_=Math.ceil((M+O)/7),D=K?this.maxRows>_?this.maxRows:_:_,this.maxRows=D,P=this._daylightSavingAdjust(new Date(et,Z,1-M)),H=0;D>H;H++){for(k+="<tr>",B=c?"<td class='ui-datepicker-week-col'>"+this._get(e,"calculateWeek")(P)+"</td>":"",E=0;7>E;E++)j=m?m.apply(e.input?e.input[0]:null,[P]):[!0,""],F=P.getMonth()!==Z,I=F&&!y||!j[0]||G&&G>P||Y&&P>Y,B+="<td class='"+((E+l+6)%7>=5?" ui-datepicker-week-end":"")+(F?" ui-datepicker-other-month":"")+(P.getTime()===N.getTime()&&Z===e.selectedMonth&&e._keyEvent||b.getTime()===P.getTime()&&b.getTime()===N.getTime()?" "+this._dayOverClass:"")+(I?" "+this._unselectableClass+" ui-state-disabled":"")+(F&&!g?"":" "+j[1]+(P.getTime()===Q.getTime()?" "+this._currentClass:"")+(P.getTime()===R.getTime()?" ui-datepicker-today":""))+"'"+(F&&!g||!j[2]?"":" title='"+j[2].replace(/'/g,"&#39;")+"'")+(I?"":" data-handler='selectDay' data-event='click' data-month='"+P.getMonth()+"' data-year='"+P.getFullYear()+"'")+">"+(F&&!g?"&#xa0;":I?"<span class='ui-state-default'>"+P.getDate()+"</span>":"<a class='ui-state-default"+(P.getTime()===R.getTime()?" ui-state-highlight":"")+(P.getTime()===Q.getTime()?" ui-state-active":"")+(F?" ui-priority-secondary":"")+"' href='#'>"+P.getDate()+"</a>")+"</td>",P.setDate(P.getDate()+1),P=this._daylightSavingAdjust(P);k+=B+"</tr>"}Z++,Z>11&&(Z=0,et++),k+="</tbody></table>"+(K?"</div>"+(V[0]>0&&T===V[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),x+=k}w+=x}return w+=f,e._keyEvent=!1,w},_generateMonthYearHeader:function(e,t,n,r,i,s,o,u){var a,f,l,c,h,p,d,v,m=this._get(e,"changeMonth"),g=this._get(e,"changeYear"),y=this._get(e,"showMonthAfterYear"),b="<div class='ui-datepicker-title'>",w="";if(s||!m)w+="<span class='ui-datepicker-month'>"+o[t]+"</span>";else{for(a=r&&r.getFullYear()===n,f=i&&i.getFullYear()===n,w+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",l=0;12>l;l++)(!a||l>=r.getMonth())&&(!f||i.getMonth()>=l)&&(w+="<option value='"+l+"'"+(l===t?" selected='selected'":"")+">"+u[l]+"</option>");w+="</select>"}if(y||(b+=w+(!s&&m&&g?"":"&#xa0;")),!e.yearshtml)if(e.yearshtml="",s||!g)b+="<span class='ui-datepicker-year'>"+n+"</span>";else{for(c=this._get(e,"yearRange").split(":"),h=(new Date).getFullYear(),p=function(e){var t=e.match(/c[+\-].*/)?n+parseInt(e.substring(1),10):e.match(/[+\-].*/)?h+parseInt(e,10):parseInt(e,10);return isNaN(t)?h:t},d=p(c[0]),v=Math.max(d,p(c[1]||"")),d=r?Math.max(d,r.getFullYear()):d,v=i?Math.min(v,i.getFullYear()):v,e.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";v>=d;d++)e.yearshtml+="<option value='"+d+"'"+(d===n?" selected='selected'":"")+">"+d+"</option>";e.yearshtml+="</select>",b+=e.yearshtml,e.yearshtml=null}return b+=this._get(e,"yearSuffix"),y&&(b+=(!s&&m&&g?"":"&#xa0;")+w),b+="</div>"},_adjustInstDate:function(e,t,n){var r=e.drawYear+("Y"===n?t:0),i=e.drawMonth+("M"===n?t:0),s=Math.min(e.selectedDay,this._getDaysInMonth(r,i))+("D"===n?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(r,i,s)));e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),("M"===n||"Y"===n)&&this._notifyChange(e)},_restrictMinMax:function(e,t){var n=this._getMinMaxDate(e,"min"),r=this._getMinMaxDate(e,"max"),i=n&&n>t?n:t;return r&&i>r?r:i},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return null==t?[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return(new Date(e,t,1)).getDay()},_canAdjustMonth:function(e,t,n,r){var i=this._getNumberOfMonths(e),s=this._daylightSavingAdjust(new Date(n,r+(0>t?t:i[0]*i[1]),1));return 0>t&&s.setDate(this._getDaysInMonth(s.getFullYear(),s.getMonth())),this._isInRange(e,s)},_isInRange:function(e,t){var n,r,i=this._getMinMaxDate(e,"min"),s=this._getMinMaxDate(e,"max"),o=null,u=null,a=this._get(e,"yearRange");return a&&(n=a.split(":"),r=(new Date).getFullYear(),o=parseInt(n[0],10),u=parseInt(n[1],10),n[0].match(/[+\-].*/)&&(o+=r),n[1].match(/[+\-].*/)&&(u+=r)),(!i||t.getTime()>=i.getTime())&&(!s||t.getTime()<=s.getTime())&&(!o||t.getFullYear()>=o)&&(!u||u>=t.getFullYear())},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t="string"!=typeof t?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,n,r){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var i=t?"object"==typeof t?t:this._daylightSavingAdjust(new Date(r,n,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),i,this._getFormatConfig(e))}}),e.fn.datepicker=function(t){if(!this.length)return this;e.datepicker.initialized||(e(document).mousedown(e.datepicker._checkExternalClick),e.datepicker.initialized=!0),0===e("#"+e.datepicker._mainDivId).length&&e("body").append(e.datepicker.dpDiv);var n=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!==t&&"getDate"!==t&&"widget"!==t?"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(n)):this.each(function(){"string"==typeof t?e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this].concat(n)):e.datepicker._attachDatepicker(this,t)}):e.datepicker["_"+t+"Datepicker"].apply(e.datepicker,[this[0]].concat(n))},e.datepicker=new n,e.datepicker.initialized=!1,e.datepicker.uuid=(new Date).getTime(),e.datepicker.version="1.10.3"}(jQuery),define("jqueryui",["jquery"],function(){}),jQuery(function(e){e.datepicker.regional["pt-BR"]={closeText:"Fechar",prevText:"&#x3C;Anterior",nextText:"Próximo&#x3E;",currentText:"Hoje",monthNames:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],monthNamesShort:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],dayNames:["Domingo","Segunda-feira","Terça-feira","Quarta-feira","Quinta-feira","Sexta-feira","Sábado"],dayNamesShort:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],dayNamesMin:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],weekHeader:"Sm",dateFormat:"dd/mm/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},e.datepicker.setDefaults(e.datepicker.regional["pt-BR"])}),define("jqueryui_datepicker_ptBR",["jquery","jqueryui"],function(){}),define("views/calendar/CalendarFullDayListView",["jquery","underscore","backbone","shared","collections/calendar/EventsListCollection","views/home/LoadingView","text!templates/calendar/calendarFullDayListTemplate.html","text!templates/master/detailContentTemplate.html","text!templates/master/primaryContentTemplate.html","jqueryui","jqueryui_datepicker_ptBR"],function(e,t,n,r,i,s,o,u,a,f,l){var c=n.View.extend({year:"",month:"",day:"",data:{},dayTitle:"",events:{"click #eventsTable a":"selectItem"},render:function(){var n=this,f,l;r.isSmartPhoneResolution()?(this.$el.html(t.template(a)),e("#content").empty().append(this.$el),f=e("#contentTitle"),l=e("#scroller")):(this.$el.html(t.template(u)),e("#contentDetail").empty().append(this.$el),f=e("#contentDetailTitle"),l=e("#scrollerDetail"));var c=new s({el:l});c.render();var h=this.day+"/"+this.month+"/"+this.year,p=this.day+"/"+this.month+"/"+this.year,d=function(r){var s=[],u=new i,a=new Date(n.year,n.month-1,n.day),c=48;for(var h in r.events){var p=0,d=r.events[h].get("eventStartDate").split(" "),v=d[0].split("/"),m=d[1].split(":"),g=new Date(v[2],v[1]-1,v[0],m[0],m[1]),y=new Date(v[2],v[1]-1,v[0],m[0],m[1]);v=new Date(v[2],v[1]-1,v[0]);var b=r.events[h].get("eventEndDate").split(" "),w=b[0].split("/"),E=b[1].split(":"),S=new Date(w[2],w[1]-1,w[0],E[0],E[1]);w=new Date(w[2],w[1]-1,w[0]);if(v.getTime()==a.getTime()||w.getTime()==a.getTime()){if(r.events[h].get("eventAllDay")=="1")p=c;else while(g.getTime()<=S.getTime())p+=1,g.setMinutes(g.getMinutes()+30);u.add(r.events[h]);var x=g,T=new Object;T.dateStart=y,T.dateEnd=S,T.rowSpan=p,T.index=u.length-1,s.push(T)}}var N={events:u.models,year:n.year,month:n.month,day:n.day,hourlyBusy:s,_:t};f.text(e.datepicker.formatDate("DD, dd/mm/yy",new Date(n.year,n.month-1,n.day))),l.empty().append(t.template(o,N)),n.loaded()},v=function(e){r.showMessage({type:"error",icon:"icon-agenda",title:"Não foi possível listar os eventos do dia. Por favor, tente novamente",description:"",timeout:5e3,elementID:r.isSmartPhoneResolution()?"#message":"#messageDetail"})};this.listEvents(h,p,d,v)},getiScroll:function(e){var t=this;pullDownEl=document.getElementById("pullDown"),pullDownOffset=pullDownEl.offsetHeight;var n=new iScroll(e,{useTransition:!0,topOffset:pullDownOffset,onRefresh:function(){pullDownEl.className.match("loading")&&(pullDownEl.className="",pullDownEl.querySelector(".pullDownLabel").innerHTML="Puxe para baixo para atualizar...")},onScrollMove:function(){this.y>5&&!pullDownEl.className.match("flip")?(pullDownEl.className="flip",pullDownEl.querySelector(".pullDownLabel").innerHTML="Solte para atualizar...",this.minScrollY=0):this.y<5&&pullDownEl.className.match("flip")&&(pullDownEl.className="",pullDownEl.querySelector(".pullDownLabel").innerHTML="Puxe para baixo para atualizar...",this.minScrollY=-pullDownOffset)},onScrollEnd:function(){pullDownEl.className.match("flip")&&(pullDownEl.className="loading",pullDownEl.querySelector(".pullDownLabel").innerHTML="Carregando...",t.pullDownAction())}});return n},loaded:function(){e("#contentDetail .searchArea").remove(),r.isSmartPhoneResolution()?(r.scroll!=null&&(r.scroll.destroy(),r.scroll=null),r.scroll=this.getiScroll("wrapper")):(r.scrollDetail!=null&&(r.scrollDetail.destroy(),r.scrollDetail=null),r.scrollDetail=new iScroll("wrapperDetail",{})),r.scrollerRefresh(),r.menuView.renderContextMenu("calendar",{year:this.year,month:this.month,day:this.day})},initialize:function(){},selectItem:function(e){e.preventDefault(),r.router.navigate(e.currentTarget.getAttribute("href"),{trigger:!0})},listEvents:function(e,n,r,s){var o=this,u=new i;u.done(function(e){r&&r({events:e.models,_:t})}).fail(function(e){s&&s({error:e.error,_:t})}).listEvents(e,n)}});return c}),define("text!templates/calendar/calendarTemplate.html",[],function(){return'<div id="pullDown">\n  	<span class="pullDownIcon"></span><span class="pullDownLabel">Puxe para baixo para atualizar</span>\n</div>\n<div id="agenda"></div>\n<div id="eventsList"></div>'}),define("views/calendar/CalendarListView",["jquery","underscore","backbone","shared","collections/calendar/EventsListCollection","views/home/LoadingView","views/calendar/CalendarEventsDayListView","views/calendar/CalendarFullDayListView","text!templates/calendar/calendarTemplate.html","text!templates/master/primaryContentTemplate.html","jqueryui","jqueryui_datepicker_ptBR"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h=n.View.extend({year:"",month:"",day:"",fullDay:!1,status:"",data:{},dayTitle:"",onlyDatePicker:!1,render:function(){var n=this,r="00",i=new Date;if(this.year==""||this.year==undefined)this.year=i.getFullYear();if(this.month==""||this.month==undefined)this.month=i.getMonth()+1,this.month=r.substring(0,r.length-(""+this.month).length)+(""+this.month);if(this.day==""||this.day==undefined)this.day=i.getDate(),this.day=r.substring(0,r.length-(""+this.day).length)+(""+this.day);this.clean();var s=function(r){n.$el.html(t.template(f)),e("#content").empty().append(n.$el),e("#scroller").html(t.template(a)),n.renderDatePicker(),n.onlyDatePicker===!1&&n.listDayEvents(r),n.loaded()},o=new Date(this.year,this.month,0);o=o.getDate();var u="01/"+this.month+"/"+this.year,l=o+"/"+this.month+"/"+this.year;this.listEvents(u,l,!1,s,s)},listEvents:function(e,n,r,s,o){var u=this,a=new i;a.done(function(e){u.data={events:e.models,_:t},s&&s(u.data)}).fail(function(e){u.data={error:e.error,_:t},o&&o(u.data)}).listEvents(e,n,r)},listDayEvents:function(e){if(!r.isSmartPhoneResolution()||this.fullDay){var t=new u;t.year=this.year,t.month=this.month,t.day=this.day,t.data=e,t.dayTitle=this.dayTitle,t.render()}else{var n=new o;n.year=this.year,n.month=this.month,n.day=this.day,n.data=e,n.render()}this.loaded()},initialize:function(){this.container=e("#scroller")},changeMonthYear:function(e,t,n){var r=this,i=function(e){r.refreshDatePicker()},s="00",t=s.substring(0,s.length-(""+t).length)+(""+t),o=new Date(e,t,0);o=o.getDate(),this.year=e,this.month=t;var u="01/"+t+"/"+e,a=o+"/"+t+"/"+e;this.listEvents(u,a,n,i,i)},highlightDays:function(e){if(!t.isEmpty(this.data.events))for(var n in this.data.events){var r=this.data.events[n].get("eventStartDate").split(" ")[0].split("/");r=new Date(r[2],r[1]-1,r[0]);var i=this.data.events[n].get("eventEndDate").split(" ")[0].split("/");i=new Date(i[2],i[1]-1,i[0]);if(e.getTime()==r.getTime()||e.getTime()==i.getTime())return[!0,"hasEvent"]}return[!0,""]},refreshDatePicker:function(){e("#agenda").datepicker("refresh")},renderDatePicker:function(){var t=this;e("#agenda").datepicker({dayNamesShort:e.datepicker.regional["pt-BR"].dayNamesShort,dayNames:e.datepicker.regional["pt-BR"].dayNames,monthNamesShort:e.datepicker.regional["pt-BR"].monthNamesShort,monthNames:e.datepicker.regional["pt-BR"].monthNames,inline:!0,autoSize:!0,nextText:">",prevText:"<",dateFormat:"DD, dd/mm/yy",onChangeMonthYear:function(e,n,r){t.changeMonthYear(e,n,!1)},beforeShowDay:function(e){return t.highlightDays(e)},onSelect:function(e,t){var n=e.split(", ")[1].split("/"),i="Calendar/"+n[2]+"/"+n[1]+"/"+n[0];r.router.navigate(i,{trigger:!0})}}),this.year!=""&&this.month!=""&&this.day!=""&&e("#agenda").datepicker("setDate",new Date(this.year,this.month-1,this.day)),this.dayTitle=e.datepicker.formatDate("DD, dd/mm/yy",new Date(this.year,this.month-1,this.day))},loaded:function(){!r.isSmartPhoneResolution()&&this.onlyDatePicker===!1&&(r.scrollDetail!=null&&(r.scrollDetail.destroy(),r.scrollDetail=null),r.scrollDetail=new iScroll("wrapperDetail")),r.scroll!=null&&(r.scroll.destroy(),r.scroll=null);var t=this;pullDownEl=document.getElementById("pullDown"),pullDownOffset=pullDownEl.offsetHeight,r.scroll=new iScroll("wrapper",{useTransition:!0,topOffset:pullDownOffset,onRefresh:function(){pullDownEl.className.match("loading")&&(pullDownEl.className="",pullDownEl.querySelector(".pullDownLabel").innerHTML="Puxe para baixo para atualizar...")},onScrollMove:function(){this.y>5&&!pullDownEl.className.match("flip")?(pullDownEl.className="flip",pullDownEl.querySelector(".pullDownLabel").innerHTML="Solte para atualizar...",this.minScrollY=0):this.y<5&&pullDownEl.className.match("flip")&&(pullDownEl.className="",pullDownEl.querySelector(".pullDownLabel").innerHTML="Puxe para baixo para atualizar...",this.minScrollY=-pullDownOffset)},onScrollEnd:function(){pullDownEl.className.match("flip")&&(pullDownEl.className="loading",pullDownEl.querySelector(".pullDownLabel").innerHTML="Carregando...",t.pullDownAction())}}),r.scrollerRefresh(),r.menuView.renderContextMenu("calendar",{year:this.year,month:this.month,day:this.day}),r.setDefaultIMListeners(),e("#content .searchArea").remove(),e("#contentTitle").text("Agenda"),e("#contentTitle").addClass("icon-agenda"),this.status=="OK"&&r.showMessage({type:"success",icon:"icon-agenda",title:"Evento excluído com sucesso.",description:"",timeout:3e3,elementID:"#pageMessage"})},pullDownAction:function(){this.changeMonthYear(this.year,this.month,!0),pullDownEl=document.getElementById("pullDown"),pullDownEl.className="",r.scrollerRefresh()},clean:function(){var t=new s({el:e("#content")});t.render();if(!r.isSmartPhoneResolution()&&this.onlyDatePicker===!1){var n=new s({el:e("#contentDetail")});n.render()}}});return h}),define("text!templates/calendar/calendarDetailsTemplate.html",[],function(){return"<table id=\"eventDetails\"> \n	<tr>\n		<td class=\"item\">\n			In&iacute;cio\n		</td>\n		<td class=\"description\">\n			<%= event.get('eventDateStart') %> - <%= event.get('eventTimeStart') %>\n		</td>\n	</tr> \n	<tr>\n		<td class=\"item\">\n			T&eacute;rmino\n		</td>\n		<td class=\"description\">\n			<%= event.get('eventDateEnd') %> - <%= event.get('eventTimeEnd') %>\n		</td>\n	</tr> \n	<tr>\n		<td class=\"item\">\n			Local\n		</td>\n		<td class=\"description\">\n			<%= _.isEmpty(event.get('eventLocation')) ? '-' : event.get('eventLocation') %>\n		</td>\n	</tr> \n	<tr>\n		<td class=\"item\">\n			Prioridade\n		</td>\n		<td class=\"description\">\n			<%= event.get('eventPriority') %>\n		</td>\n	</tr>\n	<tr>\n		<td class=\"item\">\n			Participantes\n		</td>\n		<td class=\"description\" id=\"listParticipants\">\n				\n			<% \n			if (event.get('eventParticipantsLdap').length > 0) \n			{ \n				%>\n				<ul>\n				<%\n				var participants = event.get('eventParticipantsLdap');\n				for (var i in participants) \n				{\n					if (!_.isEmpty(participants[i].get('contactFullName')))\n					{\n					%>	\n						<li><%= participants[i].get('contactFullName') %></li>\n					<%\n					}\n				}\n				%>\n				</ul>\n				<%\n			}\n			%>\n\n		</td>\n	</tr> \n	<tr>\n		<td class=\"item\">\n			Criado por\n		</td>\n		<td class=\"description\">\n			<% if (!_.isEmpty(event.get('eventOwner'))) { %>\n				<%= event.get('eventOwner').get('contactFullName') %>\n			<% } %>\n		</td>\n	</tr>  \n	<tr>\n		<td class=\"item\">\n			Descri&ccedil;&atilde;o\n		</td>\n		<td class=\"description\">\n			<%= event.get('eventDescription') %>\n		</td>\n	</tr> \n	\n</table>"}),define("views/calendar/CalendarDetailsView",["jquery","underscore","backbone","shared","models/calendar/EventModel","views/home/LoadingView","views/calendar/CalendarListView","text!templates/calendar/calendarDetailsTemplate.html","text!templates/master/detailContentTemplate.html","text!templates/master/primaryContentTemplate.html"],function(e,t,n,r,i,s,o,u,a,f){var l=n.View.extend({eventID:0,status:"",year:"",month:"",day:"",events:{"click #contextMenu ul li a":"selectItem"},selectItem:function(e){e.preventDefault()},render:function(){var n=this,i,l,c;r.isSmartPhoneResolution()?(this.$el.html(t.template(f)),e("#content").empty().append(this.$el),i=e("#contentTitle"),l=e("#scroller"),c="#pageMessage"):(this.$el.html(t.template(a)),e("#contentDetail").empty().append(this.$el),i=e("#contentDetailTitle"),l=e("#scrollerDetail"),c="#pageMessage");var h=new s({el:l});h.render();var p=function(e){var s=e.event.get("eventOwner").get("contactUIDNumber")==r.profile.contactUIDNumber,a=e.event.get("eventDateStart").split("/"),f="00";n.year=a[2],n.month=f.substring(0,f.length-(""+a[1]).length)+(""+a[1]),n.day=f.substring(0,f.length-(""+a[0]).length)+(""+a[0]),e.event.set({eventPriority:n.getPriority(e.event.get("eventPriority"))}),n.loaded(e.event.get("eventID"),s);if(n.status=="OK"){r.showMessage({type:"success",icon:"icon-agenda",title:"Evento salvo com sucesso.",description:"",timeout:3e3,elementID:c});if(!r.isSmartPhoneResolution()){var h=new o;h.year=n.year,h.month=n.month,h.day=n.day,h.onlyDatePicker=!0,h.render()}}i.text(e.event.get("eventName")),l.empty().append(t.template(u,e))};this.getEvent(this.eventID,p,p)},getEvent:function(e,n,r){var s=this,o=new i;o.done(function(e){s.data={event:e,_:t},n(s.data)}).fail(function(e){s.data={error:e.error,_:t},r&&r(s.data)}).getEvent(e)},loaded:function(t,n){e(".searchArea").remove(),r.isSmartPhoneResolution()?(r.scroll!=null&&(r.scroll.destroy(),r.scroll=null),r.scroll=new iScroll("wrapper")):(r.scrollDetail!=null&&(r.scrollDetail.destroy(),r.scrollDetail=null),r.scrollDetail=new iScroll("wrapperDetail")),r.scrollerRefresh(),r.menuView.renderContextMenu("calendarDetailsEvent",{isOwner:n,eventID:t,year:this.year,month:this.month,day:this.day})},initialize:function(){var e="00",t=new Date;if(this.year==""||this.year==undefined)this.year=t.getFullYear();if(this.month==""||this.month==undefined)this.month=t.getMonth()+1,this.month=e.substring(0,e.length-(""+this.month).length)+(""+this.month);if(this.day==""||this.day==undefined)this.day=t.getDate()},getPriority:function(e){var t=["","Baixo","Normal","Alto"];return e==""?"Nenhum":t[e]}});return l}),define("models/calendar/EventCategoryModel",["underscore","backbone","shared"],function(e,t,n){var r=t.Model.extend({defaults:{},initialize:function(){this.api=n.api,this.readResource="/Calendar/EventCategories",this.updateResource="",this.createResource="",this.deleteResource=""},route:function(){return"/Calendar/Categories"},done:function(e){return this.done=e,this},fail:function(e){return this.fail=e,this}});return r}),define("collections/calendar/EventCategoriesCollection",["underscore","backbone","shared","models/calendar/EventCategoryModel"],function(e,t,n,r){var i=t.Collection.extend({model:r,_data:{},_functions:{},done:function(e){return this._functions.done=e,this},fail:function(e){return this._functions.fail=e,this},initialize:function(e,t){this.api=n.api,this.model=r},listEventCategories:function(e){var t=this;t._data={};var n=r,i=this._data;return this.api.resource("Calendar/EventCategories").params({eventCategoryID:e}).done(function(e){for(var r in e.eventCategories){var i=new n(e.eventCategories[r]);t.add(i)}t._functions.done&&t._functions.done(t)}).fail(function(e){t._functions.fail&&t._functions.fail(e)}).execute(),t},execute:function(){return this.api.execute()}});return i}),define("text!templates/calendar/calendarEditEventTemplate.html",[],function(){return'<form id="addEvent">\n	<div id="formMessage"></div>\n	<ol>\n		<li>\n			<label for="eventType">Tipo *</label>\n			<select name="eventType" id="eventType">\n\n				<% _.each(types, function(t, i) { %>\n\n					<option value="<%= i %>" <%= (i == event.get(\'eventType\')) ? \'selected="selected"\' : \'\' %>><%= t %></option>\n\n				<% }); %>\n\n			</select>\n		</li>\n		<li>\n			<label for="eventName">T&iacute;tulo *</label>\n			<input type="text" name="eventName" id="eventName" placeholder="T&iacute;tulo" value="<%= event.get(\'eventName\') %>" />\n		</li>\n		<li>\n			<label for="eventDescription">Descri&ccedil;&atilde;o</label>\n			<textarea name="eventDescription" id="eventDescription" placeholder="Descri&ccedil;&atilde;o completa"><%= event.get(\'eventDescription\') %></textarea>\n		</li>\n		<li class="itens" <% if (eventCategories.length == 0) { %>style=" display: none; "<%}%>>\n			<label for="eventCategoryID">Categoria</label>\n\n			<% if (typeof(eventCategories) != \'undefined\' && eventCategories.length > 0) \n			{ \n				var listCategoriesSelected = (event.get(\'eventCategoryID\')).split(\',\');\n				%>\n				<ol>\n					<% _.each(eventCategories, function(e) { %>\n\n						<li>\n							<input id="<%= e.get(\'eventCategoryID\') %>" type="checkbox" class="css-checkbox eventCategories" name="<%= e.get(\'eventCategoryID\') %>" value="<%= e.get(\'eventCategoryID\') %>" data-name="<%= e.get(\'eventCategoryName\') %>" <%= (_.contains(listCategoriesSelected, e.get(\'eventCategoryID\'))) ? \'checked="checked"\' : \'\' %> /> \n							<label for="<%= e.get(\'eventCategoryID\') %>" class="css-label"><%= e.get(\'eventCategoryName\') %></label>\n						</li>\n\n					<% }); %>\n\n				</ol>\n\n			<% } %>\n\n		</li>\n		<li>\n			<label for="eventLocation">Localiza&ccedil;&atilde;o</label>\n			<input type="text" name="eventLocation" id="eventLocation" placeholder="Localiza&ccedil;&atilde;o" value="<%= event.get(\'eventLocation\') %>" />\n		</li>\n		<li class="date">\n			<label for="eventDateStart">Data inicial *</label>\n			<input type="date" name="eventDateStart" id="eventDateStart" placeholder="Data inicial" value="<%= event.get(\'eventDateStart\') %>" />\n		</li>\n		<li class="date">\n			<label for="eventTimeStart">Hora inicial *</label>\n			<input type="time" name="eventTimeStart" id="eventTimeStart" placeholder="Hora inicial" value="<%= event.get(\'eventTimeStart\') %>" />\n		</li>\n		<li class="date">\n			<label for="eventDateEnd">Data final *</label>\n			<input type="date" name="eventDateEnd" id="eventDateEnd" placeholder="Data final" value="<%= event.get(\'eventDateEnd\') %>" />\n		</li>\n		<li class="date">\n			<label for="eventTimeEnd">Hora final *</label>\n			<input type="time" name="eventTimeEnd" id="eventTimeEnd" placeholder="Hora final" value="<%= event.get(\'eventTimeEnd\') %>" />\n		</li>\n		<li class="itens">\n			<!-- <h4>Participantes:</h4> -->\n			<label for="participantes">Participantes</label>\n			<a href="#" id="addParticipants" title="Adicionar participantes">Adicionar participantes</a>\n\n			<% \n			var listParticipantsID = event.get(\'eventParticipants\');\n\n			if (typeof(listParticipantsID) != \'undefined\' && listParticipantsID.length > 0 && listParticipantsID.length == listParticipants.length) \n			{ \n			%>\n				<ol>\n\n					<% _.each(listParticipantsID, function(pID) \n					{ \n						var participant = _.where(listParticipants, { participantID: pID });\n					%>\n\n						<li>\n							<input id="<%= pID %>" type="checkbox" class="css-checkbox eventParticipants" name="<%= pID %>" value="<%= pID %>" data-name="<%= participant[0].participantName %>" checked="checked" /> \n							<label for="<%= pID %>" class="css-label"><%= participant[0].participantName %></label>\n						</li>\n\n					<% }); %>\n\n				</ol>\n\n			<% } %>\n		</li>\n		<li>\n			<label for="eventPriority">Prioridade</label>\n			<select name="eventPriority" id="eventPriority">\n				<% _.each(priorities, function(p, i) { %>\n\n					<option value="<%= i %>" <%= (i == event.get(\'eventPriority\')) ? \'selected="selected"\' : \'\' %>><%= p %></option>\n\n				<% }); %>\n			</select>\n		</li>\n		<li>\n			<label for="eventExParticipants">Participantes externos</label>\n			<textarea name="eventExParticipants" id="eventExParticipants" placeholder="Participantes externos"><%= event.get(\'eventExParticipants\') %></textarea>\n		</li>\n	</ol>\n	<input type="hidden" name="eventID" id="eventID" value="<%= event.get(\'eventID\') %>" />\n</form>'}),define("views/calendar/CalendarEditEventView",["jquery","underscore","backbone","shared","models/calendar/EventModel","views/home/LoadingView","views/calendar/CalendarEditEventAddParticipantsView","collections/calendar/EventCategoriesCollection","text!templates/calendar/calendarEditEventTemplate.html","text!templates/master/detailContentTemplate.html","text!templates/master/primaryContentTemplate.html"],function(e,t,n,r,i,s,o,u,a,f,l){var c=n.View.extend({eventID:0,model:i,listParticipants:[],year:"",month:"",day:"",data:{},types:{1:"Normal",2:"Restrito"},priorities:{"":"Nenhum",1:"Baixo",2:"Normal",3:"Alto"},events:{"click #addParticipants":"addParticipants","click .css-checkbox":"removeParticipant"},render:function(n){var i=this,o,u;n!=undefined?(n.model!=undefined&&(this.model=n.model),n.listParticipants!=undefined&&(this.listParticipants=n.listParticipants)):(this.model.set({eventTimeStart:"08:00"}),this.model.set({eventTimeEnd:"08:30"})),r.isSmartPhoneResolution()?(this.$el.html(t.template(l)),e("#content").empty().append(this.$el),u=e("#scroller"),o=e("#contentTitle")):(this.$el.html(t.template(f)),e("#contentDetail").empty().append(this.$el),u=e("#scrollerDetail"),o=e("#contentDetailTitle"));var c=new s({el:u});c.render(),o.text("Adicionar evento");var h=function(e){var n=e;if(i.eventID>0){o.text("Editar evento");var r=function(e){var r="00",s=e.get("eventDateStart").split("/"),o=e.get("eventDateEnd").split("/");e.set({eventDateStart:s[2]+"-"+r.substring(0,r.length-(""+s[1]).length)+(""+s[1])+"-"+r.substring(0,r.length-(""+s[0]).length)+(""+s[0])}),e.set({eventDateEnd:o[2]+"-"+r.substring(0,r.length-(""+o[1]).length)+(""+o[1])+"-"+r.substring(0,r.length-(""+o[0]).length)+(""+o[0])});if(e.get("eventParticipants")!=undefined&&e.get("eventParticipants").length>0){var f=[];t.each(e.get("eventParticipants"),function(e){f.push(e.contactUIDNumber)}),e.set({eventParticipants:f});var l=[];t.each(e.get("eventParticipantsLdap"),function(e){l.push({participantID:e.get("contactUIDNumber"),participantName:e.get("contactFullName")})}),i.listParticipants=l}i.model=e;var c={eventCategories:n,event:i.model,listParticipants:i.listParticipants,types:i.types,priorities:i.priorities};u.html(t.template(a,c)),i.setElement(i.$el),i.loaded()};i.getEvent(i.eventID,r,r)}else{var s={eventCategories:n,event:i.model,listParticipants:i.listParticipants,types:i.types,priorities:i.priorities};u.html(t.template(a,s)),i.setElement(i.$el),i.loaded()}};this.listEventCategories("",h,h)},getEvent:function(e,t,n){var r=this,s=new i;s.getEvent(e).done(function(e){t&&t(e)}).fail(function(e){n&&n(r.data)})},loaded:function(){var t=0;r.isSmartPhoneResolution()?(t=e("#content").width()-(e("body form#addEvent input[type=text]").position().left+33),r.scroll!=null&&(r.scroll.destroy(),r.scroll=null),r.scroll=new iScroll("wrapper")):(t=e("#contentDetail").width()-(e("body form#addEvent input[type=text]").position().left+33),r.scrollDetail!=null&&(r.scrollDetail.destroy(),r.scrollDetail=null),r.scrollDetail=new iScroll("wrapperDetail")),r.scrollerRefresh();var n={};n.saveCallBack=this.saveEvent,n.addParticipantsCallBack=this.addParticipants,n.parentCallBack=this,r.menuView.renderContextMenu("calendarAddEvent",n),e("#contentDetail .searchArea").remove(),e("#content .searchArea").remove();var i=t/2-30;e("body form#addEvent input[type=text]").width(t),e("body form#addEvent select").width(t),e("body form#addEvent textarea").width(t),e("body form#addEvent li.date input[type=text]").width(i)},initialize:function(e){this.model=new i,e!=undefined&&(this.year=e.year,this.month=e.month,this.day=e.day),this.year!=""&&this.month!=""&&this.day!=""&&(this.model.set({eventDateStart:this.year+"-"+this.month+"-"+this.day}),this.model.set({eventDateEnd:this.year+"-"+this.month+"-"+this.day}))},listEventCategories:function(e,t,n){var r=new u;r.done(function(e){t(e.models)}).fail(function(e){n(data.error)}).listEventCategories(e)},addParticipants:function(t){t.target&&(t.preventDefault(),t=this);var n=e(".css-checkbox.eventCategories").map(function(){if(e(this).is(":checked"))return e(this).val()}).toArray().join(","),r={eventDateStart:e("#eventDateStart").val(),eventTimeStart:e("#eventTimeStart").val(),eventDateEnd:e("#eventDateEnd").val(),eventTimeEnd:e("#eventTimeEnd").val(),eventID:e("#eventID").val(),eventType:e("#eventType").val(),eventCategoryID:n,eventName:e("#eventName").val(),eventDescription:e("#eventDescription").val(),eventLocation:e("#eventLocation").val(),eventPriority:e("#eventPriority").val(),eventOwnerIsParticipant:e("#eventOwnerIsParticipant").val(),eventExParticipants:e("#eventExParticipants").val()};t.model.set(r);var i=new o({listParticipants:t.listParticipants,model:t.model,view:new c});i.render()},saveEvent:function(t){t.target&&(t.preventDefault(),t=this);var n=e("#eventDateStart").val().split("-"),i=e("#eventDateEnd").val().split("-"),s=e(".css-checkbox.eventParticipants").map(function(){return e(this).val()}).toArray(),o=e(".css-checkbox.eventCategories").map(function(){if(e(this).is(":checked"))return e(this).val()}).toArray().join(","),u={eventDateStart:n[2]+"/"+n[1]+"/"+n[0],eventTimeStart:e("#eventTimeStart").val(),eventDateEnd:i[2]+"/"+i[1]+"/"+i[0],eventTimeEnd:e("#eventTimeEnd").val(),eventID:e("#eventID").val(),eventType:e("#eventType").val(),eventCategoryID:o,eventName:e("#eventName").val(),eventDescription:e("#eventDescription").val(),eventLocation:e("#eventLocation").val(),eventPriority:e("#eventPriority").val(),eventOwnerIsParticipant:"1",eventParticipants:s.join(),eventExternalParticipants:e("#eventExParticipants").val()},a=function(e){t.listParticipants=[],e.event!=undefined&&r.router.navigate("/Calendar/Events/"+e.event.get("eventID")+"/OK",{trigger:!0})},f=function(e){var t="*Campos obrigatórios",n="";e.error!=undefined&&(t="Ocorreu um erro ao salvar o evento.",e.error.code=="1051"?n="Verifique se já existe um evento para a datas selecionadas ou se os campos foram preenchidos corretamente.":e.error.code=="1043"&&(n="Verifique se o título do evento foi preenchido corretamente.")),r.showMessage({type:"error",icon:"icon-agenda",title:t,description:n,timeout:3e3,elementID:"#pageMessage"})};t.save(u,a,f)},save:function(e,n,r){var s=new i;s.saveEvent(e).done(function(e){var r={event:e,_:t};n&&n(r)}).fail(function(e){r&&r(e)})},removeParticipant:function(n){var r=this.model.get("eventParticipants"),i=this.listParticipants,s=e(n.target).val(),o=e(n.target).attr("data-name"),u=t.indexOf(r,s),a=u;t.each(i,function(e,t){e.participantID==s&&e.participantName==o&&(a=t)}),u!=-1&&(r.splice(u,1),i.splice(a,1),e(n.target).parent("li").fadeOut(400,function(){e(this).remove()})),this.model.set({eventParticipants:r})}});return c}),define("views/calendar/CalendarDeleteEventView",["jquery","underscore","backbone","shared","models/calendar/EventModel","views/home/LoadingView"],function(e,t,n,r,i,s){var o=n.View.extend({eventID:0,year:"",month:"",day:"",render:function(t){var n=this;r.isSmartPhoneResolution()||(this.$el=e("#contentDetail"));var i=new s({el:this.$el});i.render();var o=function(e){r.router.navigate("/Calendar/"+n.year+"/"+n.month+"/"+n.day+"/OK",{trigger:!0})},u=function(e){r.router.navigate("/Calendar/Events/"+n.eventID+"/Error",{trigger:!0})};this.deleteEvent(o,u)},deleteEvent:function(e,t){var n=new i;n.deleteEvent(this.eventID).done(function(t){e&&e(t)}).fail(function(e){t&&t(e)})},initialize:function(e){}});return o}),define("text!templates/chat/chatListTemplate.html",[],function(){return'<h2 class="ellipsis50 icon-jabber" style="padding-left: 50px; background-position: 10px;">Chat</h2>\n<div id="wrapper" class="container">\n  <div id="scroller">\n	<dl id="scrollerList"></dl>\n  </div>\n</div>'}),define("text!templates/chat/chatListItemsTemplate.html",[],function(){return'<% if (isConnected) { %>\n<% for (var i in contacts) { %>\n    <dt id="list_title_<%=i%>" <% if (contacts[i].length == 0) { %>class="hidden"<% } %>>\n      <% if (i == \'online\') { %>Online<% } %>\n      <% if (i == \'busy\') { %>Ocupado<% } %>\n      <% if (i == \'away\') { %>Ausente<% } %>\n      <% if (i == \'offline\') { %>Offline<% } %>\n    </dt>\n    <ul id="list_<%=i%>">\n      <% _.each(contacts[i], function(contact){ %>\n        <% if (contact.id != null) { %>\n        <li id="<%=contact.id%>"> \n          <a href="/Chat/<%=contact.id%>" class="listItemLink">\n            <div id="<%=contact.id%>_status" class="chat-<%=i%>"></div>\n            <div id="<%=contact.id%>_badge" style="" class="badge badge-chat-list <% if (contact.qtdUnread == 0) { %>hidden<% } %>"><%= contact.qtdUnread %></div>\n            <% if (contact.name != null) { %>\n            <h3 class="ellipsis20"><%= contact.name %></h3>\n            <span class="ellipsis14"><%= contact.jid %></span>\n            <% } else { %>\n            <h3 class="ellipsis20"><%= contact.jid %></h3>\n            <% } %>\n          </a>\n        </li>\n        <% } %>\n      <% }); %>\n    </ul>\n<% } %>\n<% } else { %>\n  <dl id="chatHelp">\n      <dt>Est&aacute; com problemas ao se conectar ao CHAT?</dt>\n      <dd>Tente reconectar, se o problema persistir verifique se voc&ecirc; se enquadra em uma das seguintes situa&ccedil;&otilde;es.</dd>\n      <br> \n      <br>\n      <dt>1 - Sua conex&atilde;o pode ter sido perdida</dt>\n      <dd>\n        Caso voc&ecirc; esteja sem acesso a internet ou tenha passado com seu dispositivo m&oacute;vel por uma &aacute;rea onde a conex&atilde;o com a internet tenha sido temporariamente perdida, você ser&aacute; desconectado do servi&ccedil;o de CHAT. Para conectar-se novamente, basta fechar e abrir o aplicativo. Caso esteja em um navegador WEB, atualize a sua p&aacute;gina.\n        <br><br><br>\n      </dd>\n      <dt>2 - Voc&ecirc; pode estar conectado em outro local</dt>\n      <dd>\n        Voc&ecirc; pode estar conectado no CHAT em outro computador ou em outra aba do seu navegador. O servi&ccedil;o de CHAT aceita apenas uma conex&atilde;o por usu&aacute;rio, e caso voc&ecirc; tenha se logado em outro lugar sua conex&atilde;o ser&aacute; perdida.\n        <br><br><br>\n      </dd>\n\n      <% if (!Shared.isPhonegap()) { %>\n      <dt>3 - O seu navegador pode ter bloqueado sua conex&atilde;o.</dt>\n      <dd>Alguns navegadores podem bloquear a conex&atilde;o no servidor de CHAT.<br><br>No navegador Firefox desabilite o bloqueio atrav&eacute;s destes 4 passos bem simples:<br>\n        <br><div class="firefox_help"></div>\n      </dd>\n      <% } %>\n  </dl>\n<% } %>\n\n'}),define("views/chat/ChatListItemsView",["jquery","underscore","backbone","shared","text!templates/chat/chatListItemsTemplate.html"],function(e,t,n,r,i){var s=n.View.extend({render:function(){var n=this,s=r.im.isConnected(),o=[];s&&(o=r.im.getAllContacts());var u={contacts:o,isConnected:s,_:t,Shared:r},a=t.template(i,u);e("#scrollerList").html(a),s||r.menuView.renderContextMenu("chatOffline",{})}});return s}),define("text!templates/chat/chatWindowTemplate.html",[],function(){return'<h2 id="chatUserName">\n	<% if ($.trim(contact.name) != \'\') { %><%=contact.name%><% } else { %><%=contact.jid%><% } %>\n</h2>\n<div class="chatArea">\n	<input id=\'msgToSend\' type="text" class="chatTextField" value="" placeholder="Mensagem:"  onKeyPress=""/>\n</div>\n<article id="wrapperDetail" class="container">\n  <div id="scrollerDetail">\n  	\n  </div>\n</article>'}),define("text!templates/chat/chatWindowMessagesTemplate.html",[],function(){return'<% _.each(messages, function(message){ %>\n  <% var lastMsgJID = \'\'; %>\n	<% if (message.jid != "me") { %>\n    <div class="fullWidth" style="text-align: left; font-size: 10px; color: #777777; margin-bottom: 10px; padding-left: 20px;">\n      <%=moment(message.date).format("hh:mm")%> - (<%=moment(message.date).fromNow()%>)\n    </div>\n		<div class="fullWidth">\n  		<img class="chat-picture left">\n  		<div class="triangle-right left">\n  			<%=message.body%>\n  		</div>\n  		<div class="clear"></div>\n  	</div>\n	<% } else { %>\n    <div class="fullWidth" style="text-align: right; font-size: 10px; color: #777777; margin-bottom: 10px; padding-right: 20px;">\n      <%=moment(message.date).format("hh:mm")%> - (<%=moment(message.date).fromNow()%>)\n    </div>\n  	<div class="fullWidth">\n  		<img class="myPicture chat-picture right">\n  		<div class="triangle-right right">\n  			<%=message.body%>\n  		</div>\n  		<div class="clear"></div>\n  	</div>\n	<% } %>\n  <% lastMsgJID = message.jid; %>\n<% }); %>\n<div id="last_message"></div>'}),define("views/chat/ChatWindowView",["jquery","underscore","backbone","shared","moment","text!templates/chat/chatWindowTemplate.html","text!templates/chat/chatWindowMessagesTemplate.html","views/home/LoadingView"],function(e,t,n,r,i,s,o,u){var a=n.View.extend({el:e("#content"),chatID:"",currentContact:null,render:function(){var n=r.im.getContactsByID(this.chatID);this.currentContact=n;var i=this,o=function(e){i.renderMessages(),r.menuView.setChatBadge(r.im.qtdUnreadMessages())},u=function(t){if(t.from==i.currentContact.jid){var r="";t.state=="composing"&&(r=" (está escrevendo...)"),e.trim(n.name)!=""?e("#chatUserName").html(n.name+r):e("#chatUserName").html(n.jid+r)}};r.im.addOnMessageListener(o),r.im.addOnComposingListener(u),r.im.addOnErrorListener(r.onIMErrorFunction),r.im.addOnDisconnectListener(r.onIMDisconnectFunction),r.menuView.setChatBadge(r.im.qtdUnreadMessages());var a={chatID:this.chatID,contact:n,_:t},f=t.template(s,a);this.$el.html(f),this.renderMessages(),this.loaded();var l=e(".topHeader").outerHeight(!0),c=e(".chatArea").outerHeight(true)==null?0:e(".chatArea").outerHeight(!0);e("body").height(e(window).height()-l),e("#wrapperDetail").css("top",l+c),this.scrollToLastMessage(),r.setCurrentView(2,this)},events:{"keydown #msgToSend":"sendMessage"},sendMessage:function(t){t.which==13&&!t.shiftKey&&(r.im.sendMessage(this.currentContact.jid,e("#msgToSend").val()),e("#msgToSend").val(""),e("#msgToSend").blur(),e("#msgToSend").focus())},renderMessages:function(){var n=r.im.getMessagesFromID(this.chatID),s=r.im.getContactsByID(this.chatID),u={messages:n,chatID:this.chatID,contact:s,moment:i,_:t,$:e},a=t.template(o,u);e("#scrollerDetail").html(a),e(".myPicture").each(function(){e(this).css("background-image",e("#userPicture").css("background-image")),e(this).css("background-size","46px 61px")}),this.scrollToLastMessage()},scrollToLastMessage:function(){r.scrollDetail!=null&&(r.scrollDetail.refresh(),r.scrollDetail.scrollToElement(document.getElementById("last_message"),200))},loaded:function(){r.scrollDetail!=null&&(r.scrollDetail.destroy(),r.scrollDetail=null),r.scrollDetail==null&&(r.scrollDetail=new iScroll("wrapperDetail"))}});return a}),define("views/chat/ChatListView",["jquery","underscore","backbone","shared","text!templates/chat/chatListTemplate.html","views/chat/ChatListItemsView","views/chat/ChatWindowView","views/home/LoadingView"],function(e,t,n,r,i,s,o,u){var a=n.View.extend({secondViewName:"",render:function(){var t=this,n="#content",i="#contentDetail";r.isSmartPhoneResolution()&&(i="#content"),e(i).html(""),r.im.clearListeners();var s=function(e){if(e.id!=t.secondViewName){var n=r.im.getContactsByID(e.id);t.setChatBadge(e.id,n.qtdUnread);if(e.jid!="me"){var i={type:"chat-message",icon:"icon-jabber",title:e.body,description:e.jid,route:"/Chat/"+e.id,timeout:3e3,elementID:"#pageMessage"};r.showMessage(i)}}else t.setChatBadge(t.secondViewName,0),r.im.setAsSeenAllMessagesFromContact(t.secondViewName);r.menuView.setChatBadge(r.im.qtdUnreadMessages())},a=function(t){var n=e("#"+t.id);n.animate({opacity:.25,height:"toggle"},1e3,function(){n.remove(),e("#list_title_"+t.status).removeClass("hidden"),e("#list_"+t.status).append(n);var r=e("#"+t.id+"_status");r.removeClass(),r.addClass("chat-"+t.status),n.animate({opacity:1,height:"toggle"},1e3,function(){})})},f=function(){t.renderContactList(),e(i).html("")};r.im.addOnMessageListener(s),r.im.addOnPresenceListener(a),r.im.addOnErrorListener(r.onIMErrorFunction),r.im.addOnDisconnectListener(r.onIMDisconnectFunction),r.im.addOnErrorListener(f);if(this.secondViewName!=null){var l=new u({el:e(i)});l.render(),r.detailView!=null&&r.detailView.undelegateEvents(),setTimeout(function(){t.setChatBadge(t.secondViewName,0),r.im.setAsSeenAllMessagesFromContact(t.secondViewName);var n=new o({el:e(i)});n.chatID=t.secondViewName,n.render()},r.timeoutDelay)}else this.renderContactList()},renderContactList:function(){var n="#content",o=this,a=new u({el:e(n)});a.render(),setTimeout(function(){var a={_:t},f=t.template(i,a);e(n).html(f);var l=r.im.isConnected(),c=function(){var e=new s;e.render(),o.loaded(),r.setCurrentView(1,o),r.menuView.setChatBadge(r.im.qtdUnreadMessages())};if(!l){var h=new Date;if(h-r.lastReconectionTime>=60)c();else{var p=new u({el:e("#scrollerList")});p.render(),r.router.navigate("ChatReconnect",{trigger:!0})}}else c()},r.timeoutDelay)},initialize:function(){this.secondViewName=""},loaded:function(){var e=this;r.scroll=new iScroll("wrapper")},setChatBadge:function(t,n){var r="#"+t+"_badge";n>0?(e(r).removeClass("hidden"),e(r).html(n)):(e(r).addClass("hidden"),e(r).html(n))}});return a}),define("router",["jquery","underscore","backbone","shared","views/login/LoginView","views/home/HomeView","views/home/OfflineView","views/mail/DetailMessageView","views/mail/ComposeMessageView","views/mail/EditFolderView","views/settings/SettingsListView","views/contacts/ContactsListView","views/contacts/DetailsContactView","views/contacts/AddContactView","views/contacts/DeleteContactView","views/calendar/CalendarListView","views/calendar/CalendarDetailsView","views/calendar/CalendarEditEventView","views/calendar/CalendarDeleteEventView","views/calendar/CalendarFullDayListView","views/chat/ChatListView"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){var E=n.Router.extend({routes:{Home:"homeView",Login:"loginView",AutomaticLogin:"automaticLoginView",Offline:"offlineView","Switch/*accountName":"switchAccount","Mail/CleanTrash/*PfolderID":"cleanTrashView","Mail/AddFolder/*PfolderID":"newFolderView","Mail/RenameFolder/*PfolderID":"renameFolderView","Mail/DeleteFolder/*PfolderID":"deleteFolderView","Mail/Message/:secondViewName/:msgID/*folderID":"composeMessageView","Mail/Message/:secondViewName/:emailTo":"composeMessageTo","Mail/Message/:secondViewName":"composeMessageView","Mail/Messages/:forceReload/:msgID/*folderID":"detailMessageView",Contacts:"contactsListView","Contacts/Add/:contactID":"addContactView","Contacts/Delete/:contactID":"deleteContactView","Contacts/:secondViewName/OK":"deleteContactsListView","Contacts/:secondViewName/:contactID/:status":"detailsContactView","Contacts/:secondViewName/:contactID":"detailsContactView","Contacts/:secondViewName":"contactsListView","Calendar/FullDay/:year/:month/:day":"calendarFullDayView","Calendar/Events/Add/:year/:month/:day":"calendarAddEventView","Calendar/Events/Edit/:eventID":"calendarEditEventView","Calendar/Events/Delete/:eventID/:year/:month/:day":"calendarDeleteEventView","Calendar/Events/:eventID/:status":"calendarDetailsView","Calendar/Events/:eventID":"calendarDetailsView","Calendar/:year/:month/:day/:status":"calendarListView","Calendar/:year/:month/:day":"calendarListView",Calendar:"calendarListView",ChatReconnect:"chatReconnectView",Chat:"chatListView","Chat/:secondViewName":"chatListView",Settings:"settingsListView","Settings/:secondViewName":"settingsListView",Logout:"logoutView",ContextMenu:"contextMenuView","*actions":"defaultAction"},start:function(){n.history.start({pushState:!0})},setupRouter:function(){var e=this;return e.on("route:homeView",function(e){var t=new s;t.render()}),e.on("route:switchAccount",function(e){r.forceAutomaticLoginInAccountName=e;var t=new i;t.logoutUser(!1)}),e.on("route:newFolderView",function(e){e==undefined&&(e="INBOX"),e=e.replace("#","");var t=new f;t.action="addFolder",t.parentFolderID=e,t.render(),r.menuView.closeMenu()}),e.on("route:cleanTrashView",function(e){e==undefined&&(e="INBOX"),e=e.replace("#","");var t=new f;t.cleanTrash(e),r.menuView.closeMenu()}),e.on("route:renameFolderView",function(e){e==undefined&&(e="INBOX"),e=e.replace("#","");var t=new f;t.action="renameFolder",t.folderID=e,t.render(),r.menuView.closeMenu()}),e.on("route:deleteFolderView",function(e){e=e.replace("#","");var t=new f;t.deleteFolder(e),r.menuView.closeMenu()}),e.on("route:loginView",function(e){var t=new i;t.render()}),e.on("route:automaticLoginView",function(e){var t=new i;t.automaticLogin()}),e.on("route:offlineView",function(e){var t=new o;t.render()}),e.on("route:logoutView",function(e){var t=new i;t.logoutUser()}),e.on("route:defaultAction",function(t){r.versionIsActive?(r.api.getLocalStorageValue("expresso",function(e){if(e!=null){var t=e.auth;t!=null&&r.api.auth(t),r.profile=e.profile}}),r.api.auth()?e.navigate("Home",{trigger:!0}):e.navigate("Login",{trigger:!0})):e.navigate("Offline",{trigger:!0})}),e.on("route:detailMessageView",function(e,t,n){n=n.replace("#","");var i=new s({folderID:n});r.menuView.closeMenu(),i.loadMessagesInFolder(n,"",t,e),n=="INBOX"?r.menuView.selectMenu(1):r.menuView.selectMenu(0),r.deviceType(r.isSmartPhoneResolution())}),e.on("route:composeMessageView",function(e,t,n){var i=new a;i.secondViewName=e,i.msgID=t,i.folderID=n,i.render(),r.menuView.closeMenu(),r.deviceType(r.isSmartPhoneResolution())}),e.on("route:composeMessageTo",function(e,t){var n=new a;n.secondViewName=e,n.emailTo=t,n.render(),r.menuView.closeMenu(),r.deviceType(r.isSmartPhoneResolution())}),e.on("route:settingsListView",function(e){var t=new l;t.secondViewName=e,t.render(),r.menuView.selectMenu(5),r.deviceType(r.isSmartPhoneResolution())}),e.on("route:contactsListView",function(e){contactsListView=new c,contactsListView.secondViewName=e,contactsListView.render(),r.menuView.selectMenu(3),r.deviceType(r.isSmartPhoneResolution())}),e.on("route:deleteContactsListView",function(e){contactsListView=new c,contactsListView.secondViewName=e,contactsListView.status="OK",contactsListView.render(),r.menuView.selectMenu(3),r.deviceType(r.isSmartPhoneResolution())}),e.on("route:detailsContactView",function(e,t,n){detailsContactView=new h,detailsContactView.secondViewName=e,detailsContactView.contactID=t,detailsContactView.status=n,detailsContactView.render(),r.menuView.selectMenu(3),r.deviceType(r.isSmartPhoneResolution())}),e.on("route:addContactView",function(e,t){addContactView=new p,addContactView.contactID=e,addContactView.email=t,addContactView.render(),r.menuView.selectMenu(3),r.deviceType(r.isSmartPhoneResolution())}),e.on("route:deleteContactView",function(e){deleteContactView=new d,deleteContactView.contactID=e,deleteContactView.render(),r.menuView.selectMenu(3),r.deviceType(r.isSmartPhoneResolution())}),e.on("route:calendarListView",function(e,t,n,i){var s=new v;s.year=e,s.month=t,s.day=n,s.fullDay=!1,s.status=i,s.render(),r.menuView.selectMenu(2),r.deviceType(r.isSmartPhoneResolution())}),e.on("route:calendarFullDayView",function(e,t,n){var i=new b;i.year=e,i.month=t,i.day=n,i.fullDay=!0,i.render(),r.menuView.selectMenu(2),r.deviceType(r.isSmartPhoneResolution())}),e.on("route:calendarDetailsView",function(e,t){var n=new m;n.eventID=e,n.status=t,n.render(),r.menuView.selectMenu(2),r.deviceType(r.isSmartPhoneResolution())}),e.on("route:calendarEditEventView",function(e){var t=new g;t.eventID=e,t.render(),r.menuView.selectMenu(2),r.deviceType(r.isSmartPhoneResolution())}),e.on("route:calendarAddEventView",function(e,t,n){var i=new g({year:e,month:t,day:n});i.render(),r.menuView.selectMenu(2),r.deviceType(r.isSmartPhoneResolution())}),e.on("route:calendarDeleteEventView",function(e,t,n,i){var s=new y;s.eventID=e,s.year=t,s.month=n,s.day=i,s.render(),r.menuView.selectMenu(2),r.deviceType(r.isSmartPhoneResolution())}),e.on("route:chatListView",function(e){var t=new w;t.secondViewName=e,t.render(),r.menuView.selectMenu(4),r.deviceType(r.isSmartPhoneResolution())}),e.on("route:contextMenuView",function(){r.menuView.context.toggleMenu()}),e.on("route:chatReconnectView",function(){r.chatReconnect()}),e}});return E}),define("app",["jquery","underscore","backbone","shared","router"],function(e,t,n,r,i){var s=function(){var e=function(){r.router=new i,r.router.setupRouter(),r.router.start()};IS_PHONEGAP?document.addEventListener("deviceready",function(){e()}):e()};return{initialize:s}}),require.config({waitSeconds:200,paths:{jquery:"libs/jquery/jquery-min",underscore:"libs/underscore/underscore-min",iscroll:"libs/iscroll/src/iscroll",backbone:"libs/backbone/backbone-min",expressoAPI:"libs/expresso/expressoAPI",expressoIM:"libs/expresso/expressoIM",expressoService:"libs/expresso/expressoService",jqueryui:"libs/jquery-ui/js/jquery-ui-1.10.3.custom.min",jquery_xmpp:"libs/jquery.xmpp/jquery.xmpp",moment:"libs/moment/moment.min",jquery_touchwipe:"libs/jquery.touchwipe/jquery.touchwipe.min",autocomplete:"libs/jquery.backbone.widget/jquery.backbone.widgets",jqueryui_datepicker_ptBR:"libs/jquery-ui/development-bundle/ui/i18n/jquery.ui.datepicker-pt-BR",templates:"../templates"},shim:{backbone:{deps:["jquery","underscore"],exports:"Backbone"},moment:{deps:["jquery"],exports:"moment"},underscore:{exports:"_"},jqueryui:{deps:["jquery"]},jquery_touchwipe:{deps:["jquery"]},autocomplete:{deps:["jquery"]},jqueryui_datepicker_ptBR:{deps:["jquery","jqueryui"]}}}),require(["app"],function(e){e.initialize()}),define("main",function(){});